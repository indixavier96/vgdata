define("discourse/plugins/discourse-gamification/discourse/admin-discourse-gamification-plugin-route-map",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"admin.adminPlugins.show",path:"/plugins",map(){this.route("discourse-gamification-leaderboards",{path:"leaderboards"},function(){this.route("show",{path:"/:id"})})}}}),define("discourse/plugins/discourse-gamification/discourse/components/gamification-leaderboard-row",["exports","@ember/component","@ember-decorators/component","discourse/helpers/avatar","discourse/helpers/number","discourse/truth-helpers","discourse/plugins/discourse-gamification/discourse/helpers/fullnumber","@ember/template-factory"],function(e,t,i,o,a,s,r,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=dt7948.c(class extends t.default{rank=null
static{(0,t.setComponentTemplate)((0,n.createTemplateFactory)({id:"MWTiNgnI",block:'[[[10,0],[15,0,[29,["user ",[52,[30,0,["rank","currentUser"]],"user-highlight"]]]],[15,1,[29,["leaderboard-user-",[30,0,["rank","id"]]]]],[12],[1,"\\n  "],[10,0],[14,0,"user__rank"],[12],[1,[30,0,["rank","position"]]],[13],[1,"\\n  "],[10,0],[14,0,"user__avatar clickable"],[14,"role","button"],[15,"data-user-card",[30,0,["rank","username"]]],[12],[1,"\\n    "],[1,[28,[32,0],[[30,0,["rank"]]],[["imageSize"],["large"]]]],[1,"\\n    "],[10,1],[14,0,"user__name"],[12],[1,"\\n"],[41,[30,0,["siteSettings","prioritize_username_in_ux"]],[[[1,"        "],[1,[30,0,["rank","username"]]],[1,"\\n"]],[]],[[[1,"        "],[1,[28,[32,1],[[30,0,["rank","name"]],[30,0,["rank","username"]]],null]],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"user__score"],[12],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"      "],[1,[28,[32,2],[[30,0,["rank","total_score"]]],null]],[1,"\\n"]],[]],[[[1,"      "],[1,[28,[32,3],[[30,0,["rank","total_score"]]],null]],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"],[13]],[],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/components/gamification-leaderboard-row.js",scope:()=>[o.default,s.or,a.default,r.default],isStrictMode:!0}),this)}},[(0,i.tagName)("")])
e.default=d}),define("discourse/plugins/discourse-gamification/discourse/components/gamification-leaderboard",["exports","@ember/component","@ember/helper","@ember/object","@ember/service","@ember-decorators/component","discourse/components/conditional-loading-spinner","discourse/components/d-button","discourse/components/load-more","discourse/helpers/avatar","discourse/helpers/d-icon","discourse/helpers/number","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/decorators","discourse/select-kit/components/period-chooser","discourse/truth-helpers","discourse-i18n","discourse/plugins/discourse-gamification/discourse/helpers/fullnumber","discourse/plugins/discourse-gamification/discourse/components/gamification-leaderboard-row","discourse/plugins/discourse-gamification/discourse/components/modal/leaderboard-info","@ember/template-factory"],function(e,t,i,o,a,s,r,n,d,l,c,u,m,p,f,g,b,h,_,y,v,k){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.LEADERBOARD_PERIODS=void 0
e.LEADERBOARD_PERIODS=["all_time","yearly","quarterly","monthly","weekly","daily"]
const w=dt7948.c(class extends t.default{static{dt7948.g(this.prototype,"router",[a.service])}#e=void dt7948.i(this,"router")
static{dt7948.g(this.prototype,"modal",[a.service])}#t=void dt7948.i(this,"modal")
eyelineSelector=".user"
page=1
loading=!1
canLoadMore=!0
period="all"
init(){super.init(...arguments)
const e=function(e){switch(e){case 0:default:return"all"
case 1:return"yearly"
case 2:return"quarterly"
case 3:return"monthly"
case 4:return"weekly"
case 5:return"daily"}}(this.model.leaderboard.default_period)
this.set("period",e)}isNotReady(e){return void 0!==e}static{dt7948.n(this.prototype,"isNotReady",[(0,f.default)("model.reason")])}currentUserRanking(){return this.model.personal||null}static{dt7948.n(this.prototype,"currentUserRanking",[(0,f.default)("model.users")])}winners(e){return e.slice(0,3)}static{dt7948.n(this.prototype,"winners",[(0,f.default)("model.users")])}ranking(e){return e.forEach(e=>{e.id===this.currentUser?.id&&(e.isCurrentUser="true")}),e.slice(3)}static{dt7948.n(this.prototype,"ranking",[(0,f.default)("model.users.[]")])}showLeaderboardInfo(){this.modal.show(v.default)}static{dt7948.n(this.prototype,"showLeaderboardInfo",[o.action])}loadMore(){if(!this.loading&&this.canLoadMore)return this.set("loading",!0),(0,m.ajax)(`/leaderboard/${this.model.leaderboard.id}?page=${this.page}&period=${this.period}`).then(e=>{0===e.users.length&&this.set("canLoadMore",!1),this.set("page",this.page+=1),this.set("model.users",this.model.users.concat(e.users))}).finally(()=>this.set("loading",!1)).catch(p.popupAjaxError)}static{dt7948.n(this.prototype,"loadMore",[o.action])}changePeriod(e){return this.set("period",e),(0,m.ajax)(`/leaderboard/${this.model.leaderboard.id}?period=${this.period}`).then(e=>{0===e.users.length&&(this.set("canLoadMore",!1),this.set("model.reason",e.reason)),this.set("page",1),this.set("model.users",e.users),this.set("model.personal",e.personal)}).finally(()=>this.set("loading",!1)).catch(p.popupAjaxError)}static{dt7948.n(this.prototype,"changePeriod",[o.action])}refresh(){this.router.refresh()}static{dt7948.n(this.prototype,"refresh",[o.action])}static{(0,t.setComponentTemplate)((0,k.createTemplateFactory)({id:"NTPHzvLP",block:'[[[10,0],[14,0,"leaderboard"],[12],[1,"\\n  "],[10,0],[14,0,"page__header"],[12],[1,"\\n    "],[10,"h1"],[14,0,"page__title"],[12],[1,[30,0,["model","leaderboard","name"]]],[13],[1,"\\n    "],[8,[32,0],[[24,0,"-ghost"]],[["@action","@icon","@label"],[[30,0,["showLeaderboardInfo"]],"circle-info",[52,[51,[30,0,["site","mobileView"]]],"gamification.leaderboard.info"]]],null],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"leaderboard__controls"],[12],[1,"\\n    "],[8,[32,1],[[24,0,"leaderboard__period-chooser"]],[["@period","@action","@fullDay","@options"],[[30,0,["period"]],[30,0,["changePeriod"]],false,[28,[32,2],null,[["disabled"],[[30,0,["model","leaderboard","period_filter_disabled"]]]]]]],null],[1,"\\n"],[41,[30,0,["currentUser","staff"]],[[[1,"      "],[10,3],[14,6,"/admin/plugins/gamification"],[14,0,"leaderboard__settings"],[12],[1,"\\n        "],[1,[28,[32,3],["gear"],null]],[1,"\\n        "],[1,[52,[51,[30,0,["site","mobileView"]]],[28,[32,4],["gamification.leaderboard.link_to_settings"],null]]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n\\n"],[41,[30,0,["isNotReady"]],[[[1,"    "],[10,0],[14,0,"leaderboard__not-ready"],[12],[1,"\\n      "],[10,2],[12],[1,[30,0,["model","reason"]]],[13],[1,"\\n      "],[8,[32,0],[[24,0,"btn-primary refresh"]],[["@icon","@label","@action"],["arrows-rotate","gamification.leaderboard.refresh",[30,0,["refresh"]]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[1,"    "],[10,0],[14,0,"podium__wrapper"],[12],[1,"\\n      "],[10,0],[14,0,"podium"],[12],[1,"\\n"],[42,[28,[31,3],[[28,[31,3],[[30,0,["winners"]]],null]],null],null,[[[1,"          "],[10,0],[15,0,[29,["winner -position",[30,1,["position"]]]]],[12],[1,"\\n            "],[10,0],[14,0,"winner__crown"],[12],[1,[28,[32,3],["crown"],null]],[13],[1,"\\n            "],[10,0],[14,0,"winner__avatar clickable"],[14,"role","button"],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n              "],[1,[28,[32,5],[[30,1]],[["imageSize"],["huge"]]]],[1,"\\n              "],[10,0],[14,0,"winner__rank"],[12],[1,"\\n                "],[10,1],[12],[1,[30,1,["position"]]],[13],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n            "],[10,0],[14,0,"winner__name"],[12],[1,"\\n"],[41,[30,0,["siteSettings","prioritize_username_in_ux"]],[[[1,"                "],[1,[30,1,["username"]]],[1,"\\n"]],[]],[[[1,"                "],[1,[28,[32,6],[[30,1,["name"]],[30,1,["username"]]],null]],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n            "],[10,0],[14,0,"winner__score"],[12],[1,[28,[32,7],[[30,1,["total_score"]]],null]],[13],[1,"\\n          "],[13],[1,"\\n"]],[1]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"ranking"],[12],[1,"\\n      "],[10,0],[14,0,"ranking-col-names"],[12],[1,"\\n        "],[10,1],[12],[1,[28,[32,4],["gamification.leaderboard.rank"],null]],[13],[1,"\\n        "],[10,1],[12],[1,[28,[32,3],["award"],null]],[1,[28,[32,4],["gamification.score"],null]],[13],[1,"\\n      "],[13],[1,"\\n      "],[10,0],[14,0,"ranking-col-names__sticky-border"],[12],[13],[1,"\\n"],[41,[30,0,["currentUserRanking","user"]],[[[1,"        "],[10,0],[14,0,"user -self"],[12],[1,"\\n          "],[10,0],[14,0,"user__rank"],[12],[1,[30,0,["currentUserRanking","position"]]],[13],[1,"\\n          "],[10,0],[14,0,"user__name"],[12],[1,[28,[32,4],["gamification.you"],null]],[13],[1,"\\n          "],[10,0],[14,0,"user__score"],[12],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"              "],[1,[28,[32,8],[[30,0,["currentUserRanking","user","total_score"]]],null]],[1,"\\n"]],[]],[[[1,"              "],[1,[28,[32,7],[[30,0,["currentUserRanking","user","total_score"]]],null]],[1,"\\n"]],[]]],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[8,[32,9],null,[["@action"],[[30,0,["loadMore"]]]],[["default"],[[[[1,"\\n"],[42,[28,[31,3],[[28,[31,3],[[30,0,["ranking"]]],null]],null],null,[[[1,"          "],[8,[32,10],null,[["@rank","@index"],[[30,2],[30,3]]],null],[1,"\\n"]],[2,3]],null],[1,"      "]],[]]]]],[1,"\\n      "],[8,[32,11],null,[["@condition"],[[30,0,["loading"]]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]]],[13]],["winner","rank","index"],["unless","if","each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/components/gamification-leaderboard.js",scope:()=>[n.default,g.default,i.hash,c.default,h.i18n,l.default,b.or,_.default,u.default,d.default,y.default,r.default],isStrictMode:!0}),this)}},[(0,s.tagName)("")])
e.default=w}),define("discourse/plugins/discourse-gamification/discourse/components/gamification-score",["exports","@ember/component","@ember/routing","@ember-decorators/component","discourse/plugins/discourse-gamification/discourse/helpers/fullnumber","@ember/template-factory"],function(e,t,i,o,a,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=dt7948.c(class extends t.default{static{(0,t.setComponentTemplate)((0,s.createTemplateFactory)({id:"ycOkfPzO",block:'[[[11,1],[24,0,"gamification-score"],[17,1],[12],[1,"\\n"],[41,[30,0,["site","default_gamification_leaderboard_id"]],[[[1,"    "],[8,[32,0],[[24,0,"gamification-score__link"]],[["@route","@model"],["gamificationLeaderboard.byName",[30,0,["site","default_gamification_leaderboard_id"]]]],[["default"],[[[[1,"\\n      "],[1,[28,[32,1],[[30,0,["model","gamification_score"]]],null]],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[1,"    "],[1,[28,[32,1],[[30,0,["model","gamification_score"]]],null]],[1,"\\n"]],[]]],[13]],["&attrs"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/components/gamification-score.js",scope:()=>[i.LinkTo,a.default],isStrictMode:!0}),this)}},[(0,o.tagName)("")])
e.default=r}),define("discourse/plugins/discourse-gamification/discourse/components/minimal-gamification-leaderboard-row",["exports","@glimmer/component","@ember/service","discourse/helpers/avatar","discourse/helpers/concat-class","discourse/helpers/d-icon","discourse/helpers/number","discourse/truth-helpers","discourse-i18n","discourse/plugins/discourse-gamification/discourse/helpers/sum","@ember/component","@ember/template-factory"],function(e,t,i,o,a,s,r,n,d,l,c,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{static{dt7948.g(this.prototype,"siteSettings",[i.service])}#i=void dt7948.i(this,"siteSettings")
static{(0,c.setComponentTemplate)((0,u.createTemplateFactory)({id:"6FERn2SG",block:'[[[10,0],[15,1,[29,["leaderboard-user-",[30,1,["id"]]]]],[15,0,[28,[32,0],["user",[52,[30,1,["isCurrentUser"]],"user-highlight"]],null]],[12],[1,"\\n  "],[10,0],[15,0,[28,[32,0],["user__rank",[52,[30,1,["topRanked"]],"-winner"]],null]],[12],[1,"\\n"],[41,[30,1,["topRanked"]],[[[1,"      "],[1,[28,[32,1],["crown"],null]],[1,"\\n"]],[]],[[[1,"      "],[1,[28,[32,2],[[30,2],1],null]],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n  "],[10,0],[14,"role","button"],[15,"data-user-card",[30,1,["username"]]],[14,0,"user__avatar clickable"],[12],[1,"\\n    "],[1,[28,[32,3],[[30,1]],[["imageSize"],["small"]]]],[1,"\\n\\n"],[41,[30,1,["isCurrentUser"]],[[[1,"      "],[10,1],[14,0,"user__name"],[12],[1,[28,[32,4],["gamification.you"],null]],[13],[1,"\\n"]],[]],[[[1,"      "],[10,1],[14,0,"user__name"],[12],[1,"\\n"],[41,[30,0,["siteSettings","prioritize_username_in_ux"]],[[[1,"          "],[1,[30,1,["username"]]],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[32,5],[[30,1,["name"]],[30,1,["username"]]],null]],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"user__score"],[12],[1,"\\n    "],[1,[28,[32,6],[[30,1,["total_score"]]],null]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@rank","@index"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/components/minimal-gamification-leaderboard-row.js",scope:()=>[a.default,s.default,l.default,o.default,d.i18n,n.or,r.default],isStrictMode:!0}),this)}}e.default=m}),define("discourse/plugins/discourse-gamification/discourse/components/minimal-gamification-leaderboard",["exports","@glimmer/component","@glimmer/tracking","@ember/routing","@ember/service","discourse/helpers/d-icon","discourse/helpers/number","discourse/lib/ajax","discourse-i18n","discourse/plugins/discourse-gamification/discourse/helpers/fullnumber","discourse/plugins/discourse-gamification/discourse/components/minimal-gamification-leaderboard-row","@ember/component","@ember/template-factory"],function(e,t,i,o,a,s,r,n,d,l,c,u,m){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static{dt7948.g(this.prototype,"site",[a.service])}#o=void dt7948.i(this,"site")
static{dt7948.g(this.prototype,"model",[i.tracked])}#a=void dt7948.i(this,"model")
constructor(){super(...arguments)
const e=this.args.id?`/leaderboard/${this.args.id}`:"/leaderboard";(0,n.ajax)(e,{data:{user_limit:this.args.count||10}}).then(e=>{for(const t of e.users)t.id===e.personal?.user?.id&&(t.isCurrentUser="true")
e.users[0]&&(e.users[0].topRanked=!0),this.model=e})}get notTop10(){return this.model?.personal?.position>10}static{(0,u.setComponentTemplate)((0,m.createTemplateFactory)({id:"UR5C/7va",block:'[[[10,0],[14,0,"leaderboard -minimal"],[12],[1,"\\n  "],[10,0],[14,0,"page__header"],[12],[1,"\\n    "],[8,[32,0],null,[["@route","@model"],["gamificationLeaderboard.byName",[30,0,["model","leaderboard","id"]]]],[["default"],[[[[1,"\\n      "],[10,"h3"],[14,0,"page__title"],[12],[1,[30,0,["model","leaderboard","name"]]],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"ranking-col-names"],[12],[1,"\\n    "],[10,1],[12],[1,[28,[32,1],["gamification.leaderboard.rank"],null]],[13],[1,"\\n    "],[10,1],[12],[1,[28,[32,2],["award"],null]],[1,[28,[32,1],["gamification.score"],null]],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"ranking-col-names__sticky-border"],[12],[13],[1,"\\n\\n"],[41,[30,0,["notTopTen"]],[[[1,"    "],[10,0],[14,0,"user -self"],[12],[1,"\\n      "],[10,0],[14,0,"user__rank"],[12],[1,[30,0,["model","personal","position"]]],[13],[1,"\\n      "],[10,0],[14,0,"user__name"],[12],[1,[28,[32,1],["gamification.you"],null]],[13],[1,"\\n      "],[10,0],[14,0,"user__score"],[12],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"          "],[1,[28,[32,3],[[30,0,["model","personal","user","total_score"]]],null]],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[32,4],[[30,0,["model","personal","user","total_score"]]],null]],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["model","users"]]],null]],null],null,[[[1,"    "],[8,[32,5],null,[["@rank","@index"],[[30,1],[30,2]]],null],[1,"\\n"]],[1,2]],null],[13]],["rank","index"],["if","each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/components/minimal-gamification-leaderboard.js",scope:()=>[o.LinkTo,d.i18n,s.default,r.default,l.default,c.default],isStrictMode:!0}),this)}}e.default=p}),define("discourse/plugins/discourse-gamification/discourse/components/modal/leaderboard-info",["exports","@ember/template","discourse/components/d-modal","discourse/helpers/d-icon","discourse-i18n","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,i,o,a,s,r,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,s.setComponentTemplate)((0,r.createTemplateFactory)({id:"LPqsujpR",block:'[[[8,[32,0],[[24,0,"leaderboard-info-modal"]],[["@title","@closeModal"],[[28,[32,1],["gamification.leaderboard.modal.title"],null],[30,1]]],[["body"],[[[[1,"\\n    "],[1,[28,[32,2],["award"],null]],[1,"\\n    "],[1,[28,[32,3],[[28,[32,1],["gamification.leaderboard.modal.text"],null]],null]],[1,"\\n  "]],[]]]]]],["@closeModal"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/components/modal/leaderboard-info.js",scope:()=>[i.default,a.i18n,o.default,t.htmlSafe],isStrictMode:!0}),(0,n.default)(void 0,"leaderboard-info:LeaderboardInfo"))
e.default=d}),define("discourse/plugins/discourse-gamification/discourse/components/modal/recalculate-scores-form",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/service","discourse/components/d-button","discourse/components/d-modal","discourse/components/date-picker-past","discourse/helpers/d-icon","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/decorators","discourse/select-kit/components/combo-box","discourse/truth-helpers","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,i,o,a,s,r,n,d,l,c,u,m,p,f,g,b,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class _ extends t.default{static{dt7948.g(this.prototype,"messageBus",[s.service])}#s=void dt7948.i(this,"messageBus")
static{dt7948.g(this.prototype,"updateRangeValue",[i.tracked],function(){return 0})}#r=void dt7948.i(this,"updateRangeValue")
static{dt7948.g(this.prototype,"recalculateFromDate",[i.tracked],function(){return""})}#n=void dt7948.i(this,"recalculateFromDate")
static{dt7948.g(this.prototype,"haveAvailability",[i.tracked],function(){return this.args.model.recalculate_scores_remaining>0})}#d=void dt7948.i(this,"haveAvailability")
static{dt7948.g(this.prototype,"remaining",[i.tracked],function(){return this.args.model.recalculate_scores_remaining})}#l=void dt7948.i(this,"remaining")
static{dt7948.g(this.prototype,"status",[i.tracked],function(){return"initial"})}#c=void dt7948.i(this,"status")
updateRange=[{name:(0,g.i18n)("gamification.update_range.last_10_days"),value:0,calculation:{count:10,type:"days"}},{name:(0,g.i18n)("gamification.update_range.last_30_days"),value:1,calculation:{count:30,type:"days"}},{name:(0,g.i18n)("gamification.update_range.last_90_days"),value:2,calculation:{count:90,type:"days"}},{name:(0,g.i18n)("gamification.update_range.last_year"),value:3,calculation:{count:1,type:"year"}},{name:(0,g.i18n)("gamification.update_range.all_time"),value:4},{name:(0,g.i18n)("gamification.update_range.custom_date_range"),value:5}]
constructor(){super(...arguments),this.messageBus.subscribe("/recalculate_scores",this.onMessage)}willDestroy(){super.willDestroy(...arguments),this.messageBus.unsubscribe("/recalculate_scores",this.onMessage)}onMessage(e){e.success&&(this.status="complete",this.args.model.recalculate_scores_remaining=e.remaining,this.remaining=e.remaining)}static{dt7948.n(this.prototype,"onMessage",[m.bind])}get remainingText(){return(0,g.i18n)("gamification.daily_update_scores_availability",{count:this.remaining})}get applyDisabled(){return!this.haveAvailability||"initial"!==this.status||5===this.updateRangeValue&&this.recalculateFromDate<=moment().locale("en").utc().endOf("day")}get dateRange(){if(4===this.updateRangeValue)return
let e=moment().locale("en").utc().endOf("day")
return`${this.dateRangeToDate(this.updateRangeValue)} - ${e.format((0,g.i18n)("dates.long_with_year_no_time"))}`}dateRangeToDate(e){if(4===e)return"2014-8-26"
if(5===e)return this.recalculateFromDate
let t=moment().locale("en").utc().endOf("day"),i=this.updateRange.find(t=>t.value===e)
return t.clone().subtract(i.calculation.count,i.calculation.type).format((0,g.i18n)("dates.long_with_year_no_time"))}static{dt7948.n(this.prototype,"dateRangeToDate",[m.bind])}apply(){this.status="loading"
const e={from_date:this.dateRangeToDate(this.updateRangeValue)}
return(0,c.ajax)("/admin/plugins/gamification/recalculate-scores.json",{data:e,type:"PUT"}).catch(u.popupAjaxError)}static{dt7948.n(this.prototype,"apply",[a.action])}static{(0,b.setComponentTemplate)((0,h.createTemplateFactory)({id:"2hdIuG8Y",block:'[[[8,[32,0],[[24,0,"recalculate-scores-form-modal"]],[["@title"],[[28,[32,1],["gamification.recalculate"],null]]],[["body","footer"],[[[[1,"\\n"],[41,[28,[32,2],[[30,0,["status"]],"loading"],null],[[[1,"      "],[10,0],[14,0,"recalculate-modal__status"],[12],[1,"\\n        "],[10,"em"],[12],[1,[28,[32,1],["gamification.recalculating"],null]],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[28,[32,2],[[30,0,["status"]],"complete"],null],[[[1,"      "],[10,0],[14,0,"recalculate-modal__status is-success"],[12],[1,"\\n        "],[1,[28,[32,3],["check"],null]],[1,"\\n        "],[1,[28,[32,1],["gamification.completed"],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,"form"],[14,0,"form-horizontal"],[12],[1,"\\n        "],[10,0],[14,0,"input-group"],[12],[1,"\\n          "],[10,"label"],[12],[1,[28,[32,1],["gamification.update_scores_help"],null]],[13],[1,"\\n          "],[8,[32,4],null,[["@id","@valueProperty","@content","@value","@onChange"],["update-range","value",[30,0,["updateRange"]],[30,0,["updateRangeValue"]],[28,[32,5],[[28,[31,1],[[30,0,["updateRangeValue"]]],null]],null]]],null],[1,"\\n\\n"],[41,[28,[32,2],[[30,0,["updateRangeValue"]],5],null],[[[1,"            "],[10,0],[14,0,"input-group -custom-range"],[12],[1,"\\n              "],[10,"label"],[12],[1,[28,[32,1],["gamification.custom_range_from"],null]],[13],[1,"\\n              "],[8,[32,6],[[24,0,"date-input"]],[["@id","@placeholder","@value","@onSelect"],["custom-from-date","yyyy-mm-dd",[30,0,["recalculateFromDate"]],[28,[32,5],[[28,[31,1],[[30,0,["recalculateFromDate"]]],null]],null]]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[1,"            "],[10,0],[14,0,"recalculate-modal__date-range"],[12],[1,"\\n              "],[1,[30,0,["dateRange"]]],[1,"\\n            "],[13],[1,"\\n"]],[]]],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n    "]],[]]]],[]]],[1,"  "]],[]],[[[1,"\\n    "],[8,[32,7],[[24,1,"apply-section"],[24,0,"btn-primary"]],[["@action","@label","@ariaLabel","@disabled"],[[30,0,["apply"]],"gamification.apply","gamification.apply",[30,0,["applyDisabled"]]]],null],[1,"\\n    "],[8,[32,7],[[24,1,"cancel-section"],[24,0,"btn-secondary"]],[["@action","@label","@ariaLabel"],[[30,1],[52,[28,[32,2],[[30,0,["status"]],"complete"],null],"gamification.close","gamification.cancel"],"gamification.cancel"]],null],[1,"\\n\\n    "],[10,0],[14,0,"recalculate-modal__footer-text"],[12],[1,[30,0,["remainingText"]]],[13],[1,"\\n  "]],[]]]]]],["@closeModal"],["if","mut"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/components/modal/recalculate-scores-form.js",scope:()=>[n.default,g.i18n,f.eq,l.default,p.default,o.fn,d.default,r.default],isStrictMode:!0}),this)}}e.default=_}),define("discourse/plugins/discourse-gamification/discourse/components/period-input",["exports","@ember/object","@ember-decorators/component","discourse/select-kit/components/combo-box","discourse/select-kit/components/select-kit","discourse-i18n","discourse/plugins/discourse-gamification/discourse/components/gamification-leaderboard"],function(e,t,i,o,a,s,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=dt7948.c(class extends o.default{get content(){let e=[]
return e=e.concat(r.LEADERBOARD_PERIODS.map((e,t)=>({name:(0,s.i18n)(`gamification.leaderboard.period.${e}`),id:t}))),e}static{dt7948.n(this.prototype,"content",[t.computed])}},[(0,i.classNames)("period-input","period-input"),(0,a.pluginApiIdentifiers)("period-input"),(0,a.selectKitOptions)({filterable:!0,allowAny:!1})])
e.default=n}),define("discourse/plugins/discourse-gamification/discourse/connectors/user-card-metadata/gamification-score",["exports","@ember/component","@ember-decorators/component","discourse-i18n","discourse/plugins/discourse-gamification/discourse/components/gamification-score","@ember/template-factory"],function(e,t,i,o,a,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=dt7948.c(class extends t.default{static{(0,t.setComponentTemplate)((0,s.createTemplateFactory)({id:"A78qag9f",block:'[[[11,0],[24,0,"user-card-metadata-outlet gamification-score"],[17,1],[12],[1,"\\n"],[41,[30,0,["user","gamification_score"]],[[[1,"    "],[10,1],[14,0,"desc"],[12],[1,[28,[32,0],["gamification.score"],null]],[1," "],[13],[1,"\\n    "],[10,1],[12],[8,[32,1],null,[["@model"],[[30,0,["user"]]]],null],[13],[1,"\\n"]],[]],null],[13]],["&attrs"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/connectors/user-card-metadata/gamification-score.js",scope:()=>[o.i18n,a.default],isStrictMode:!0}),this)}},[(0,i.tagName)("")])
e.default=r}),define("discourse/plugins/discourse-gamification/discourse/connectors/user-profile-secondary/gamification-score",["exports","discourse-i18n","discourse/plugins/discourse-gamification/discourse/components/gamification-score","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,i,o,a,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,o.setComponentTemplate)((0,a.createTemplateFactory)({id:"n4E1GhxH",block:'[[[41,[30,1,["gamification_score"]],[[[1,"  "],[10,0],[12],[1,"\\n    "],[10,"dt"],[12],[1,"\\n      "],[1,[28,[32,0],["gamification.score"],null]],[1,"\\n    "],[13],[1,"\\n    "],[10,"dd"],[12],[1,"\\n      "],[8,[32,1],null,[["@model"],[[30,1]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@model"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/connectors/user-profile-secondary/gamification-score.js",scope:()=>[t.i18n,i.default],isStrictMode:!0}),(0,s.default)(void 0,"gamification-score:GamificationScoreConnector"))
e.default=r}),define("discourse/plugins/discourse-gamification/discourse/gamification-route-map",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){this.route("gamificationLeaderboard",{path:"/leaderboard"},function(){this.route("byName",{path:"/:leaderboardId"})})}}),define("discourse/plugins/discourse-gamification/discourse/helpers/fullnumber",["exports","@ember/component/helper","discourse-i18n"],function(e,t,i){"use strict"
function o(e){return i.default.toNumber(e,{precision:0})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.fullnumber=o
e.default=t.default.helper(o)}),define("discourse/plugins/discourse-gamification/discourse/helpers/sum",["exports","@ember/component/helper"],function(e,t){"use strict"
function i(e){return e[0]+e[1]}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.sum=i
e.default=t.default.helper(i)}),define("discourse/plugins/discourse-gamification/discourse/models/gamification-leaderboard",["exports","@glimmer/tracking","discourse-i18n","discourse/plugins/discourse-gamification/discourse/components/gamification-leaderboard"],function(e,t,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a{static create(e={}){return new a(e)}static{dt7948.g(this.prototype,"id",[t.tracked])}#u=void dt7948.i(this,"id")
static{dt7948.g(this.prototype,"createdAt",[t.tracked])}#m=void dt7948.i(this,"createdAt")
static{dt7948.g(this.prototype,"updatedAt",[t.tracked])}#p=void dt7948.i(this,"updatedAt")
static{dt7948.g(this.prototype,"createdById",[t.tracked])}#f=void dt7948.i(this,"createdById")
static{dt7948.g(this.prototype,"excludedGroupsIds",[t.tracked])}#g=void dt7948.i(this,"excludedGroupsIds")
static{dt7948.g(this.prototype,"includedGroupsIds",[t.tracked])}#b=void dt7948.i(this,"includedGroupsIds")
static{dt7948.g(this.prototype,"visibleToGroupsIds",[t.tracked])}#h=void dt7948.i(this,"visibleToGroupsIds")
static{dt7948.g(this.prototype,"forCategoryId",[t.tracked])}#_=void dt7948.i(this,"forCategoryId")
static{dt7948.g(this.prototype,"fromDate",[t.tracked])}#y=void dt7948.i(this,"fromDate")
static{dt7948.g(this.prototype,"toDate",[t.tracked])}#v=void dt7948.i(this,"toDate")
static{dt7948.g(this.prototype,"name",[t.tracked])}#k=void dt7948.i(this,"name")
static{dt7948.g(this.prototype,"period",[t.tracked])}#w=void dt7948.i(this,"period")
static{dt7948.g(this.prototype,"periodFilterDisabled",[t.tracked])}#x=void dt7948.i(this,"periodFilterDisabled")
constructor(e={}){this.id=e.id,this.createdAt=e.created_at,this.updatedAt=e.updated_at,this.createdById=e.created_by_id,this.excludedGroupsIds=e.excluded_groups_ids,this.includedGroupsIds=e.included_groups_ids,this.visibleToGroupsIds=e.visible_to_groups_ids,this.forCategoryId=e.for_category_id,this.fromDate=e.from_date,this.toDate=e.to_date,this.name=e.name,this.period=e.period,this.periodFilterDisabled=e.period_filter_disabled,Number.isInteger(e.default_period)&&(this.defaultPeriod=(0,i.i18n)(`gamification.leaderboard.period.${o.LEADERBOARD_PERIODS[e.default_period]}`))}}e.default=a}),define("discourse/plugins/discourse-gamification/discourse/routes/gamification-leaderboard",["exports","@ember/routing/route"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{}e.default=i}),define("discourse/plugins/discourse-gamification/discourse/routes/gamification-leaderboard/by-name",["exports","@ember/service","discourse/lib/ajax","discourse/routes/discourse"],function(e,t,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends o.default{static{dt7948.g(this.prototype,"router",[t.service])}#e=void dt7948.i(this,"router")
model(e){return(0,i.ajax)(`/leaderboard/${e.leaderboardId}`).then(e=>e).catch(()=>this.router.replaceWith("/404"))}}e.default=a}),define("discourse/plugins/discourse-gamification/discourse/routes/gamification-leaderboard/index",["exports","@ember/service","discourse/lib/ajax","discourse/routes/discourse"],function(e,t,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends o.default{static{dt7948.g(this.prototype,"router",[t.service])}#e=void dt7948.i(this,"router")
model(){return(0,i.ajax)("/leaderboard").then(e=>e).catch(()=>this.router.replaceWith("/404"))}}e.default=a}),define("discourse/plugins/discourse-gamification/discourse/templates/gamification-leaderboard",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.setComponentTemplate)((0,i.createTemplateFactory)({id:"xvBoMHQP",block:'[[[46,[28,[31,1],null,null],null,null,null]],[],["component","-outlet"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/templates/gamification-leaderboard.js",isStrictMode:!0}),(0,o.default)(void 0,"gamification-leaderboard"))}),define("discourse/plugins/discourse-gamification/discourse/templates/gamification-leaderboard/by-name",["exports","discourse/plugins/discourse-gamification/discourse/components/gamification-leaderboard","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,i,o,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,i.setComponentTemplate)((0,o.createTemplateFactory)({id:"RIVbyklr",block:'[[[8,[32,0],null,[["@model"],[[30,1,["model"]]]],null]],["@controller"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/templates/gamification-leaderboard/by-name.js",scope:()=>[t.default],isStrictMode:!0}),(0,a.default)(void 0,"by-name"))}),define("discourse/plugins/discourse-gamification/discourse/templates/gamification-leaderboard/index",["exports","discourse/plugins/discourse-gamification/discourse/components/gamification-leaderboard","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,i,o,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,i.setComponentTemplate)((0,o.createTemplateFactory)({id:"RahTMPeU",block:'[[[8,[32,0],null,[["@model"],[[30,1,["model"]]]],null]],["@controller"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-gamification/discourse/templates/gamification-leaderboard/index.js",scope:()=>[t.default],isStrictMode:!0}),(0,a.default)(void 0,"gamification-leaderboard"))}),define("discourse/plugins/discourse-gamification/initializers/admin-plugin-configuration-nav",["exports","discourse/lib/plugin-api"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"discourse-gamification-admin-plugin-configuration-nav",initialize(e){const i=e.lookup("service:current-user")
i&&i.admin&&(0,t.withPluginApi)(e=>{e.setAdminPluginIcon("discourse-gamification","trophy"),e.addAdminPluginConfigurationNav("discourse-gamification",[{label:"gamification.leaderboard.title",route:"adminPlugins.show.discourse-gamification-leaderboards"}])})}}})

//# sourceMappingURL=discourse-gamification-ed290c25.map