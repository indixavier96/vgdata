define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-adapter",["exports","discourse/adapters/rest"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{basePath(){return"/discourse-post-event/"}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-event",["exports","@ember/string","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-adapter"],function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends s.default{pathFor(e,s,i){const n=this.basePath(e,s,i)+(0,t.underscore)(e.pluralize(this.apiNameFor(s)))
return this.appendQueryParams(n,i)}apiNameFor(){return"event"}}e.default=i}),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-invitee",["exports","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-nested-adapter"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{apiNameFor(){return"invitee"}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-nested-adapter",["exports","@ember/string","discourse/adapters/rest","discourse/lib/ajax","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-adapter"],function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends n.default{destroyRecord(e,t,s){return(0,i.ajax)(this.pathFor(e,t,{post_id:s.post_id,id:s.id}),{type:"DELETE"})}update(e,n,o,r){const a={},d=(0,t.underscore)(this.apiNameFor(n))
return a[d]=r,(0,i.ajax)(this.pathFor(e,n,{id:o,post_id:r.post_id}),this.getPayload("PUT",a)).then(function(e){return new s.Result(e[d],e)})}createRecord(e,n,o){const r={},a=(0,t.underscore)(this.apiNameFor(n))
return r[a]=o,(0,i.ajax)(this.pathFor(e,n,o),this.getPayload("POST",r)).then(function(e){return new s.Result(e[a],e)})}pathFor(e,s,i){const n=i.post_id
delete i.post_id
const o=i.id
delete i.id
let r=this.basePath(e,s,{})+"events/"+n+"/"+(0,t.underscore)(e.pluralize(this.apiNameFor()))
return o&&(r+=`/${o}`),this.appendQueryParams(r,i)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-reminder",["exports","discourse/plugins/discourse-calendar/discourse/adapters/discourse-post-event-nested-adapter"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{apiNameFor(){return"reminder"}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/admin-calendar-route-map",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"admin.adminPlugins.show",path:"/plugins",map(){this.route("discourse-calendar-holidays",{path:"holidays"})}}}),define("discourse/plugins/discourse-calendar/discourse/api-initializers/discourse-group-timezones",["exports","discourse/lib/api","discourse/plugins/discourse-calendar/discourse/components/group-timezones","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"qHshv2sf",block:'[[[8,[32,0],null,[["@members","@group","@size"],[[30,1,["members"]],[30,1,["group"]],[30,1,["size"]]]],null]],["@data"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/api-initializers/discourse-group-timezones.js",scope:()=>[s.default],isStrictMode:!0}),(0,o.default)(void 0,"discourse-group-timezones:GroupTimezonesShim"))
e.default=(0,t.apiInitializer)(e=>{e.decorateCookedElement((e,t)=>{e.querySelectorAll(".group-timezones").forEach(e=>{const s=t.getModel()
if(!s)return
const i=e.dataset.group
if(!i)throw new Error("Group timezone element is missing 'data-group' attribute")
t.renderGlimmer(e,r,{group:i,members:(s.group_timezones||{})[i]||[],size:e.dataset.size||"medium"})})})})}),define("discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list-item",["exports","@glimmer/component","@glimmer/tracking","@ember/object","discourse/components/d-button","discourse/lib/ajax","discourse/lib/ajax-error","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static{dt7948.g(this.prototype,"loading",[s.tracked],function(){return!1})}#e=void dt7948.i(this,"loading")
static{dt7948.g(this.prototype,"isHolidayDisabled",[s.tracked],function(){return this.args.isHolidayDisabled||!1})}#t=void dt7948.i(this,"isHolidayDisabled")
async toggleEnableHoliday(){if(this.loading)return
let e,t
this.isHolidayDisabled?(e="/admin/discourse-calendar/holidays/enable",t="DELETE"):(e="/admin/discourse-calendar/holidays/disable",t="POST"),this.loading=!0
try{await(0,o.ajax)({url:e,type:t,data:{disabled_holiday:{holiday_name:this.args.holiday.name,region_code:this.args.regionCode}}}),this.isHolidayDisabled=!this.isHolidayDisabled}catch(s){(0,r.popupAjaxError)(s)}finally{this.loading=!1}}static{dt7948.n(this.prototype,"toggleEnableHoliday",[i.action])}static{(0,a.setComponentTemplate)((0,d.createTemplateFactory)({id:"R+CqNlx4",block:'[[[10,"tr"],[15,0,[29,["d-table__row ",[52,[30,0,["isHolidayDisabled"]],"--disabled"]]]],[12],[1,"\\n  "],[10,"td"],[14,0,"d-table__cell --detail"],[12],[1,[30,1,["date"]]],[13],[1,"\\n  "],[10,"td"],[14,0,"d-table__cell --detail"],[12],[1,[30,1,["name"]]],[13],[1,"\\n  "],[10,"td"],[14,0,"d-table__cell --controls"],[12],[1,"\\n    "],[10,0],[14,0,"d-table__cell-actions"],[12],[1,"\\n      "],[8,[32,0],[[24,0,"btn-default btn-small"]],[["@action","@label","@isLoading"],[[30,0,["toggleEnableHoliday"]],[52,[30,0,["isHolidayDisabled"]],"discourse_calendar.enable_holiday","discourse_calendar.disable_holiday"],[30,0,["loading"]]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],["@holiday"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list-item.js",scope:()=>[n.default],isStrictMode:!0}),this)}}e.default=l}),define("discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list",["exports","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list-item","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"1205wszK",block:'[[[10,"table"],[14,0,"d-table admin-holidays-list"],[12],[1,"\\n  "],[10,"thead"],[14,0,"d-table__header"],[12],[1,"\\n    "],[10,"tr"],[14,0,"d-table__row"],[12],[1,"\\n      "],[10,"th"],[14,0,"d-table__header-cell"],[12],[1,[28,[32,0],["discourse_calendar.date"],null]],[13],[1,"\\n      "],[10,"th"],[14,0,"d-table__header-cell"],[12],[1,[28,[32,0],["discourse_calendar.holiday"],null]],[13],[1,"\\n      "],[10,"th"],[12],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n  "],[10,"tbody"],[14,0,"d-table__body"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,1]],null]],null],null,[[[1,"      "],[8,[32,1],null,[["@holiday","@isHolidayDisabled","@regionCode"],[[30,2],[30,2,["disabled"]],[30,3]]],null],[1,"\\n"]],[2]],null],[1,"  "],[13],[1,"\\n"],[13]],["@holidays","holiday","@regionCode"],["each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list.js",scope:()=>[t.i18n,s.default],isStrictMode:!0}),(0,o.default)(void 0,"admin-holidays-list:AdminHolidaysList"))
e.default=r}),define("discourse/plugins/discourse-calendar/discourse/components/bulk-invite-sample-csv-file",["exports","@ember/component","@ember/object","@ember-decorators/component","discourse/components/d-button","@ember/template-factory"],function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=dt7948.c(class extends t.default{downloadSampleCsv(){let e="";[["my_awesome_group","going"],["lucy","interested"],["mark","not_going"],["sam","unknown"]].forEach(t=>{e+=t.join(","),e+="\n"})
const t=document.createElement("a")
t.href=`data:text/csv;charset=utf-8,${encodeURI(e)}`,t.target="_blank",t.rel="noopener noreferrer",t.download="bulk-invite-sample.csv",t.click()}static{dt7948.n(this.prototype,"downloadSampleCsv",[s.action])}static{(0,t.setComponentTemplate)((0,o.createTemplateFactory)({id:"Zxc1aZ/w",block:'[[[11,0],[17,1],[12],[1,"\\n  "],[8,[32,0],null,[["@label","@action"],["discourse_post_event.bulk_invite_modal.download_sample_csv",[30,0,["downloadSampleCsv"]]]],null],[1,"\\n"],[13]],["&attrs"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/bulk-invite-sample-csv-file.js",scope:()=>[n.default],isStrictMode:!0}),this)}},[(0,i.tagName)("")])
e.default=r}),define("discourse/plugins/discourse-calendar/discourse/components/category-calendar",["exports","@glimmer/component","@ember/object","@ember/service","discourse/lib/ajax-error","discourse/lib/decorators","discourse/lib/get-url","discourse/models/category","discourse/plugins/discourse-calendar/discourse/helpers/format-event-name","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","discourse/plugins/discourse-calendar/discourse/components/full-calendar","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{static{dt7948.g(this.prototype,"currentUser",[i.service])}#s=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"router",[i.service])}#i=void dt7948.i(this,"router")
static{dt7948.g(this.prototype,"siteSettings",[i.service])}#n=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"discoursePostEventApi",[i.service])}#o=void dt7948.i(this,"discoursePostEventApi")
async loadEvents(e){try{const t={after:e.startStr,before:e.endStr,category_id:this.category.id,include_subcategories:!0},s=await this.discoursePostEventApi.events(t)
return this.formattedEvents(s)}catch(t){(0,n.popupAjaxError)(t)}}static{dt7948.n(this.prototype,"loadEvents",[o.bind])}get tagsColorsMap(){return JSON.parse(this.siteSettings.map_events_to_color)}get shouldRender(){return!!this.siteSettings.discourse_post_event_enabled&&(!(this.siteSettings.login_required&&!this.currentUser)&&(!!this.router.currentRoute?.params?.category_slug_path_with_id&&(!!this.category&&!!this.validCategory)))}get validCategory(){return!(!this.categorySetting&&!this.siteSettings.events_calendar_categories)&&(this.categorySetting?.categoryId===this.category.id.toString()||this.siteSettings.events_calendar_categories.split("|").filter(Boolean).includes(this.category.id.toString()))}get category(){return a.default.findBySlugPathWithID(this.router.currentRoute.params.category_slug_path_with_id)}get renderWeekends(){return"false"!==this.categorySetting?.weekends}get categorySetting(){return this.siteSettings.calendar_categories.split("|").filter(Boolean).map(e=>{const t={}
return e.split(";").filter(Boolean).forEach(e=>{const s=e.split("=")
t[s[0]]=s[1]}),t}).find(e=>e.categoryId===this.category.id.toString())}formattedEvents(e=[]){return e.map(e=>{const{startsAt:t,endsAt:s,post:i,categoryId:n}=e
let o
if(i.topic.tags){const e=this.tagsColorsMap.find(e=>"tag"===e.type&&i.topic.tags.some(t=>("string"==typeof t?t:t.name)===e.slug))
o=e?e.color:null}if(!o){const e=this.tagsColorsMap.find(e=>"category"===e.type&&e.slug===i.category_slug)?.color
o=e||`#${a.default.findById(n)?.color}`}return{title:(0,d.formatEventName)(e,this.currentUser?.user_option?.timezone),start:t,end:s||t,allDay:!(0,l.isNotFullDayEvent)(moment(t),moment(s)),url:(0,r.default)(`/t/-/${i.topic.id}/${i.post_number}`),backgroundColor:o}})}static{dt7948.n(this.prototype,"formattedEvents",[s.action])}static{(0,u.setComponentTemplate)((0,p.createTemplateFactory)({id:"9Yei10b/",block:'[[[41,[30,0,["shouldRender"]],[[[1,"  "],[8,[32,0],null,[["@onLoadEvents","@height","@initialView","@weekends","@refreshKey"],[[30,0,["loadEvents"]],"650px",[30,0,["categorySetting","defaultView"]],[30,0,["renderWeekends"]],[30,0,["category","id"]]]],null],[1,"\\n"]],[]],null]],[],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/category-calendar.js",scope:()=>[c.default],isStrictMode:!0}),this)}}e.default=m}),define("discourse/plugins/discourse-calendar/discourse/components/csv-uploader",["exports","@glimmer/component","@ember/owner","@ember/render-modifiers/modifiers/did-insert","@ember/service","discourse/helpers/d-icon","discourse/lib/uppy/uppy-upload","discourse/truth-helpers","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static{dt7948.g(this.prototype,"dialog",[n.service])}#r=void dt7948.i(this,"dialog")
uppyUpload=new r.default((0,s.getOwner)(this),{type:"csv",id:"discourse-post-event-csv-uploader",autoStartUploads:!1,uploadUrl:this.args.uploadUrl,preventDirectS3Uploads:!0,uppyReady:()=>{this.uppyUpload.uppyWrapper.uppyInstance.on("file-added",()=>{this.dialog.confirm({message:(0,d.i18n)(`${this.args.i18nPrefix}.confirmation_message`),didConfirm:()=>this.uppyUpload.startUpload(),didCancel:()=>this.uppyUpload.reset()})})},uploadDone:()=>{this.dialog.alert((0,d.i18n)(`${this.args.i18nPrefix}.success`))},validateUploadedFilesOptions:{csvOnly:!0}})
get uploadButtonText(){return this.uppyUpload.uploading?(0,d.i18n)("uploading"):(0,d.i18n)(`${this.args.i18nPrefix}.text`)}get uploadButtonDisabled(){return this.uppyUpload.uploading||this.uppyUpload.processing||null}static{(0,l.setComponentTemplate)((0,c.createTemplateFactory)({id:"7nZP1Lyc",block:'[[[10,1],[12],[1,"\\n  "],[10,"label"],[14,0,"btn"],[15,"disabled",[30,0,["uploadButtonDisabled"]]],[12],[1,"\\n    "],[1,[28,[32,0],["upload"],null]],[1," "],[1,[30,0,["uploadButtonText"]]],[1,"\\n    "],[11,"input"],[24,0,"hidden-upload-field"],[16,"disabled",[30,0,["uppyUpload","uploading"]]],[24,"accept",".csv"],[24,4,"file"],[4,[32,1],[[30,0,["uppyUpload","setup"]]],null],[12],[13],[1,"\\n  "],[13],[1,"\\n"],[41,[28,[32,2],[[30,0,["uppyUpload","uploading"]],[30,0,["uppyUpload","processing"]]],null],[[[1,"    "],[10,1],[12],[1,[28,[32,3],["upload_selector.uploading"],null]],[1,"\\n      "],[1,[30,0,["uppyUpload","uploadProgress"]]],[1,"%"],[13],[1,"\\n"]],[]],null],[13]],[],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/csv-uploader.js",scope:()=>[o.default,i.default,a.or,d.i18n],isStrictMode:!0}),this)}}e.default=u}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/chat-channel",["exports","@ember/routing","discourse/lib/utilities","discourse/truth-helpers","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,s.optionalRequire)("discourse/plugins/chat/discourse/components/channel-title"),d=(0,n.setComponentTemplate)((0,o.createTemplateFactory)({id:"TkSpl7Zo",block:'[[[41,[28,[32,0],[[30,1,["channel"]],[32,1]],null],[[[1,"  "],[10,"section"],[14,0,"event__section event-chat-channel"],[12],[1,"\\n    "],[10,1],[12],[13],[1,"\\n    "],[8,[32,2],[[24,0,"chat-channel-link"]],[["@route","@models"],["chat.channel",[30,1,["channel","routeModels"]]]],[["default"],[[[[1,"\\n      "],[8,[32,1],null,[["@channel"],[[30,1,["channel"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@event"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/chat-channel.js",scope:()=>[i.and,a,t.LinkTo],isStrictMode:!0}),(0,r.default)(void 0,"chat-channel:DiscoursePostEventChatChannel"))
e.default=d}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/creator",["exports","@glimmer/component","discourse/helpers/avatar","discourse/lib/utilities","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{get username(){return this.args.user.name||(0,i.formatUsername)(this.args.user.username)}static{(0,o.setComponentTemplate)((0,r.createTemplateFactory)({id:"ARTVi9zC",block:'[[[10,1],[14,0,"creators"],[12],[1,"\\n  "],[10,1],[14,0,"created-by"],[12],[1,[28,[32,0],["discourse_post_event.created_by"],null]],[13],[1,"\\n\\n  "],[10,1],[14,0,"event-creator"],[12],[1,"\\n    "],[10,3],[14,0,"topic-invitee-avatar"],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n      "],[1,[28,[32,1],[[30,1]],[["imageSize"],["tiny"]]]],[1,"\\n      "],[10,1],[14,0,"username"],[12],[1,[30,0,["username"]]],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],["@user"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/creator.js",scope:()=>[n.i18n,s.default],isStrictMode:!0}),this)}}e.default=a}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/dates",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/runloop","@ember/service","@ember/template","discourse/helpers/d-icon","discourse/lib/bbcode-attributes","discourse/lib/download-calendar","discourse/lib/later","discourse/lib/local-dates","discourse/lib/text","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m,v,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class g extends t.default{static{dt7948.g(this.prototype,"siteSettings",[r.service])}#n=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"currentUser",[r.service])}#s=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"htmlDates",[s.tracked],function(){return""})}#a=void dt7948.i(this,"htmlDates")
get timezone(){return this.args.event.timezone||"UTC"}get showLocalTime(){return this.args.event.showLocalTime??!0}get startsAt(){return moment.tz(this.args.event.startsAt,this.timezone)}get endsAt(){const e=this.args.event.endsAt
return e?moment.tz(e,this.timezone):null}get startsAtFormat(){const e=!this.isSameYear(this.startsAt),t=this.hasTime(this.startsAt)||this.isSingleDayEvent
return this._buildFormat(this.startsAt,{includeYear:e,includeTime:t})}get endsAtFormat(){if(this.isSingleDayEvent)return"LT"
const e=this.endsAt,t=!this.isSameYear(e)||!this.isSameYear(e,this.startsAt),s=this.hasTime(e)
return this._buildFormat(e,{includeYear:t,includeTime:s})}_buildFormat(e,{includeYear:t,includeTime:s}){const i=["ddd, MMM D"]
t&&i.push("YYYY")
return`"${i.join(", ")}${s?" LT":""}"`}get isSingleDayEvent(){return this.startsAt.isSame(this.endsAt,"day")}get datesBBCode(){const e=[],t=this.buildDateBBCode({date:this.startsAt,format:this.startsAtFormat,range:!!this.endsAt&&"from"})
if(e.push(t),this.endsAt){const t=this.buildDateBBCode({date:this.endsAt,format:this.endsAtFormat,range:"to"})
e.push(t)}return e}isSameYear(e,t){return e.isSame(t||moment(),"year")}hasTime(e){return e.hour()||e.minute()}generateIcsForEvent(){const e=this.args.event
if(!e||!this.startsAt)return null
const t=e.name||e.post?.topic?.title||"Event",s=[{startsAt:this.startsAt.toISOString(),endsAt:this.endsAt?this.endsAt.toISOString():moment(this.startsAt).add(1,"hours").toISOString(),timezone:this.timezone}],i={}
return e.rrule&&(i.rrule=e.rrule),e.location&&(i.location=e.location),e.description&&(i.details=e.description),(0,c.generateIcsData)(t,s,i)}buildDateBBCode({date:e,format:t,range:s}){const i={date:e.format("YYYY-MM-DD"),time:e.format("HH:mm"),format:t,timezone:e.tz(),postId:this.args.event.id,calendar:"on"}
this.args.event.showLocalTime&&(i.displayedTimezone=this.args.event.timezone),s&&(i.range=s)
const n=this.generateIcsForEvent()
n&&(i.ics=(0,l.bbcodeAttributeEncode)(n))
return`[${Object.entries(i).map(([e,t])=>`${e}=${t}`).join(" ")}]`}async computeDates(e){if(!this.args.expiredAndRecurring)if(this.siteSettings.discourse_local_dates_enabled){const t=this.datesBBCode.join("<span> → </span>"),s=await(0,m.cook)(t)
this.htmlDates=(0,a.htmlSafe)(s.toString()),(0,u.default)(()=>{(0,o.schedule)("afterRender",()=>{if(this.isDestroying||this.isDestroyed)return
const t=e.querySelectorAll(`[data-post-id="${this.args.event.id}"].discourse-local-date`);(0,p.applyLocalDates)(t,this.siteSettings,this.currentUser?.user_option?.timezone)})})}else{let e=`${this.startsAt.format(this.startsAtFormat)}`
if(this.endsAt){e+=` → ${moment(this.endsAt).format(this.endsAtFormat)}`}this.htmlDates=(0,a.htmlSafe)(e)}}static{dt7948.n(this.prototype,"computeDates",[i.action])}static{(0,v.setComponentTemplate)((0,h.createTemplateFactory)({id:"Brrzk6pQ",block:'[[[11,"section"],[16,"data-event-id",[30,1,["id"]]],[24,0,"event__section event-dates"],[4,[32,0],[[30,0,["computeDates"]]],null],[12],[1,"\\n  "],[1,[28,[32,1],["clock"],null]],[1,"\\n"],[41,[30,2],[[[1,"    -\\n"]],[]],[[[1,"    "],[1,[30,0,["htmlDates"]]],[1,"\\n"]],[]]],[13]],["@event","@expiredAndRecurring"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/dates.js",scope:()=>[n.default,d.default],isStrictMode:!0}),this)}}e.default=g}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/description",["exports","discourse/components/cook-text","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,s.setComponentTemplate)((0,i.createTemplateFactory)({id:"rGnyp0VU",block:'[[[41,[30,1],[[[1,"  "],[10,"section"],[14,0,"event__section event-description"],[12],[1,"\\n    "],[8,[32,0],null,[["@rawText"],[[30,1]]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@description"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/description.js",scope:()=>[t.default],isStrictMode:!0}),(0,n.default)(void 0,"description:DiscoursePostEventDescription"))
e.default=o}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/event-status",["exports","@glimmer/component","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get eventStatusLabel(){return(0,s.i18n)(`discourse_post_event.models.event.status.${this.args.event.status}.title`)}get eventStatusDescription(){return(0,s.i18n)(`discourse_post_event.models.event.status.${this.args.event.status}.description`)}get statusClass(){return`status ${this.args.event.status}`}static{(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"y74AaA9w",block:'[[[41,[30,1,["isExpired"]],[[[1,"  "],[10,1],[14,0,"status expired"],[12],[1,"\\n    "],[1,[28,[32,0],["discourse_post_event.models.event.expired"],null]],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[41,[30,1,["isClosed"]],[[[1,"  "],[10,1],[14,0,"status closed"],[12],[1,"\\n    "],[1,[28,[32,0],["discourse_post_event.models.event.closed"],null]],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[1,"  "],[10,1],[15,0,[30,0,["statusClass"]]],[15,"title",[30,0,["eventStatusDescription"]]],[12],[1,"\\n    "],[1,[30,0,["eventStatusLabel"]]],[1,"\\n  "],[13],[1,"\\n"]],[]]]],[]]]],["@event"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/event-status.js",scope:()=>[s.i18n],isStrictMode:!0}),this)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index",["exports","@glimmer/component","@glimmer/tracking","@ember/service","ember-modifier","discourse/components/async-content","discourse/components/d-button","discourse/components/plugin-outlet","discourse/helpers/d-icon","discourse/helpers/lazy-hash","discourse/helpers/replace-emoji","discourse/helpers/route-action","discourse/lib/ajax-error","discourse/lib/decorators","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/chat-channel","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/creator","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/dates","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/description","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/event-status","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitees","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/location","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/more-menu","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/status","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/url","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m,v,h,g,f,_,b,y,w,A,k,E,x,T){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const S=(0,E.setComponentTemplate)((0,x.createTemplateFactory)({id:"IedS64CU",block:'[[[10,1],[14,0,"separator"],[12],[1,"·"],[13]],[],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index.js",isStrictMode:!0}),(0,T.default)(void 0,"discourse-post-event:StatusSeparator")),M=(0,E.setComponentTemplate)((0,x.createTemplateFactory)({id:"e+gxJttM",block:'[[[11,"section"],[24,0,"event__section"],[17,1],[12],[1,"\\n"],[41,[30,2],[[[1,"    "],[1,[28,[32,0],[[30,2]],null]],[1,"\\n"]],[]],null],[1,"\\n  "],[18,3,null],[1,"\\n"],[13]],["&attrs","@icon","&default"],["if","yield"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index.js",scope:()=>[d.default],isStrictMode:!0}),(0,T.default)(void 0,"discourse-post-event:InfoSection"))
class D extends t.default{static{dt7948.g(this.prototype,"currentUser",[i.service])}#s=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"discoursePostEventApi",[i.service])}#o=void dt7948.i(this,"discoursePostEventApi")
static{dt7948.g(this.prototype,"messageBus",[i.service])}#d=void dt7948.i(this,"messageBus")
static{dt7948.g(this.prototype,"event",[s.tracked])}#l=void dt7948.i(this,"event")
setupMessageBus=(0,n.modifier)(()=>{const e=`/discourse-post-event/${this.event.post.topic.id}`
return this.messageBus.subscribe(e,async e=>{const t=await this.discoursePostEventApi.event(e.id)
this.event.updateFromEvent(t)}),()=>this.messageBus.unsubscribe(e)})
getDisplayTime(e){return this.event.showLocalTime?moment.tz(e,this.event.timezone||"UTC"):moment.utc(e).tz(this.currentUser?.user_option?.timezone||moment.tz.guess())}get withDescription(){return this.args.withDescription??!0}get startsAtMonth(){return this.getDisplayTime(this.event.startsAt).format("MMM")}get startsAtDay(){return this.getDisplayTime(this.event.startsAt).format("D")}get eventName(){return this.event.name||this.event.post.topic.title}get isPublicEvent(){return"public"===this.event.status}get isStandaloneEvent(){return"standalone"===this.event.status}get canActOnEvent(){return this.currentUser&&this.event.can_act_on_discourse_post_event}get watchingInviteeStatus(){return this.event.watchingInvitee?.status}get expiredAndRecurring(){return this.event.isExpired&&this.event.recurrence}async loadEvent(){if(this.event)return this.event
if(this.args.event)try{this.event=await this.discoursePostEventApi.event(this.args.event.id),this.event.startsAt=this.args.event.startsAt,this.event.endsAt=this.args.event.endsAt}catch(e){(0,p.popupAjaxError)(e)}}static{dt7948.n(this.prototype,"loadEvent",[m.bind])}static{(0,E.setComponentTemplate)((0,x.createTemplateFactory)({id:"OtYJ0aJo",block:'[[[8,[32,0],null,[["@asyncData"],[[30,0,["loadEvent"]]]],[["content","loading"],[[[[1,"\\n    "],[10,0],[14,0,"discourse-post-event"],[12],[1,"\\n      "],[10,0],[14,0,"discourse-post-event-widget"],[12],[1,"\\n"],[41,[30,1],[[[1,"          "],[11,"header"],[24,0,"event-header"],[4,[30,0,["setupMessageBus"]],null,null],[12],[1,"\\n            "],[10,0],[14,0,"event-date"],[12],[1,"\\n              "],[10,0],[14,0,"month"],[12],[1,"\\n"],[41,[30,0,["expiredAndRecurring"]],[[[1,"                  -\\n"]],[]],[[[1,"                  "],[1,[30,0,["startsAtMonth"]]],[1,"\\n"]],[]]],[1,"              "],[13],[1,"\\n              "],[10,0],[14,0,"day"],[12],[1,"\\n"],[41,[30,0,["expiredAndRecurring"]],[[[1,"                  -\\n"]],[]],[[[1,"                  "],[1,[30,0,["startsAtDay"]]],[1,"\\n"]],[]]],[1,"              "],[13],[1,"\\n            "],[13],[1,"\\n            "],[10,0],[14,0,"event-info"],[12],[1,"\\n              "],[10,1],[14,0,"name"],[12],[1,"\\n"],[41,[30,2],[[[1,"                  "],[10,3],[15,6,[30,1,["post","url"]]],[14,"rel","noopener noreferrer"],[12],[1,[28,[32,1],[[30,0,["eventName"]]],null]],[13],[1,"\\n"]],[]],[[[1,"                  "],[1,[28,[32,1],[[30,0,["eventName"]]],null]],[1,"\\n"]],[]]],[1,"              "],[13],[1,"\\n              "],[10,0],[14,0,"status-and-creators"],[12],[1,"\\n                "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-and-creators",[28,[32,3],null,[["event","Separator","Status","Creator"],[[30,1],[32,4],[50,[32,5],0,null,[["event"],[[30,1]]]],[50,[32,6],0,null,[["user"],[[30,1,["creator"]]]]]]]]]],[["default"],[[[[1,"\\n                  "],[8,[32,5],null,[["@event"],[[30,1]]],null],[1,"\\n                  "],[8,[32,4],null,null,null],[1,"\\n                  "],[8,[32,6],null,[["@user"],[[30,1,["creator"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n\\n            "],[8,[32,7],null,[["@event","@isStandaloneEvent","@composePrivateMessage"],[[30,1],[30,0,["isStandaloneEvent"]],[28,[32,8],["composePrivateMessage"],null]]],null],[1,"\\n\\n"],[41,[30,3],[[[1,"              "],[8,[32,9],[[24,0,"btn-default btn-small discourse-post-event-close"]],[["@icon","@action"],["xmark",[30,3]]],null],[1,"\\n"]],[]],null],[1,"          "],[13],[1,"\\n\\n          "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-info",[28,[32,3],null,[["event","Section","Url","Description","Location","Dates","Invitees","Status","ChatChannel"],[[30,1],[50,[32,10],0,null,[["event"],[[30,1]]]],[50,[32,11],0,null,[["url"],[[30,1,["url"]]]]],[50,[32,12],0,null,[["description"],[[30,1,["description"]]]]],[50,[32,13],0,null,[["location"],[[30,1,["location"]]]]],[50,[32,14],0,null,[["event","expiredAndRecurring"],[[30,1],[30,0,["expiredAndRecurring"]]]]],[50,[32,15],0,null,[["event"],[[30,1]]]],[50,[32,16],0,null,[["event"],[[30,1]]]],[50,[32,17],0,null,[["event"],[[30,1]]]]]]]]],[["default"],[[[[1,"\\n            "],[8,[32,14],null,[["@event","@expiredAndRecurring"],[[30,1],[30,0,["expiredAndRecurring"]]]],null],[1,"\\n            "],[8,[32,13],null,[["@location"],[[30,1,["location"]]]],null],[1,"\\n            "],[8,[32,11],null,[["@url"],[[30,1,["url"]]]],null],[1,"\\n            "],[8,[32,17],null,[["@event"],[[30,1]]],null],[1,"\\n            "],[8,[32,15],null,[["@event"],[[30,1]]],null],[1,"\\n\\n"],[41,[30,0,["withDescription"]],[[[1,"              "],[8,[32,12],null,[["@description"],[[30,1,["description"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,4,["canUpdateAttendance"]],[[[1,"              "],[8,[32,16],null,[["@event"],[[30,1]]],null],[1,"\\n"]],[]],null],[1,"          "]],[]]]]],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[1]],[[[1,"\\n    "],[10,0],[14,0,"discourse-post-event-loader"],[12],[1,"\\n      "],[10,0],[14,0,"spinner"],[12],[13],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]]],["event","@linkToPost","@onClose","@event"],["if","component"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/index.js",scope:()=>[o.default,c.default,a.default,l.default,S,_.default,h.default,w.default,u.default,r.default,M,k.default,f.default,y.default,g.default,b.default,A.default,v.default],isStrictMode:!0}),this)}}e.default=D}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitee",["exports","@glimmer/component","@ember/helper","@ember/service","discourse/components/avatar-flair","discourse/helpers/avatar","discourse/helpers/concat-class","discourse/truth-helpers","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static{dt7948.g(this.prototype,"site",[i.service])}#c=void dt7948.i(this,"site")
static{dt7948.g(this.prototype,"currentUser",[i.service])}#s=void dt7948.i(this,"currentUser")
get statusIcon(){switch(this.args.invitee.status){case"going":return"check"
case"interested":return"star"
case"not_going":return"xmark"}}get flairName(){const e=`discourse_post_event.models.invitee.status.${this.args.invitee.status}`
return(0,d.i18n)(e)}static{(0,l.setComponentTemplate)((0,c.createTemplateFactory)({id:"Y4w6irZA",block:'[[[10,"li"],[15,0,[28,[32,0],["event-invitee",[52,[30,1,["status"]],[28,[32,1],["status-",[30,1,["status"]]],null]],[52,[28,[32,2],[[30,0,["currentUser","id"]],[30,1,["user","id"]]],null],"is-current-user"]],null]],[12],[1,"\\n  "],[10,3],[14,0,"topic-invitee-avatar"],[15,"data-user-card",[30,1,["user","username"]]],[12],[1,"\\n    "],[1,[28,[32,3],[[30,1,["user"]]],[["imageSize"],[[52,[30,0,["site","mobileView"]],"tiny","large"]]]]],[1,"\\n"],[41,[30,0,["statusIcon"]],[[[1,"      "],[8,[32,4],null,[["@flairName","@flairUrl"],[[30,0,["flairName"]],[30,0,["statusIcon"]]]],null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"],[13]],["@invitee"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitee.js",scope:()=>[r.default,s.concat,a.eq,o.default,n.default],isStrictMode:!0}),this)}}e.default=u}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitees",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/helpers/d-icon","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitee","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static{dt7948.g(this.prototype,"modal",[i.service])}#u=void dt7948.i(this,"modal")
showInvitees(){this.modal.show(a.default,{model:{event:this.args.event,title:this.args.event.title,extraClass:this.args.event.extraClass}})}static{dt7948.n(this.prototype,"showInvitees",[s.action])}get hasAttendees(){return this.args.event.stats.going>0}get statsInfo(){return this.args.event.stats.going}get inviteesTitle(){return(0,r.i18n)("discourse_post_event.models.invitee.status.going_count",{count:this.args.event.stats.going})}static{(0,l.setComponentTemplate)((0,c.createTemplateFactory)({id:"DXq32rc/",block:'[[[41,[51,[30,1,["minimal"]]],[[[41,[30,1,["shouldDisplayInvitees"]],[[[1,"    "],[10,"section"],[14,0,"event__section event-invitees"],[12],[1,"\\n      "],[10,0],[14,0,"event-invitees-avatars-container"],[12],[1,"\\n        "],[8,[32,0],[[24,0,"event-invitees-icon btn-transparent"],[16,"title",[30,0,["inviteesTitle"]]]],[["@action"],[[30,0,["showInvitees"]]]],[["default"],[[[[1,"\\n          "],[1,[28,[32,1],["users"],null]],[1,"\\n"],[41,[30,0,["hasAttendees"]],[[[1,"            "],[10,1],[14,0,"going"],[12],[1,[30,0,["statsInfo"]]],[13],[1,"\\n"]],[]],null],[1,"        "]],[]]]]],[1,"\\n        "],[10,"ul"],[14,0,"event-invitees-avatars"],[12],[1,"\\n"],[42,[28,[31,3],[[28,[31,3],[[30,1,["sampleInvitees"]]],null]],null],null,[[[1,"            "],[8,[32,2],null,[["@invitee"],[[30,2]]],null],[1,"\\n"]],[2]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],[[[41,[51,[30,1,["isStandalone"]]],[[[1,"      "],[10,"section"],[14,0,"event__section event-invitees no-rsvp"],[12],[1,"\\n        "],[10,2],[14,0,"no-rsvp-description"],[12],[1,[28,[32,3],["discourse_post_event.models.invitee.status.going_count.other"],[["count"],["0"]]]],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null]],[]]]],[]],null]],["@event","invitee"],["unless","if","each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/invitees.js",scope:()=>[n.default,o.default,d.default,r.i18n],isStrictMode:!0}),this)}}e.default=u}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/location",["exports","discourse/components/cook-text","discourse/helpers/d-icon","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"u44F2EkA",block:'[[[41,[30,1],[[[1,"  "],[10,"section"],[14,0,"event__section event-location"],[12],[1,"\\n    "],[1,[28,[32,0],["location-pin"],null]],[1,"\\n\\n    "],[8,[32,1],null,[["@rawText"],[[30,1]]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@location"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/location.js",scope:()=>[s.default,t.default],isStrictMode:!0}),(0,o.default)(void 0,"location:DiscoursePostEventLocation"))
e.default=r}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/more-menu",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/service","discourse/components/d-button","discourse/components/dropdown-menu","discourse/float-kit/components/d-menu","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse/lib/download-calendar","discourse/lib/export-csv","discourse/lib/text","discourse/lib/transformer","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/raw-event-helper","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-bulk-invite","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invite-user-or-group","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m,v,h,g,f,_,b,y,w,A){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class k extends t.default{static{dt7948.g(this.prototype,"currentUser",[o.service])}#s=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"dialog",[o.service])}#r=void dt7948.i(this,"dialog")
static{dt7948.g(this.prototype,"modal",[o.service])}#u=void dt7948.i(this,"modal")
static{dt7948.g(this.prototype,"router",[o.service])}#i=void dt7948.i(this,"router")
static{dt7948.g(this.prototype,"siteSettings",[o.service])}#n=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"store",[o.service])}#p=void dt7948.i(this,"store")
static{dt7948.g(this.prototype,"isSavingEvent",[s.tracked],function(){return!1})}#m=void dt7948.i(this,"isSavingEvent")
get expiredOrClosed(){return this.args.event.isExpired||this.args.event.isClosed}get canActOnEvent(){return this.currentUser&&this.args.event.canActOnDiscoursePostEvent}get shouldShowParticipants(){return(0,v.applyValueTransformer)("discourse-calendar-event-more-menu-should-show-participants",this.canActOnEvent&&!this.args.isStandaloneEvent,{event:this.args.event})}get canInvite(){return!this.expiredOrClosed&&this.canActOnEvent&&this.args.event.isPublic}get canSeeUpcomingEvents(){return!this.args.event.isClosed&&this.args.event.recurrence}get canBulkInvite(){return!this.expiredOrClosed&&!this.args.event.isStandalone}get canSendPmToCreator(){return this.currentUser&&this.currentUser.username!==this.args.event.creator.username}addToCalendar(){this.menuApi.close()
const e=this.args.event;(0,u.downloadCalendar)(e.name||e.post.topic.title,[{startsAt:e.startsAt,endsAt:e.endsAt,timezone:e.timezone}],{location:e.location,details:e.description})}static{dt7948.n(this.prototype,"addToCalendar",[n.action])}sendPMToCreator(){this.menuApi.close(),this.args.composePrivateMessage(n.default.create(this.args.event.creator),n.default.create(this.args.event.post))}static{dt7948.n(this.prototype,"sendPMToCreator",[n.action])}upcomingEvents(){this.router.transitionTo("discourse-post-event-upcoming-events")}static{dt7948.n(this.prototype,"upcomingEvents",[n.action])}registerMenuApi(e){this.menuApi=e}static{dt7948.n(this.prototype,"registerMenuApi",[n.action])}async inviteUserOrGroup(){this.menuApi.close()
try{this.modal.show(b.default,{model:{event:this.args.event}})}catch(e){(0,c.popupAjaxError)(e)}}static{dt7948.n(this.prototype,"inviteUserOrGroup",[n.action])}exportPostEvent(){this.menuApi.close(),(0,p.exportEntity)("post_event",{name:"post_event",id:this.args.event.id})}static{dt7948.n(this.prototype,"exportPostEvent",[n.action])}bulkInvite(){this.menuApi.close(),this.modal.show(_.default,{model:{event:this.args.event}})}static{dt7948.n(this.prototype,"bulkInvite",[n.action])}async openEvent(){this.menuApi.close(),this.dialog.yesNoConfirm({message:(0,h.i18n)("discourse_post_event.builder_modal.confirm_open"),didConfirm:async()=>{this.isSavingEvent=!0
try{const e=await this.store.find("post",this.args.event.id)
this.args.event.isClosed=!1
const t=(0,g.buildParams)(this.args.event.startsAt,this.args.event.endsAt,this.args.event,this.siteSettings),s=(0,g.replaceRaw)(t,e.raw)
if(s){const t={raw:s,edit_reason:(0,h.i18n)("discourse_post_event.edit_reason_opened")},i=await(0,m.cook)(s)
t.cooked=i.string,await e.save(t)}}catch(e){(0,c.popupAjaxError)(e)}finally{this.isSavingEvent=!1}}})}static{dt7948.n(this.prototype,"openEvent",[n.action])}async editPostEvent(){this.menuApi.close(),this.modal.show(f.default,{model:{event:this.args.event,onDelete:async e=>{const t=await this.store.find("post",e.id),s=t.raw,i=(0,g.removeEvent)(s),n={raw:i,edit_reason:(0,h.i18n)("discourse_post_event.destroy_event")},o=await(0,m.cook)(i)
return n.cooked=o.string,await t.save(n)},onUpdate:async(e,t,s,i)=>{const n=await this.store.find("post",s.id),o=n.raw,r=(0,g.buildParams)(e,t,s,i),a=(0,g.replaceRaw)(r,o)
if(a){const e={raw:a,edit_reason:(0,h.i18n)("discourse_post_event.edit_reason")},t=await(0,m.cook)(a)
return e.cooked=t.string,await n.save(e)}}}})}static{dt7948.n(this.prototype,"editPostEvent",[n.action])}showParticipants(){this.menuApi.close(),this.modal.show(y.default,{model:{event:this.args.event,title:this.args.event.title,extraClass:this.args.event.extraClass}})}static{dt7948.n(this.prototype,"showParticipants",[n.action])}async closeEvent(){this.menuApi.close(),this.dialog.yesNoConfirm({message:(0,h.i18n)("discourse_post_event.builder_modal.confirm_close"),didConfirm:()=>(this.isSavingEvent=!0,this.store.find("post",this.args.event.id).then(e=>{this.args.event.isClosed=!0
const t=(0,g.buildParams)(this.args.event.startsAt,this.args.event.endsAt,this.args.event,this.siteSettings),s=(0,g.replaceRaw)(t,e.raw)
if(s){const t={raw:s,edit_reason:(0,h.i18n)("discourse_post_event.edit_reason_closed")}
return(0,m.cook)(s).then(s=>(t.cooked=s.string,e.save(t))).finally(()=>{this.isSavingEvent=!1})}}))})}static{dt7948.n(this.prototype,"closeEvent",[n.action])}static{(0,w.setComponentTemplate)((0,A.createTemplateFactory)({id:"+Rjbx6z5",block:'[[[8,[32,0],null,[["@identifier","@triggerClass","@icon","@onRegisterApi"],["discourse-post-event-more-menu",[28,[32,1],["more-dropdown","btn-small",[52,[30,0,["isSavingEvent"]],"--saving"]],null],"ellipsis",[30,0,["registerMenuApi"]]]],[["content"],[[[[1,"\\n    "],[8,[32,2],null,null,[["default"],[[[[1,"\\n"],[41,[51,[30,0,["expiredOrClosed"]]],[[[1,"        "],[8,[30,1,["item"]],[[24,0,"add-to-calendar"]],null,[["default"],[[[[1,"\\n          "],[8,[32,3],null,[["@icon","@label","@action"],["file","discourse_post_event.add_to_calendar",[30,0,["addToCalendar"]]]],null],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["canSendPmToCreator"]],[[[1,"        "],[8,[30,1,["item"]],[[24,0,"send-pm-to-creator"]],null,[["default"],[[[[1,"\\n          "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@translatedLabel","@action"],["envelope",[28,[32,4],["discourse_post_event.send_pm_to_creator",[28,[32,5],null,[["username"],[[30,2,["creator","username"]]]]]],null],[30,0,["sendPMToCreator"]]]],null],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["canInvite"]],[[[1,"        "],[8,[30,1,["item"]],[[24,0,"invite-user-or-group"]],null,[["default"],[[[[1,"\\n          "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@translatedLabel","@action"],["user-plus",[28,[32,4],["discourse_post_event.invite"],null],[30,0,["inviteUserOrGroup"]]]],null],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["canSeeUpcomingEvents"]],[[[1,"        "],[8,[30,1,["item"]],[[24,0,"upcoming-events"]],null,[["default"],[[[[1,"\\n          "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@translatedLabel","@action"],["far-calendar-plus",[28,[32,4],["discourse_post_event.upcoming_events.title"],null],[30,0,["upcomingEvents"]]]],null],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["shouldShowParticipants"]],[[[1,"        "],[8,[30,1,["item"]],[[24,0,"show-all-participants"]],null,[["default"],[[[[1,"\\n          "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["user-group","discourse_post_event.show_participants",[30,0,["showParticipants"]]]],null],[1,"\\n        "]],[]]]]],[1,"\\n\\n        "],[8,[30,1,["divider"]],null,null,null],[1,"\\n"]],[]],null],[41,[30,0,["canActOnEvent"]],[[[1,"        "],[8,[30,1,["item"]],[[24,0,"export-event"]],null,[["default"],[[[[1,"\\n          "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["file-csv","discourse_post_event.export_event",[30,0,["exportPostEvent"]]]],null],[1,"\\n        "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["canBulkInvite"]],[[[1,"          "],[8,[30,1,["item"]],[[24,0,"bulk-invite"]],null,[["default"],[[[[1,"\\n            "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["file-arrow-up","discourse_post_event.bulk_invite",[30,0,["bulkInvite"]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,2,["isClosed"]],[[[1,"          "],[8,[30,1,["item"]],[[24,0,"open-event"]],null,[["default"],[[[[1,"\\n            "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@label","@action","@disabled"],["unlock","discourse_post_event.open_event",[30,0,["openEvent"]],[30,0,["isSavingEvent"]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],[[[1,"          "],[8,[30,1,["item"]],[[24,0,"edit-event"]],null,[["default"],[[[[1,"\\n            "],[8,[32,3],[[24,0,"btn-transparent"]],[["@icon","@label","@action"],["pencil","discourse_post_event.edit_event",[30,0,["editPostEvent"]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n"],[41,[51,[30,2,["isExpired"]]],[[[1,"            "],[8,[30,1,["item"]],[[24,0,"close-event"]],null,[["default"],[[[[1,"\\n              "],[8,[32,3],[[24,0,"btn-transparent --danger"]],[["@icon","@label","@action","@disabled"],["xmark","discourse_post_event.close_event",[30,0,["closeEvent"]],[30,0,["isSavingEvent"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null]],[]]]],[]],null],[1,"    "]],[1]]]]],[1,"\\n  "]],[]]]]]],["dropdown","@event"],["if","unless"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/more-menu.js",scope:()=>[d.default,l.default,a.default,r.default,h.i18n,i.hash],isStrictMode:!0}),this)}}e.default=k}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/status",["exports","@glimmer/component","@ember/helper","@ember/object","@ember/service","discourse/components/d-button","discourse/components/plugin-outlet","discourse/helpers/concat-class","discourse/helpers/lazy-hash","discourse/lib/ajax-error","discourse/truth-helpers","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{static{dt7948.g(this.prototype,"appEvents",[n.service])}#v=void dt7948.i(this,"appEvents")
static{dt7948.g(this.prototype,"discoursePostEventApi",[n.service])}#o=void dt7948.i(this,"discoursePostEventApi")
static{dt7948.g(this.prototype,"siteSettings",[n.service])}#n=void dt7948.i(this,"siteSettings")
get eventButtons(){return this.siteSettings.event_participation_buttons.split("|")}get showGoingButton(){return!!this.eventButtons.find(e=>"going"===e)}get showInterestedButton(){return!!this.eventButtons.find(e=>"interested"===e)}get showNotGoingButton(){return!!this.eventButtons.find(e=>"not going"===e)}get canLeave(){return this.args.event.watchingInvitee&&this.args.event.isPublic}get watchingInviteeStatus(){return this.args.event.watchingInvitee?.status}async leaveEvent(){try{const e=this.args.event.watchingInvitee
await this.discoursePostEventApi.leaveEvent(this.args.event,e),this.appEvents.trigger("calendar:invitee-left-event",{invitee:e,postId:this.args.event.id})}catch(e){(0,l.popupAjaxError)(e)}}static{dt7948.n(this.prototype,"leaveEvent",[i.action])}async updateEventAttendance(e){try{await this.discoursePostEventApi.updateEventAttendance(this.args.event,{status:e}),this.appEvents.trigger("calendar:update-invitee-status",{status:e,postId:this.args.event.id})}catch(t){(0,l.popupAjaxError)(t)}}static{dt7948.n(this.prototype,"updateEventAttendance",[i.action])}async joinEventWithStatus(e){try{await this.discoursePostEventApi.joinEvent(this.args.event,{status:e}),this.appEvents.trigger("calendar:create-invitee-status",{status:e,postId:this.args.event.id})}catch(t){(0,l.popupAjaxError)(t)}}static{dt7948.n(this.prototype,"joinEventWithStatus",[i.action])}async changeWatchingInviteeStatus(e){if(this.args.event.watchingInvitee){const t=this.args.event.watchingInvitee.status
this.canLeave?e===t?await this.leaveEvent():await this.updateEventAttendance(e):(e===t&&(e=null),await this.updateEventAttendance(e))}else await this.joinEventWithStatus(e)}static{dt7948.n(this.prototype,"changeWatchingInviteeStatus",[i.action])}static{(0,u.setComponentTemplate)((0,p.createTemplateFactory)({id:"VVboRfmS",block:'[[[10,"section"],[15,0,[28,[32,0],["event__section event-actions event-status",[52,[30,0,["watchingInviteeStatus"]],[28,[32,1],["status-",[30,0,["watchingInviteeStatus"]]],null]]],null]],[12],[1,"\\n  "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-buttons",[28,[32,3],null,[["event"],[[30,1]]]]]],[["default"],[[[[1,"\\n"],[41,[30,0,["showGoingButton"]],[[[41,[51,[30,1,["minimal"]]],[[[1,"        "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-going-button",[28,[32,3],null,[["event","markAsGoing"],[[30,1],[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"going"],null]]]]]],[["default"],[[[[1,"\\n          "],[8,[32,5],[[24,0,"going-button"]],[["@disabled","@icon","@label","@action"],[[28,[32,6],[[30,1,["atCapacity"]],[28,[32,7],[[28,[32,8],[[30,0,["watchingInviteeStatus"]],"going"],null]],null]],null],"check",[52,[30,1,["atCapacity"]],"discourse_post_event.models.event.full","discourse_post_event.models.invitee.status.going"],[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"going"],null]]],null],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null]],[]],null],[1,"\\n"],[41,[30,0,["showInterestedButton"]],[[[1,"      "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-interested-button",[28,[32,3],null,[["event","markAsInterested"],[[30,1],[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"interested"],null]]]]]],[["default"],[[[[1,"\\n        "],[8,[32,5],[[24,0,"interested-button"]],[["@icon","@label","@action"],["star","discourse_post_event.models.invitee.status.interested",[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"interested"],null]]],null],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["showNotGoingButton"]],[[[41,[51,[30,1,["minimal"]]],[[[1,"        "],[8,[32,2],null,[["@name","@outletArgs"],["discourse-post-event-status-not-going-button",[28,[32,3],null,[["event","markAsNotGoing"],[[30,1],[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"not_going"],null]]]]]],[["default"],[[[[1,"\\n          "],[8,[32,5],[[24,0,"not-going-button"]],[["@icon","@label","@action"],["xmark","discourse_post_event.models.invitee.status.not_going",[28,[32,4],[[30,0,["changeWatchingInviteeStatus"]],"not_going"],null]]],null],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null]],[]],null],[1,"  "]],[]]]]],[1,"\\n"],[13]],["@event"],["if","unless"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/status.js",scope:()=>[a.default,s.concat,r.default,d.default,s.fn,o.default,c.and,c.not,c.eq],isStrictMode:!0}),this)}}e.default=m}),define("discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/url",["exports","@glimmer/component","discourse/helpers/d-icon","@ember/component","@ember/template-factory"],function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get url(){return this.args.url.includes("://")||this.args.url.includes("mailto:")?this.args.url:`https://${this.args.url}`}static{(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"RQFq7AAa",block:'[[[41,[30,1],[[[1,"  "],[10,"section"],[14,0,"event__section event-url"],[12],[1,"\\n    "],[1,[28,[32,0],["link"],null]],[1,"\\n    "],[10,3],[14,0,"url"],[15,6,[30,0,["url"]]],[14,"target","_blank"],[14,"rel","noopener noreferrer"],[12],[1,"\\n      "],[1,[30,1]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@url"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/discourse-post-event/url.js",scope:()=>[s.default],isStrictMode:!0}),this)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/components/event-date",["exports","@glimmer/component","@ember/service","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{static{dt7948.g(this.prototype,"siteSettings",[s.service])}#n=void dt7948.i(this,"siteSettings")
static{(0,o.setComponentTemplate)((0,r.createTemplateFactory)({id:"dESoa3d0",block:'[[[41,[30,0,["shouldRender"]],[[[10,1],[14,0,"header-topic-title-suffix-outlet event-date-container"],[12],[41,[30,0,["siteSettings","use_local_event_date"]],[[[10,1],[14,0,"event-date event-local-date past"],[15,"title",[30,0,["dateRange"]]],[15,"data-starts-at",[30,0,["eventStartedAt"]]],[15,"data-ends-at",[30,0,["eventEndedAt"]]],[12],[1,"\\n        "],[1,[30,0,["localDateContent"]]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,1],[15,0,[29,["event-date event-relative-date ",[30,0,["relativeDateType"]]]]],[15,"title",[30,0,["dateRange"]]],[15,"data-starts-at",[30,0,["eventStartedAt"]]],[15,"data-ends-at",[30,0,["eventEndedAt"]]],[12],[41,[30,0,["isWithinDateRange"]],[[[10,1],[14,0,"indicator"],[12],[13],[1,"\\n          "],[10,1],[14,0,"text"],[12],[1,[30,0,["timeRemainingContent"]]],[13],[1,"\\n"]],[]],[[[1,"          "],[1,[30,0,["relativeDateContent"]]]],[]]],[13]],[]]],[13]],[]],null]],[],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/event-date.js",isStrictMode:!0}),this)}get shouldRender(){return this.siteSettings.discourse_post_event_enabled&&this.args.topic.event_starts_at}get eventStartedAt(){return this._parsedDate(this.args.topic.event_starts_at)}get eventEndedAt(){return this.args.topic.event_ends_at?this._parsedDate(this.args.topic.event_ends_at):this.eventStartedAt}get dateRange(){return this.args.topic.event_ends_at?`${this._formattedDate(this.eventStartedAt)} → ${this._formattedDate(this.eventEndedAt)}`:this._formattedDate(this.eventStartedAt)}get localDateContent(){return this._formattedDate(this.eventStartedAt)}get relativeDateType(){return this.isWithinDateRange?"current":this.eventStartedAt.isAfter(moment())?"future":"past"}get isWithinDateRange(){return this.eventStartedAt.isBefore(moment())&&this.eventEndedAt.isAfter(moment())}get relativeDateContent(){return{future:this.eventStartedAt.from(moment()),past:this.eventEndedAt.from(moment())}[this.relativeDateType]}get timeRemainingContent(){return(0,i.i18n)("discourse_post_event.topic_title.ends_in_duration",{duration:this.eventEndedAt.from(moment())})}_parsedDate(e){const t=this.args.topic.event_show_local_time?this.args.topic.event_timezone:moment.tz.guess()
return moment.utc(e).tz(t||moment.tz.guess())}_guessedDateFormat(){return(0,n.default)(this.eventStartedAt)}_formattedDate(e){return e.format(this._guessedDateFormat())}}e.default=a}),define("discourse/plugins/discourse-calendar/discourse/components/event-field",["exports","discourse/truth-helpers","discourse-i18n","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"97pHWPtG",block:'[[[41,[28,[32,0],[[30,1],false],null],[[[1,"  "],[11,0],[24,0,"event-field"],[17,2],[12],[1,"\\n"],[41,[30,3],[[[1,"      "],[10,0],[14,0,"event-field-label"],[12],[1,"\\n        "],[10,1],[14,0,"label"],[12],[1,[28,[32,1],[[30,3]],null]],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"event-field-control"],[12],[1,"\\n      "],[18,4,null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@enabled","&attrs","@label","&default"],["if","yield"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/event-field.js",scope:()=>[t.notEq,s.i18n],isStrictMode:!0}),(0,o.default)(void 0,"event-field:EventField"))
e.default=r}),define("discourse/plugins/discourse-calendar/discourse/components/event-node-view",["exports","@glimmer/component","@ember/modifier","@ember/object","@ember/runloop","@ember/service","discourse/components/d-button","discourse/components/expanding-text-area","discourse/helpers/concat-class","discourse/helpers/d-icon","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","discourse/plugins/discourse-calendar/discourse/lib/raw-event-helper","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m,v,h,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class f extends t.default{static{dt7948.g(this.prototype,"composer",[o.service])}#h=void dt7948.i(this,"composer")
static{dt7948.g(this.prototype,"currentUser",[o.service])}#s=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"modal",[o.service])}#u=void dt7948.i(this,"modal")
static{dt7948.g(this.prototype,"siteSettings",[o.service])}#n=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"capabilities",[o.service])}#g=void dt7948.i(this,"capabilities")
constructor(){super(...arguments),this.args.onSetup?.(this)}updateNodeAttribute(e,t){this.args.getPos&&this.args.view&&(0,n.next)(()=>{const{view:s}=this.args,i=this.args.getPos(),n=s.state.doc.nodeAt(i)
if(!n)return
const o={...n.attrs,[e]:t},r=s.state.tr.setNodeMarkup(i,null,o)
s.dispatch(r)})}updateNodeContent(e){this.args.getPos&&this.args.view&&(0,n.next)(()=>{const{view:t}=this.args,s=this.args.getPos(),i=t.state.doc.nodeAt(s)
if(!i)return
const n=t.state.tr,o=s+1,r=s+i.nodeSize-1
if(e.trim()){const s=t.state.schema.text(e)
n.replaceWith(o,r,s)}else n.delete(o,r)
t.dispatch(n)})}get eventData(){return this.args.node.attrs}get eventDescription(){return this.args.view.state.doc.textBetween(this.args.getPos()+1,this.args.getPos()+this.args.node.nodeSize-1,"\n","\n")}get resolvedTimezone(){return this.eventData.timezone||"UTC"}get userTimezone(){return this.currentUser?.user_option?.timezone||moment.tz.guess()}parseDateWithTimezone(e){if(!e)return null
const t=moment.tz(e,this.resolvedTimezone)
return t.isValid()?t:moment.tz(this.userTimezone)}get startsAt(){return this.parseDateWithTimezone(this.eventData.start)}get endsAt(){return this.parseDateWithTimezone(this.eventData.end)}get displayTime(){return this.startsAt?this.eventData.showLocalTime?this.startsAt:this.startsAt.tz(this.userTimezone):null}get displayEndTime(){return this.endsAt?this.eventData.showLocalTime?this.endsAt:this.endsAt.tz(this.userTimezone):null}get dateFormat(){return(0,p.default)(this.startsAt,this.endsAt)}get formattedStartDate(){return this.displayTime.format(this.dateFormat)}get hasStartDate(){return this.eventData.start&&this.eventData.start.trim()}get hasEndDate(){return this.eventData.end&&this.eventData.end.trim()}get hasAnyDate(){return this.hasStartDate||this.hasEndDate}get formattedEndDate(){return this.displayEndTime?this.displayEndTime.format(this.dateFormat):""}get formattedStartDisplay(){return this.displayTime.format((0,c.i18n)("dates.long_no_year"))}get formattedEndDisplay(){return this.displayEndTime?this.displayEndTime.format((0,c.i18n)("dates.long_no_year")):(0,c.i18n)("discourse_post_event.composer.end_date_placeholder")}get startsAtMonth(){if(!this.displayTime){return moment.tz(this.userTimezone).format("MMM")}return this.displayTime.format("MMM")}get startsAtDay(){if(!this.displayTime){return moment.tz(this.userTimezone).format("D")}return this.displayTime.format("D")}get statusText(){return(0,c.i18n)(`discourse_post_event.models.event.status.${this.eventData.status||"public"}.title`)}get eventName(){return this.eventData.name}get eventNamePlaceholder(){return this.composer?.get("model.title")||(0,c.i18n)("discourse_post_event.composer.name_placeholder")}get hasLocation(){return this.eventData.location&&this.eventData.location.trim()}get isLocationUrl(){return!!this.hasLocation&&this.args.pluginParams.utils.getLinkify().test(this.eventData.location)}get locationIcon(){return this.isLocationUrl?"link":"location-pin"}get displayLocation(){if(!this.hasLocation)return null
if(this.isLocationUrl){const e=this.eventData.location.trim()
return e.startsWith("www.")||/^[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/.test(e)?e.includes("://")||e.includes("mailto:")?e:`https://${e}`:e}return this.eventData.location}get hasDescription(){return this.eventDescription&&this.eventDescription.length>0}get formattedStartTime(){if(!this.displayTime){return moment.tz(this.userTimezone).format("HH:mm")}return this.displayTime.format("HH:mm")}get formattedEndTime(){return this.displayEndTime?this.displayEndTime.format("HH:mm"):""}formatDateTimeLocal(e){if(!e)return""
const t=moment(e)
if(!t.isValid()){if(e.trim()){return moment.tz(this.userTimezone).format("YYYY-MM-DDTHH:mm")}return""}return t.format("YYYY-MM-DDTHH:mm")}get formattedStartDateTime(){return this.formatDateTimeLocal(this.eventData.start)}get formattedEndDateTime(){return this.formatDateTimeLocal(this.eventData.end)}updateEventName(e){e.target.value=e.target.value.replace(/\n/g,"")
const t=e.target.value.trim()
this.updateNodeAttribute("name",t)}static{dt7948.n(this.prototype,"updateEventName",[i.action])}updateEventLocation(e){const t=e.target.value.trim()
this.updateNodeAttribute("location",t||null)}static{dt7948.n(this.prototype,"updateEventLocation",[i.action])}updateEventDescription(e){const t=e.target.value.trim()
this.updateNodeContent(t)}static{dt7948.n(this.prototype,"updateEventDescription",[i.action])}updateEventStartDate(e){const t=e.target.value,s=this.eventData.timezone||"UTC"
if(t){const e=moment.tz(t,s)
this.updateNodeAttribute("start",e.format("YYYY-MM-DD HH:mm"))}else this.updateNodeAttribute("start",moment().tz(s).format("YYYY-MM-DD HH:mm"))}static{dt7948.n(this.prototype,"updateEventStartDate",[i.action])}updateEventEndDate(e){const t=e.target.value,s=this.eventData.timezone||"UTC"
if(t){const e=moment.tz(t,s)
this.updateNodeAttribute("end",e.format("YYYY-MM-DD HH:mm"))}else this.updateNodeAttribute("end",null)}static{dt7948.n(this.prototype,"updateEventEndDate",[i.action])}parseReminders(e){return e?Array.isArray(e)?e:e.split(",").map(e=>{const[t,s,i]=e.split(".")
return{type:t||"notification",value:Math.abs(parseInt(s,10)),unit:i||"hours",period:parseInt(s,10)<0?"after":"before"}}):[]}parseCustomFields(){const e={}
return this.siteSettings.discourse_post_event_allowed_custom_fields.split("|").filter(Boolean).forEach(t=>{const s=(0,m.camelCase)(t)
void 0!==this.eventData[s]&&(e[t]=this.eventData[s])}),e}updateEventMaxAttendees(e){const t=parseInt(e.target.value,10),s=Number.isFinite(t)&&t>0?t:null
e.target.value=s||"",this.updateNodeAttribute("maxAttendees",s)}static{dt7948.n(this.prototype,"updateEventMaxAttendees",[i.action])}focusDateInput(e){(0,n.next)(()=>e.target.showPicker())}static{dt7948.n(this.prototype,"focusDateInput",[i.action])}handleTextInputFocus(e){this.capabilities.isIOS&&setTimeout(()=>{e.target.scrollIntoView({block:"center",behavior:"smooth"})},400)}static{dt7948.n(this.prototype,"handleTextInputFocus",[i.action])}convertNodeToEvent(){const e=this.eventData.timezone||"UTC"
return{name:this.eventData.name,location:this.eventData.location,description:this.eventDescription,timezone:e,status:this.eventData.status||"public",max_attendees:this.eventData.maxAttendees,show_local_time:this.eventData.showLocalTime,chat_enabled:this.eventData.chatEnabled,minimal:this.eventData.minimal,reminders:this.parseReminders(this.eventData.reminders)||[],raw_invitees:this.eventData.allowedGroups?.split(",")||[],custom_fields:this.parseCustomFields(),starts_at:this.eventData.start?moment(this.eventData.start).tz(e):moment.tz(e),ends_at:this.eventData.end?moment(this.eventData.end).tz(e):null}}openEventBuilder(){const e=this.convertNodeToEvent()
this.modal.show(u.default,{model:{event:v.default.create(e),onDelete:()=>{if(!this.args.getPos||!this.args.view)return
const{view:e}=this.args,t=this.args.getPos(),s=e.state.doc.nodeAt(t)
if(!s)return
const i=e.state.tr.delete(t,t+s.nodeSize)
return e.dispatch(i),!0},onUpdate:(e,t,s)=>{const i=(0,m.buildParams)(e,t,s,this.siteSettings)
for(const[n,o]of Object.entries(i))"description"===n?this.updateNodeContent(o):this.updateNodeAttribute(n,o)}}})}static{dt7948.n(this.prototype,"openEventBuilder",[i.action])}selectNode(){this.args.dom.classList.add("ProseMirror-selectednode")}deselectNode(){this.args.dom.classList.remove("ProseMirror-selectednode")}stopEvent(e){return e.target.matches("input, textarea, button")}static{(0,h.setComponentTemplate)((0,g.createTemplateFactory)({id:"635ZpkIv",block:'[[[10,"header"],[14,0,"composer-event__header"],[12],[1,"\\n  "],[10,0],[14,0,"composer-event__date"],[12],[1,"\\n    "],[10,0],[14,0,"composer-event__month"],[12],[1,[30,0,["startsAtMonth"]]],[13],[1,"\\n    "],[10,0],[14,0,"composer-event__day"],[12],[1,[30,0,["startsAtDay"]]],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"composer-event__info"],[12],[1,"\\n    "],[8,[32,0],[[24,"rows","1"],[16,2,[30,0,["eventName"]]],[24,0,"composer-event__name-input"],[16,"placeholder",[30,0,["eventNamePlaceholder"]]],[4,[32,1],["input",[30,0,["updateEventName"]]],null],[4,[32,1],["focus",[30,0,["handleTextInputFocus"]]],null]],null,null],[1,"\\n\\n    "],[10,0],[14,0,"composer-event__status"],[12],[1,"\\n      "],[1,[30,0,["statusText"]]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"composer-event__more-dropdown"],[12],[1,"\\n    "],[8,[32,2],[[24,0,"btn-flat"]],[["@icon","@action","@title"],["gear",[30,0,["openEventBuilder"]],"discourse_post_event.edit_event"]],null],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,"section"],[14,0,"composer-event__dates"],[12],[1,"\\n  "],[1,[28,[32,3],["clock"],null]],[1,"\\n  "],[10,0],[15,0,[29,["composer-event__date-range",[52,[30,0,["hasAnyDate"]]," composer-event__date-range--has-values"]]]],[12],[1,"\\n    "],[10,0],[14,0,"composer-event__date-wrapper"],[12],[1,"\\n      "],[11,"input"],[16,2,[30,0,["formattedStartDateTime"]]],[24,0,"composer-event__date-input"],[24,4,"datetime-local"],[4,[32,1],["change",[30,0,["updateEventStartDate"]]],null],[4,[32,1],["focus",[30,0,["focusDateInput"]]],null],[12],[13],[1,"\\n      "],[10,1],[14,0,"composer-event__date-display"],[12],[1,"\\n        "],[1,[30,0,["formattedStartDisplay"]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n    "],[10,1],[14,0,"composer-event__date-separator"],[12],[1,"-"],[13],[1,"\\n    "],[10,0],[14,0,"composer-event__date-wrapper"],[12],[1,"\\n      "],[11,"input"],[16,2,[30,0,["formattedEndDateTime"]]],[24,0,"composer-event__date-input"],[24,4,"datetime-local"],[4,[32,1],["change",[30,0,["updateEventEndDate"]]],null],[4,[32,1],["focus",[30,0,["focusDateInput"]]],null],[12],[13],[1,"\\n      "],[10,1],[15,0,[28,[32,4],["composer-event__date-display",[52,[51,[30,0,["hasEndDate"]]],"--empty"]],null]],[12],[1,"\\n        "],[1,[30,0,["formattedEndDisplay"]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,"section"],[14,0,"composer-event__location"],[12],[1,"\\n  "],[1,[28,[32,3],[[30,0,["locationIcon"]]],null]],[1,"\\n  "],[10,0],[14,0,"composer-event__location-content"],[12],[1,"\\n    "],[11,"input"],[16,2,[30,0,["eventData","location"]]],[24,0,"composer-event__location-input"],[16,"placeholder",[28,[32,5],["discourse_post_event.composer.location_placeholder"],null]],[24,4,"text"],[4,[32,1],["input",[30,0,["updateEventLocation"]]],null],[4,[32,1],["focus",[30,0,["handleTextInputFocus"]]],null],[12],[13],[1,"\\n"],[41,[30,0,["isLocationUrl"]],[[[1,"      "],[10,3],[14,0,"composer-event__location-external-link"],[15,6,[30,0,["displayLocation"]]],[14,"target","_blank"],[14,"rel","noopener noreferrer"],[15,"title",[29,["Visit ",[30,0,["eventData","location"]]]]],[12],[1,"\\n        "],[1,[28,[32,3],["up-right-from-square"],null]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,"section"],[14,0,"composer-event__attendees"],[12],[1,"\\n  "],[1,[28,[32,3],["users"],null]],[1,"\\n  "],[11,"input"],[24,"inputmode","numeric"],[24,"min","1"],[24,"step","1"],[16,2,[30,0,["eventData","maxAttendees"]]],[16,"placeholder",[28,[32,5],["discourse_post_event.composer.max_attendees_placeholder"],null]],[24,0,"composer-event__max-attendees-input"],[24,4,"number"],[4,[32,1],["input",[30,0,["updateEventMaxAttendees"]]],null],[12],[13],[1,"\\n"],[41,[30,0,["eventData","maxAttendees"]],[[[1,"    "],[10,1],[14,0,"composer-event__max-attendees-display"],[12],[1,"\\n      Max\\n      "],[1,[30,0,["eventData","maxAttendees"]]],[1,"\\n      attendees\\n    "],[13],[1,"\\n"]],[]],null],[13],[1,"\\n\\n"],[10,"section"],[14,0,"composer-event__description"],[12],[1,"\\n  "],[8,[32,0],[[24,0,"composer-event__description-textarea"],[16,"placeholder",[28,[32,5],["discourse_post_event.composer.description_placeholder"],null]],[16,2,[30,0,["eventDescription"]]],[24,"rows","1"],[4,[32,1],["input",[30,0,["updateEventDescription"]]],null],[4,[32,1],["focus",[30,0,["handleTextInputFocus"]]],null]],null,null],[1,"\\n"],[13]],[],["if","unless"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/event-node-view.js",scope:()=>[a.default,s.on,r.default,l.default,d.default,c.i18n],isStrictMode:!0}),this)}}e.default=f}),define("discourse/plugins/discourse-calendar/discourse/components/full-calendar",["exports","@glimmer/component","@ember/controller","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/service","@ember/template","ember-modifier","discourse/lib/load-full-calendar","discourse/lib/url","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event","discourse/plugins/discourse-calendar/discourse/lib/calendar-locale","discourse/plugins/discourse-calendar/discourse/lib/calendar-view-helper","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m,v,h,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const f=(0,v.setComponentTemplate)((0,h.createTemplateFactory)({id:"0IbRDv8U",block:'[[[8,[32,0],null,[["@linkToPost","@event","@onClose","@withDescription"],[true,[30,1,["event"]],[30,1,["onClose"]],false]],null]],["@data"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/full-calendar.js",scope:()=>[u.default],isStrictMode:!0}),(0,g.default)(void 0,"full-calendar:PostEventMenu"))
class _ extends t.default{static{dt7948.g(this.prototype,"currentUser",[r.service])}#s=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"capabilities",[r.service])}#g=void dt7948.i(this,"capabilities")
static{dt7948.g(this.prototype,"tooltip",[r.service])}#f=void dt7948.i(this,"tooltip")
static{dt7948.g(this.prototype,"menu",[r.service])}#_=void dt7948.i(this,"menu")
static{dt7948.g(this.prototype,"siteSettings",[r.service])}#n=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"loadingSlider",[r.service])}#b=void dt7948.i(this,"loadingSlider")
static{dt7948.g(this.prototype,"topic",[s.inject])}#y=void dt7948.i(this,"topic")
calendar=null
forceUpdateSize=(0,d.modifier)(e=>{const t=new ResizeObserver(()=>{this.calendar?.updateSize?.()})
return t.observe(e),()=>{t.disconnect()}})
willDestroy(){this.calendar?.destroy?.(),this.menu.getByIdentifier("post-event-menu")?.destroy?.(),super.willDestroy(...arguments)}get firstDayOfWeek(){switch(this.siteSettings.calendar_first_day_of_week){case"saturday":return 6
case"sunday":return 0
default:return 1}}async setupCalendar(e){const t=await(0,l.default)()
this.calendar=new t.Calendar(e,{locale:(0,p.getCurrentBcp47Locale)(),eventDisplay:this.siteSettings.calendar_event_display??"auto",buttonText:(0,p.getCalendarButtonsText)(),timeZone:this.currentUser?.user_option?.timezone||"local",firstDay:this.firstDayOfWeek,displayEventTime:!0,weekends:this.args.weekends??!0,initialDate:this.args.initialDate,height:this.args.height??"100%",events:async(e,t,s)=>{if(this.args.onLoadEvents)try{this.loadingSlider.transitionStarted()
t(await this.args.onLoadEvents(e)),this.loadingSlider.transitionEnded()}catch(i){s(i)}},plugins:[t.DayGrid,t.TimeGrid,t.List,t.MomentPlugin,t.MomentTimezonePlugin],initialView:this.initialView,headerToolbar:this.headerToolbar,customButtons:this.args.customButtons||{},eventWillUnmount:async()=>{await(this.activeMenu?.close?.()),await(this.activeTooltip?.close?.())},datesSet:e=>{this.args.onDatesChange?.(e)},eventMouseLeave:async()=>{await(this.activeTooltip?.close?.())},eventMouseEnter:async({el:e,event:t})=>{const{htmlContent:s}=t.extendedProps
s&&(this.activeTooltip=await this.tooltip.show(e,{identifier:"post-event-tooltip",triggers:["hover"],content:(0,a.htmlSafe)("<div>"+s+"</div>")}))},eventClick:async({el:e,event:t,jsEvent:s})=>{const{postNumber:i,postUrl:n,postEvent:o}=t.extendedProps
o?.id?(s.preventDefault(),this.activeMenu=await this.menu.show({getBoundingClientRect:()=>e.getBoundingClientRect()},{identifier:"post-event-menu",component:f,modalForMobile:!0,maxWidth:500,data:{event:o,onClose:()=>{this.menu.getByIdentifier("post-event-menu")?.close?.()}}})):n?c.default.routeTo(n):i&&this.topic.send("jumpToPost",i)}}),this.calendar.render()}static{dt7948.n(this.prototype,"setupCalendar",[i.action])}updateCalendar(){this.calendar&&(this.calendar.setOption("headerToolbar",this.headerToolbar),this.calendar.refetchEvents())}static{dt7948.n(this.prototype,"updateCalendar",[i.action])}get defaultLeftHeaderToolbar(){return this.capabilities.viewport.md?"prev,next today":"prev,next"}get headerToolbar(){return{left:this.args.leftHeaderToolbar??this.defaultLeftHeaderToolbar,center:this.args.centerHeaderToolbar??"title",right:this.args.rightHeaderToolbar??"timeGridDay,timeGridWeek,dayGridMonth,listYear"}}get initialView(){return(0,m.normalizeViewForCalendar)(this.args.initialView)||(this.capabilities.viewport.sm?"dayGridMonth":"timeGridWeek")}static{(0,v.setComponentTemplate)((0,h.createTemplateFactory)({id:"HEKBS56D",block:'[[[11,0],[17,1],[4,[32,0],[[30,0,["setupCalendar"]]],null],[4,[32,1],[[30,0,["updateCalendar"]],[30,2],[30,3],[30,0,["capabilities","viewport","md"]]],null],[4,[30,0,["forceUpdateSize"]],null,null],[12],[1,"\\n"],[13]],["&attrs","@events","@refreshKey"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/full-calendar.js",scope:()=>[n.default,o.default],isStrictMode:!0}),this)}}e.default=_}),define("discourse/plugins/discourse-calendar/discourse/components/group-timezones/index",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/service","@ember/utils","discourse/truth-helpers","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/round-time","discourse/plugins/discourse-calendar/discourse/components/group-timezones/new-day","discourse/plugins/discourse-calendar/discourse/components/group-timezones/time-traveller","discourse/plugins/discourse-calendar/discourse/components/group-timezones/timezone","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m,v,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class g extends t.default{static{dt7948.g(this.prototype,"siteSettings",[r.service])}#n=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"filter",[s.tracked],function(){return""})}#w=void dt7948.i(this,"filter")
static{dt7948.g(this.prototype,"localTimeOffset",[s.tracked],function(){return 0})}#A=void dt7948.i(this,"localTimeOffset")
get groupedTimezones(){let e,t=[]
return this.args.members.filter(e=>e.timezone).forEach(e=>{if(this.#k(this.filter,e)){const s=e.timezone,i=parseInt(moment.tz(s).format("YYYYMDHm"),10)
let n=t.find(e=>e.identifier===i)
if(n)n.members.push(e)
else{const o=this.#E(moment.tz(s)),r=this.#x(),a=moment.tz(moment.utc(),s).utcOffset()
n={identifier:i,offset:a,type:"discourse-group-timezone",nowWithOffset:o.add(this.localTimeOffset,"minutes"),closeToWorkingHours:this.#T(o,r),inWorkingHours:this.#S(o,r),utcOffset:this.#M(a),members:[e]},t.push(n)}}}),t=t.sort((e,t)=>(0,a.compare)(e?.offset,t?.offset)).filter(e=>e.members.length),t.forEach((s,i)=>{i>0&&t[i-1].nowWithOffset.format("dddd")!==s.nowWithOffset.format("dddd")&&(e=i)}),e&&t.splice(e,0,{type:"discourse-group-timezone-new-day",beforeDate:t[e-1].nowWithOffset.format("dddd"),afterDate:t[e].nowWithOffset.format("dddd")}),t}#k(e,t){return!e||(e=e.toLowerCase(),!!(t.username.toLowerCase().indexOf(e)>-1||t.name&&t.name.toLowerCase().indexOf(e)>-1))}#E(e){return this.localTimeOffset&&(e=(0,c.default)(e)),e}#T(e,t){const s=e.hours(),i=this.siteSettings.working_day_start_hour,n=this.siteSettings.working_day_end_hour,o=this.siteSettings.close_to_working_day_hours_extension
return(s>=Math.max(i-o,0)&&s<=i||s<=Math.min(n+o,23)&&s>=n)&&t.includes(e.isoWeekday())}#S(e,t){const s=e.hours()
return s>this.siteSettings.working_day_start_hour&&s<this.siteSettings.working_day_end_hour&&t.includes(e.isoWeekday())}#M(e){const t=1===Math.sign(e)?"+":"-"
e=Math.abs(e)
let s=Math.floor(e/60).toString()
s=1===s.length?`0${s}`:s
let i=(e%60).toString()
return i=1===i.length?`:${i}0`:`:${i}`,`${t}${s.replace(/^0(\d)/,"$1")}${i.replace(/:00$/,"")}`.replace(/-0/," ")}#x(){const e=moment().locale("en")
return this.siteSettings.working_days.split("|").filter(Boolean).map(t=>{return s=t,e.localeData()._weekdays.indexOf(s)||7
var s})}handleFilterChange(e){this.filter=e.target.value}static{dt7948.n(this.prototype,"handleFilterChange",[o.action])}static{(0,v.setComponentTemplate)((0,h.createTemplateFactory)({id:"lSTWCVaq",block:'[[[10,0],[14,0,"group-timezones-header"],[12],[1,"\\n  "],[8,[32,0],null,[["@localTimeOffset","@setOffset"],[[30,0,["localTimeOffset"]],[28,[32,1],[[28,[31,0],[[30,0,["localTimeOffset"]]],null]],null]]],null],[1,"\\n  "],[10,1],[14,0,"title"],[12],[1,"\\n    "],[1,[28,[32,2],["group_timezones.group_availability"],[["group"],[[30,1]]]]],[1,"\\n  "],[13],[1,"\\n  "],[11,"input"],[16,"placeholder",[28,[32,2],["group_timezones.search"],null]],[24,0,"group-timezones-filter"],[24,4,"text"],[4,[32,3],["input",[30,0,["handleFilterChange"]]],null],[12],[13],[1,"\\n"],[13],[1,"\\n"],[10,0],[14,0,"group-timezones-body"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["groupedTimezones"]]],null]],null],"identifier",[[[41,[28,[32,4],[[30,2,["type"]],"discourse-group-timezone-new-day"],null],[[[1,"      "],[8,[32,5],null,[["@beforeDate","@afterDate"],[[30,2,["beforeDate"]],[30,2,["afterDate"]]]],null],[1,"\\n"]],[]],[[[1,"      "],[8,[32,6],null,[["@groupedTimezone"],[[30,2]]],null],[1,"\\n"]],[]]]],[2]],null],[13]],["@group","groupedTimezone"],["mut","each","-track-array","if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/group-timezones/index.js",scope:()=>[p.default,i.fn,l.i18n,n.on,d.eq,u.default,m.default],isStrictMode:!0}),this)}}e.default=g}),define("discourse/plugins/discourse-calendar/discourse/components/group-timezones/new-day",["exports","discourse/helpers/d-icon","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,s.setComponentTemplate)((0,i.createTemplateFactory)({id:"G44JIuG1",block:'[[[10,0],[14,0,"group-timezone-new-day"],[12],[1,"\\n  "],[10,1],[14,0,"before"],[12],[1,"\\n    "],[1,[28,[32,0],["chevron-left"],null]],[1,"\\n    "],[1,[30,1]],[1,"\\n  "],[13],[1,"\\n  "],[10,1],[14,0,"after"],[12],[1,"\\n    "],[1,[30,2]],[1,"\\n    "],[1,[28,[32,0],["chevron-right"],null]],[1,"\\n  "],[13],[1,"\\n"],[13]],["@beforeDate","@afterDate"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/group-timezones/new-day.js",scope:()=>[t.default],isStrictMode:!0}),(0,n.default)(void 0,"new-day:NewDay"))
e.default=o})
define("discourse/plugins/discourse-calendar/discourse/components/group-timezones/time-traveller",["exports","@glimmer/component","@ember/modifier","@ember/object","discourse/components/d-button","discourse/truth-helpers","discourse/plugins/discourse-calendar/discourse/lib/round-time","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{get localTimeWithOffset(){let e=moment().add(this.args.localTimeOffset,"minutes")
return this.args.localTimeOffset&&(e=(0,r.default)(e)),e.format("HH:mm")}reset(){this.args.setOffset(0)}static{dt7948.n(this.prototype,"reset",[i.action])}sliderMoved(e){const t=15*parseInt(e.target.value,10)
this.args.setOffset(t)}static{dt7948.n(this.prototype,"sliderMoved",[i.action])}static{(0,a.setComponentTemplate)((0,d.createTemplateFactory)({id:"LFqrZbm6",block:'[[[10,0],[14,0,"group-timezones-time-traveler"],[12],[1,"\\n  "],[10,1],[14,0,"time"],[12],[1,"\\n    "],[1,[30,0,["localTimeWithOffset"]]],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,1],[14,0,"discourse-group-timezones-slider-wrapper"],[12],[1,"\\n    "],[11,"input"],[24,0,"group-timezones-slider"],[24,"step","1"],[24,2,"0"],[24,"min","-48"],[24,"max","48"],[24,4,"range"],[4,[32,0],["input",[30,0,["sliderMoved"]]],null],[12],[13],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"group-timezones-reset"],[12],[1,"\\n    "],[8,[32,1],[[16,"disabled",[28,[32,2],[[30,1]],null]]],[["@action","@icon"],[[30,0,["reset"]],"arrow-rotate-left"]],null],[1,"\\n  "],[13],[1,"\\n"],[13]],["@localTimeOffset"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/group-timezones/time-traveller.js",scope:()=>[s.on,n.default,o.not],isStrictMode:!0}),this)}}e.default=l}),define("discourse/plugins/discourse-calendar/discourse/components/group-timezones/timezone",["exports","@glimmer/component","discourse/components/user-avatar","discourse/helpers/concat-class","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{get formattedTime(){return this.args.groupedTimezone.nowWithOffset.format("LT")}static{(0,n.setComponentTemplate)((0,o.createTemplateFactory)({id:"3RlcU74X",block:'[[[10,0],[15,0,[28,[32,0],["group-timezone",[52,[30,1,["closeToWorkingHours"]],"close-to-working-hours"],[52,[30,1,["inWorkingHours"]],"in-working-hours"]],null]],[12],[1,"\\n  "],[10,0],[14,0,"info"],[12],[1,"\\n    "],[10,1],[14,0,"time"],[12],[1,"\\n      "],[1,[30,0,["formattedTime"]]],[1,"\\n    "],[13],[1,"\\n    "],[10,1],[14,0,"offset"],[14,"title","UTC offset"],[12],[1,"\\n      "],[1,[30,1,["utcOffset"]]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n  "],[10,"ul"],[14,0,"group-timezones-members"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,1,["members"]]],null]],null],"username",[[[1,"      "],[10,"li"],[15,0,[28,[32,0],["group-timezones-member",[52,[30,2,["on_holiday"]],"on-holiday","not-on-holiday"]],null]],[12],[1,"\\n        "],[8,[32,1],[[24,0,"group-timezones-member-avatar"]],[["@user","@size"],[[30,2],"small"]],null],[1,"\\n      "],[13],[1,"\\n"]],[2]],null],[1,"  "],[13],[1,"\\n"],[13]],["@groupedTimezone","member"],["if","each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/group-timezones/timezone.js",scope:()=>[i.default,s.default],isStrictMode:!0}),this)}}e.default=r}),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/service","discourse/components/conditional-loading-section","discourse/components/d-button","discourse/components/d-modal","discourse/components/date-input","discourse/components/date-time-input-range","discourse/components/group-selector","discourse/components/plugin-outlet","discourse/components/radio-button","discourse/helpers/lazy-hash","discourse/lib/ajax-error","discourse/models/group","discourse/select-kit/components/combo-box","discourse/select-kit/components/timezone-input","discourse/truth-helpers","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/raw-event-helper","discourse/plugins/discourse-calendar/discourse/components/event-field","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m,v,h,g,f,_,b,y,w,A,k,E,x){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class T extends t.default{static{dt7948.g(this.prototype,"dialog",[r.service])}#r=void dt7948.i(this,"dialog")
static{dt7948.g(this.prototype,"siteSettings",[r.service])}#n=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"currentUser",[r.service])}#s=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"flash",[s.tracked],function(){return null})}#D=void dt7948.i(this,"flash")
static{dt7948.g(this.prototype,"isSaving",[s.tracked],function(){return!1})}#C=void dt7948.i(this,"isSaving")
static{dt7948.g(this.prototype,"maxAttendeesInput",[s.tracked],function(){return this.args.model.event.maxAttendees})}#z=void dt7948.i(this,"maxAttendeesInput")
static{dt7948.g(this.prototype,"startsAt",[s.tracked],function(){return moment(this.event.startsAt).tz(this.event.timezone||"UTC")})}#P=void dt7948.i(this,"startsAt")
static{dt7948.g(this.prototype,"endsAt",[s.tracked],function(){return this.event.endsAt&&moment(this.event.endsAt).tz(this.event.timezone||"UTC")})}#I=void dt7948.i(this,"endsAt")
get isEditing(){return this.args.model.event.id||this.args.model.onUpdate}get recurrenceUntil(){return this.event.recurrenceUntil&&moment(this.event.recurrenceUntil).tz(this.event.timezone||"UTC")}get event(){return this.args.model.event}get reminderTypes(){return[{value:"notification",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.types.notification")},{value:"bumpTopic",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.types.bump_topic")}]}get reminderUnits(){return[{value:"minutes",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.units.minutes")},{value:"hours",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.units.hours")},{value:"days",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.units.days")},{value:"weeks",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.units.weeks")}]}get reminderPeriods(){return[{value:"before",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.periods.before")},{value:"after",name:(0,w.i18n)("discourse_post_event.builder_modal.reminders.periods.after")}]}get shouldRenderUrl(){return void 0!==this.args.model.event.url}get availableRecurrences(){return[{id:"every_day",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_day")},{id:"every_month",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_month")},{id:"every_weekday",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_weekday")},{id:"every_week",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_week")},{id:"every_two_weeks",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_two_weeks")},{id:"every_four_weeks",name:(0,w.i18n)("discourse_post_event.builder_modal.recurrence.every_four_weeks")}]}get allowedCustomFields(){return this.siteSettings.discourse_post_event_allowed_custom_fields.split("|").filter(Boolean)}get addReminderDisabled(){return this.event.reminders?.length>=5}get showChat(){return this.siteSettings.chat_enabled&&(this.currentUser.admin||this.currentUser.moderator)}groupFinder(e){return f.default.findAll({term:e,ignore_automatic:!0})}static{dt7948.n(this.prototype,"groupFinder",[o.action])}setCustomField(e,t){this.event.customFields[e]=t.target.value}static{dt7948.n(this.prototype,"setCustomField",[o.action])}setMaxAttendees(e){const t=e.target.value,s=parseInt(t,10)
this.event.maxAttendees=Number.isFinite(s)&&s>0?s:null,this.maxAttendeesInput=t}static{dt7948.n(this.prototype,"setMaxAttendees",[o.action])}onChangeDates(e){this.event.startsAt=e.from,this.event.endsAt=e.to,this.startsAt=e.from,this.endsAt=e.to}static{dt7948.n(this.prototype,"onChangeDates",[o.action])}onChangeStatus(e){this.event.rawInvitees=[],this.event.status=e}static{dt7948.n(this.prototype,"onChangeStatus",[o.action])}setRecurrence(e){if(!e)return this.event.recurrence=null,void(this.event.recurrenceUntil=null)
this.event.recurrence=e}static{dt7948.n(this.prototype,"setRecurrence",[o.action])}setRecurrenceUntil(e){this.event.recurrenceUntil=e?moment(e).endOf("day").toDate():null}static{dt7948.n(this.prototype,"setRecurrenceUntil",[o.action])}setRawInvitees(e,t){this.event.rawInvitees=t}static{dt7948.n(this.prototype,"setRawInvitees",[o.action])}setNewTimezone(e){this.event.timezone=e,this.event.startsAt=moment.tz(this.startsAt.format("YYYY-MM-DDTHH:mm"),e),this.event.endsAt=this.endsAt?moment.tz(this.endsAt.format("YYYY-MM-DDTHH:mm"),e):null,this.startsAt=moment(this.event.startsAt).tz(e),this.endsAt=this.event.endsAt?moment(this.event.endsAt).tz(e):null}static{dt7948.n(this.prototype,"setNewTimezone",[o.action])}setName(e){this.event.name=e.target.value}static{dt7948.n(this.prototype,"setName",[o.action])}setLocation(e){this.event.location=e.target.value}static{dt7948.n(this.prototype,"setLocation",[o.action])}setUrl(e){this.event.url=e.target.value}static{dt7948.n(this.prototype,"setUrl",[o.action])}setDescription(e){this.event.description=e.target.value}static{dt7948.n(this.prototype,"setDescription",[o.action])}setShowLocalTime(e){this.event.showLocalTime=e.target.checked}static{dt7948.n(this.prototype,"setShowLocalTime",[o.action])}setMinimal(e){this.event.minimal=e.target.checked}static{dt7948.n(this.prototype,"setMinimal",[o.action])}setChatEnabled(e){this.event.chatEnabled=e.target.checked}static{dt7948.n(this.prototype,"setChatEnabled",[o.action])}setReminderValue(e,t){const s=t.target.value,i=""===s?null:Number(s)
e.value=Number.isFinite(i)?i:s}static{dt7948.n(this.prototype,"setReminderValue",[o.action])}async destroyPostEvent(){try{if(await this.dialog.yesNoConfirm({message:(0,w.i18n)("discourse_post_event.builder_modal.delete_confirmation_message")})){await this.args.model.onDelete()&&this.args.closeModal()}}catch(e){this.flash=(0,g.extractError)(e)}}static{dt7948.n(this.prototype,"destroyPostEvent",[o.action])}createEvent(){if(!this.startsAt)return void this.args.closeModal()
const e=(0,A.buildParams)(this.startsAt,this.endsAt,this.event,this.siteSettings),t=e.description?`${e.description}\n`:""
delete e.description
const s=[]
Object.keys(e).forEach(t=>{let i=e[t]
s.push(`${t}="${i}"`)}),this.args.model.toolbarEvent.addText(`[event ${s.join(" ")}]\n${t}[/event]`),this.args.closeModal()}static{dt7948.n(this.prototype,"createEvent",[o.action])}async updateEvent(){try{this.isSaving=!0,await this.args.model.onUpdate(this.startsAt,this.endsAt,this.event,this.siteSettings),this.args.closeModal()}catch(e){this.flash=(0,g.extractError)(e)}finally{this.isSaving=!1}}static{dt7948.n(this.prototype,"updateEvent",[o.action])}static{(0,E.setComponentTemplate)((0,x.createTemplateFactory)({id:"JZ5FkhxF",block:'[[[8,[32,0],[[24,0,"post-event-builder-modal"]],[["@title","@closeModal","@flash"],[[28,[32,1],[[28,[32,2],["discourse_post_event.builder_modal.",[52,[30,0,["isEditing"]],"update_event_title","create_event_title"]],null]],null],[30,1],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n    "],[8,[32,3],null,[["@isLoading"],[[30,0,["isSaving"]]]],[["default"],[[[[1,"\\n      "],[10,"form"],[12],[1,"\\n        "],[8,[32,4],null,[["@name","@outletArgs","@connectorTagName"],["post-event-builder-form",[28,[32,5],null,[["event"],[[30,2,["event"]]]]],"div"]],[["default"],[[[[1,"\\n          "],[8,[32,6],null,null,[["default"],[[[[1,"\\n            "],[8,[32,7],null,[["@from","@to","@timezone","@onChange"],[[30,0,["startsAt"]],[30,0,["endsAt"]],[30,2,["event","timezone"]],[30,0,["onChangeDates"]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[32,6],[[24,0,"name"]],[["@label"],["discourse_post_event.builder_modal.name.label"]],[["default"],[[[[1,"\\n            "],[11,"input"],[16,2,[30,2,["event","name"]]],[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.name.placeholder"],null]],[24,4,"text"],[4,[32,8],["input",[30,0,["setName"]]],null],[12],[13],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[32,6],[[24,0,"location"]],[["@label"],["discourse_post_event.builder_modal.location.label"]],[["default"],[[[[1,"\\n            "],[11,"input"],[16,2,[30,2,["event","location"]]],[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.location.placeholder"],null]],[24,4,"text"],[4,[32,8],["input",[30,0,["setLocation"]]],null],[12],[13],[1,"\\n          "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["shouldRenderUrl"]],[[[1,"            "],[8,[32,6],[[24,0,"url"]],[["@label"],["discourse_post_event.builder_modal.url.label"]],[["default"],[[[[1,"\\n              "],[11,"input"],[16,2,[30,2,["event","url"]]],[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.url.placeholder"],null]],[24,4,"url"],[4,[32,8],["input",[30,0,["setUrl"]]],null],[12],[13],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n          "],[8,[32,6],[[24,0,"description"]],[["@label"],["discourse_post_event.builder_modal.description.label"]],[["default"],[[[[1,"\\n            "],[11,"textarea"],[16,2,[30,2,["event","description"]]],[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.description.placeholder"],null]],[4,[32,8],["input",[30,0,["setDescription"]]],null],[12],[13],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[32,6],[[24,0,"max-attendees"]],[["@label"],["discourse_post_event.builder_modal.max_attendees.label"]],[["default"],[[[[1,"\\n            "],[11,"input"],[24,"min","1"],[24,"step","1"],[16,2,[30,0,["maxAttendeesInput"]]],[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.max_attendees.placeholder"],null]],[24,4,"number"],[4,[32,8],["input",[30,0,["setMaxAttendees"]]],null],[12],[13],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[32,6],[[24,0,"timezone"]],[["@label"],["discourse_post_event.builder_modal.timezone.label"]],[["default"],[[[[1,"\\n            "],[8,[32,9],null,[["@value","@onChange","@none"],[[30,2,["event","timezone"]],[30,0,["setNewTimezone"]],"discourse_post_event.builder_modal.timezone.remove_timezone"]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[32,6],[[24,0,"show-local-time"]],[["@label"],["discourse_post_event.builder_modal.show_local_time.label"]],[["default"],[[[[1,"\\n            "],[10,"label"],[14,0,"checkbox-label"],[12],[1,"\\n              "],[11,"input"],[16,"checked",[30,2,["event","showLocalTime"]]],[24,4,"checkbox"],[4,[32,8],["input",[30,0,["setShowLocalTime"]]],null],[12],[13],[1,"\\n              "],[10,1],[14,0,"message"],[12],[1,"\\n                "],[1,[28,[32,1],["discourse_post_event.builder_modal.show_local_time.description"],[["timezone"],[[30,2,["event","timezone"]]]]]],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[32,6],null,[["@label"],["discourse_post_event.builder_modal.status.label"]],[["default"],[[[[1,"\\n            "],[10,"label"],[14,0,"radio-label"],[12],[1,"\\n              "],[8,[32,10],null,[["@name","@value","@selection","@onChange"],["status","public",[30,2,["event","status"]],[30,0,["onChangeStatus"]]]],null],[1,"\\n              "],[10,1],[14,0,"message"],[12],[1,"\\n                "],[10,1],[14,0,"title"],[12],[1,"\\n                  "],[1,[28,[32,1],["discourse_post_event.models.event.status.public.title"],null]],[1,"\\n                "],[13],[1,"\\n                "],[10,1],[14,0,"description"],[12],[1,"\\n                  "],[1,[28,[32,1],["discourse_post_event.models.event.status.public.description"],null]],[1,"\\n                "],[13],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n            "],[10,"label"],[14,0,"radio-label"],[12],[1,"\\n              "],[8,[32,10],null,[["@name","@value","@selection","@onChange"],["status","private",[30,2,["event","status"]],[30,0,["onChangeStatus"]]]],null],[1,"\\n              "],[10,1],[14,0,"message"],[12],[1,"\\n                "],[10,1],[14,0,"title"],[12],[1,"\\n                  "],[1,[28,[32,1],["discourse_post_event.models.event.status.private.title"],null]],[1,"\\n                "],[13],[1,"\\n                "],[10,1],[14,0,"description"],[12],[1,"\\n                  "],[1,[28,[32,1],["discourse_post_event.models.event.status.private.description"],null]],[1,"\\n                "],[13],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n            "],[10,"label"],[14,0,"radio-label"],[12],[1,"\\n              "],[8,[32,10],null,[["@name","@value","@selection","@onChange"],["status","standalone",[30,2,["event","status"]],[30,0,["onChangeStatus"]]]],null],[1,"\\n              "],[10,1],[14,0,"message"],[12],[1,"\\n                "],[10,1],[14,0,"title"],[12],[1,"\\n                  "],[1,[28,[32,1],["discourse_post_event.models.event.status.standalone.title"],null]],[1,"\\n                "],[13],[1,"\\n                "],[10,1],[14,0,"description"],[12],[1,"\\n                  "],[1,[28,[32,1],["discourse_post_event.models.event.status.standalone.description"],null]],[1,"\\n                "],[13],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[32,6],null,[["@enabled","@label"],[[28,[32,11],[[30,2,["event","status"]],"private"],null],"discourse_post_event.builder_modal.invitees.label"]],[["default"],[[[[1,"\\n            "],[8,[32,12],null,[["@groupFinder","@groupNames","@onChangeCallback","@placeholderKey"],[[30,0,["groupFinder"]],[30,2,["event","rawInvitees"]],[30,0,["setRawInvitees"]],"topic.invite_private.group_name"]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[32,6],[[24,0,"reminders"]],[["@label"],["discourse_post_event.builder_modal.reminders.label"]],[["default"],[[[[1,"\\n            "],[10,0],[14,0,"reminders-list"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,2,["event","reminders"]]],null]],null],null,[[[1,"                "],[10,0],[14,0,"reminder-item"],[12],[1,"\\n                  "],[8,[32,13],[[24,0,"reminder-type"]],[["@value","@nameProperty","@valueProperty","@content"],[[30,3,["type"]],"name","value",[30,0,["reminderTypes"]]]],null],[1,"\\n\\n                  "],[11,"input"],[24,0,"reminder-value"],[24,"min","0"],[24,"step","1"],[16,2,[30,3,["value"]]],[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.name.placeholder"],null]],[24,4,"number"],[4,[32,8],["input",[28,[32,14],[[30,0,["setReminderValue"]],[30,3]],null]],null],[12],[13],[1,"\\n\\n                  "],[8,[32,13],[[24,0,"reminder-unit"]],[["@value","@nameProperty","@valueProperty","@content"],[[30,3,["unit"]],"name","value",[30,0,["reminderUnits"]]]],null],[1,"\\n\\n                  "],[8,[32,13],[[24,0,"reminder-period"]],[["@value","@nameProperty","@valueProperty","@content"],[[30,3,["period"]],"name","value",[30,0,["reminderPeriods"]]]],null],[1,"\\n\\n                  "],[8,[32,15],[[24,0,"remove-reminder"]],[["@action","@icon"],[[28,[32,14],[[30,2,["event","removeReminder"]],[30,3]],null],"xmark"]],null],[1,"\\n                "],[13],[1,"\\n"]],[3]],null],[1,"            "],[13],[1,"\\n\\n            "],[8,[32,15],[[24,0,"add-reminder"]],[["@disabled","@icon","@label","@action"],[[30,0,["addReminderDisabled"]],"plus","discourse_post_event.builder_modal.add_reminder",[30,2,["event","addReminder"]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n          "],[8,[32,6],[[24,0,"recurrence"]],[["@label"],["discourse_post_event.builder_modal.recurrence.label"]],[["default"],[[[[1,"\\n            "],[8,[32,13],[[24,0,"available-recurrences"]],[["@value","@content","@onChange","@options"],[[30,2,["event","recurrence"]],[30,0,["availableRecurrences"]],[30,0,["setRecurrence"]],[28,[32,5],null,[["none"],["discourse_post_event.builder_modal.recurrence.none"]]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n\\n"],[41,[30,2,["event","recurrence"]],[[[1,"            "],[8,[32,6],[[24,0,"recurrence-until"]],[["@label"],["discourse_post_event.builder_modal.recurrence_until.label"]],[["default"],[[[[1,"\\n              "],[8,[32,16],null,[["@date","@onChange","@timezone"],[[30,0,["recurrenceUntil"]],[30,0,["setRecurrenceUntil"]],[30,2,["event","timezone"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n          "],[8,[32,6],[[24,0,"minimal-event"]],[["@label"],["discourse_post_event.builder_modal.minimal.label"]],[["default"],[[[[1,"\\n            "],[10,"label"],[14,0,"checkbox-label"],[12],[1,"\\n              "],[11,"input"],[16,"checked",[30,2,["event","minimal"]]],[24,4,"checkbox"],[4,[32,8],["input",[30,0,["setMinimal"]]],null],[12],[13],[1,"\\n              "],[10,1],[14,0,"message"],[12],[1,"\\n                "],[1,[28,[32,1],["discourse_post_event.builder_modal.minimal.checkbox_label"],null]],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n          "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["showChat"]],[[[1,"            "],[8,[32,6],[[24,0,"allow-chat"]],[["@label"],["discourse_post_event.builder_modal.allow_chat.label"]],[["default"],[[[[1,"\\n              "],[10,"label"],[14,0,"checkbox-label"],[12],[1,"\\n                "],[11,"input"],[16,"checked",[30,2,["event","chatEnabled"]]],[24,4,"checkbox"],[4,[32,8],["input",[30,0,["setChatEnabled"]]],null],[12],[13],[1,"\\n                "],[10,1],[14,0,"message"],[12],[1,"\\n                  "],[1,[28,[32,1],["discourse_post_event.builder_modal.allow_chat.checkbox_label"],null]],[1,"\\n                "],[13],[1,"\\n              "],[13],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["allowedCustomFields","length"]],[[[1,"            "],[8,[32,6],null,[["@label"],["discourse_post_event.builder_modal.custom_fields.label"]],[["default"],[[[[1,"\\n              "],[10,2],[14,0,"event-field-description"],[12],[1,"\\n                "],[1,[28,[32,1],["discourse_post_event.builder_modal.custom_fields.description"],null]],[1,"\\n              "],[13],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["allowedCustomFields"]]],null]],null],null,[[[1,"                "],[10,1],[14,0,"label custom-field-label"],[12],[1,"\\n                  "],[1,[30,4]],[1,"\\n                "],[13],[1,"\\n                "],[11,"input"],[24,0,"custom-field-input"],[16,2,[28,[32,17],[[30,2,["event","customFields"]],[30,4]],null]],[16,"placeholder",[28,[32,1],["discourse_post_event.builder_modal.custom_fields.placeholder"],null]],[24,4,"text"],[4,[32,8],["input",[28,[32,14],[[30,0,["setCustomField"]],[30,4]],null]],null],[12],[13],[1,"\\n"]],[4]],null],[1,"            "]],[]]]]],[1,"\\n"]],[]],null],[1,"        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]],[[[1,"\\n"],[41,[30,2,["onUpdate"]],[[[1,"      "],[8,[32,15],[[24,0,"btn-primary"]],[["@label","@icon","@action"],["discourse_post_event.builder_modal.update","calendar-day",[30,0,["updateEvent"]]]],null],[1,"\\n\\n      "],[8,[32,15],[[24,0,"btn-danger"]],[["@icon","@action"],["trash-can",[30,0,["destroyPostEvent"]]]],null],[1,"\\n"]],[]],[[[1,"      "],[8,[32,15],[[24,0,"btn-primary"]],[["@label","@icon","@action"],["discourse_post_event.builder_modal.create","calendar-day",[30,0,["createEvent"]]]],null],[1,"\\n"]],[]]],[1,"  "]],[]]]]]],["@closeModal","@model","reminder","allowedCustomField"],["if","each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder.js",scope:()=>[l.default,w.i18n,i.concat,a.default,m.default,h.default,k.default,u.default,n.on,b.default,v.default,y.eq,p.default,_.default,i.fn,d.default,c.default,i.get],isStrictMode:!0}),this)}}e.default=T}),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-bulk-invite",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/service","@ember/utils","discourse/components/d-button","discourse/components/d-modal","discourse/components/group-selector","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/array-tools","discourse/lib/tracked-tools","discourse/models/group","discourse/select-kit/components/combo-box","discourse/select-kit/components/email-group-user-chooser","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/bulk-invite-sample-csv-file","discourse/plugins/discourse-calendar/discourse/components/csv-uploader","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m,v,h,g,f,_,b,y,w){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class A extends t.default{static{dt7948.g(this.prototype,"dialog",[o.service])}#r=void dt7948.i(this,"dialog")
static{dt7948.g(this.prototype,"bulkInviteDisabled",[s.tracked],function(){return!0})}#j=void dt7948.i(this,"bulkInviteDisabled")
static{dt7948.g(this.prototype,"flash",[s.tracked],function(){return null})}#D=void dt7948.i(this,"flash")
static{dt7948.g(this.prototype,"bulkInvites",[m.trackedArray],function(){return[n.default.create({identifier:null,attendance:"unknown"})]})}#O=void dt7948.i(this,"bulkInvites")
get bulkInviteStatuses(){return[{label:(0,f.i18n)("discourse_post_event.models.invitee.status.unknown"),name:"unknown"},{label:(0,f.i18n)("discourse_post_event.models.invitee.status.going"),name:"going"},{label:(0,f.i18n)("discourse_post_event.models.invitee.status.not_going"),name:"not_going"},{label:(0,f.i18n)("discourse_post_event.models.invitee.status.interested"),name:"interested"}]}groupFinder(e){return v.default.findAll({term:e,ignore_automatic:!0})}static{dt7948.n(this.prototype,"groupFinder",[n.action])}setBulkInviteDisabled(){this.bulkInviteDisabled=0===this.bulkInvites.filter(e=>(0,r.isPresent)(e.identifier)).length}static{dt7948.n(this.prototype,"setBulkInviteDisabled",[n.action])}async sendBulkInvites(){try{(await(0,c.ajax)(`/discourse-post-event/events/${this.args.model.event.id}/bulk-invite.json`,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({invitees:this.bulkInvites.filter(e=>(0,r.isPresent)(e.identifier))})})).success&&this.args.closeModal()}catch(e){this.flash=(0,u.extractError)(e)}}static{dt7948.n(this.prototype,"sendBulkInvites",[n.action])}removeBulkInvite(e){(0,p.removeValueFromArray)(this.bulkInvites,e),this.bulkInvites.length||this.bulkInvites.push(n.default.create({identifier:null,attendance:"unknown"}))}static{dt7948.n(this.prototype,"removeBulkInvite",[n.action])}addBulkInvite(){const e=this.bulkInvites[this.bulkInvites.length-1]?.attendance||"unknown"
this.bulkInvites.push(n.default.create({identifier:null,attendance:e}))}static{dt7948.n(this.prototype,"addBulkInvite",[n.action])}async uploadDone(){await this.dialog.alert((0,f.i18n)("discourse_post_event.bulk_invite_modal.success")),this.args.closeModal()}static{dt7948.n(this.prototype,"uploadDone",[n.action])}updateInviteIdentifier(e,t){e.set("identifier",t[0]),this.setBulkInviteDisabled()}static{dt7948.n(this.prototype,"updateInviteIdentifier",[n.action])}updateBulkGroupInviteIdentifier(e,t,s){e.set("identifier",s[0]),this.setBulkInviteDisabled()}static{dt7948.n(this.prototype,"updateBulkGroupInviteIdentifier",[n.action])}static{(0,y.setComponentTemplate)((0,w.createTemplateFactory)({id:"/Tpj3pid",block:'[[[8,[32,0],[[24,0,"post-event-bulk-invite"]],[["@closeModal","@title","@flash"],[[30,1],[28,[32,1],["discourse_post_event.bulk_invite_modal.title"],null],[30,0,["flash"]]]],[["body"],[[[[1,"\\n    "],[10,0],[14,0,"bulk-invites"],[12],[1,"\\n      "],[10,2],[14,0,"bulk-event-help"],[12],[1,"\\n        "],[1,[28,[32,1],[[28,[32,2],["discourse_post_event.bulk_invite_modal.description_",[30,2,["event","status"]]],null]],null]],[1,"\\n      "],[13],[1,"\\n      "],[10,"h3"],[12],[1,[28,[32,1],["discourse_post_event.bulk_invite_modal.inline_title"],null]],[13],[1,"\\n\\n      "],[10,0],[14,0,"bulk-invite-rows"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,0,["bulkInvites"]]],null]],null],null,[[[1,"          "],[10,0],[14,0,"bulk-invite-row"],[12],[1,"\\n"],[41,[30,2,["event","isPrivate"]],[[[1,"              "],[8,[32,3],[[24,0,"bulk-invite-identifier"]],[["@single","@groupFinder","@groupNames","@placeholderKey","@onChangeCallback"],[true,[30,0,["groupFinder"]],[30,3,["identifier"]],"discourse_post_event.bulk_invite_modal.group_selector_placeholder",[28,[32,4],[[30,0,["updateBulkGroupInviteIdentifier"]],[30,3]],null]]],null],[1,"\\n"]],[]],null],[41,[30,2,["event","isPublic"]],[[[1,"              "],[8,[32,5],[[24,0,"bulk-invite-identifier"]],[["@value","@onChange","@options"],[[30,3,["identifier"]],[28,[32,4],[[30,0,["updateInviteIdentifier"]],[30,3]],null],[28,[32,6],null,[["maximum","filterPlaceholder"],[1,"discourse_post_event.bulk_invite_modal.user_selector_placeholder"]]]]],null],[1,"\\n"]],[]],null],[1,"\\n            "],[8,[32,7],[[24,0,"bulk-invite-attendance"]],[["@value","@content","@nameProperty","@valueProperty","@onChange"],[[30,3,["attendance"]],[30,0,["bulkInviteStatuses"]],"name","name",[28,[32,4],[[28,[31,3],[[30,3,["attendance"]]],null]],null]]],null],[1,"\\n\\n            "],[8,[32,8],[[24,0,"remove-bulk-invite"]],[["@icon","@action"],["trash-can",[28,[32,4],[[30,0,["removeBulkInvite"]],[30,3]],null]]],null],[1,"\\n          "],[13],[1,"\\n"]],[3]],null],[1,"      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"bulk-invite-actions"],[12],[1,"\\n        "],[8,[32,8],[[24,0,"send-bulk-invites btn-primary"]],[["@label","@action","@disabled"],["discourse_post_event.bulk_invite_modal.send_bulk_invites",[30,0,["sendBulkInvites"]],[30,0,["bulkInviteDisabled"]]]],null],[1,"\\n        "],[8,[32,8],[[24,0,"add-bulk-invite"]],[["@icon","@action"],["plus",[30,0,["addBulkInvite"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"csv-bulk-invites"],[12],[1,"\\n      "],[10,"h3"],[12],[1,[28,[32,1],["discourse_post_event.bulk_invite_modal.csv_title"],null]],[13],[1,"\\n\\n      "],[10,0],[14,0,"bulk-invite-actions"],[12],[1,"\\n        "],[8,[32,9],null,null,null],[1,"\\n\\n        "],[8,[32,10],null,[["@uploadUrl","@i18nPrefix","@uploadDone"],[[28,[32,2],["/discourse-post-event/events/",[30,2,["event","id"]],"/csv-bulk-invite"],null],"discourse_post_event.bulk_invite_modal",[30,0,["uploadDone"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]]],["@closeModal","@model","bulkInvite"],["each","-track-array","if","mut"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-bulk-invite.js",scope:()=>[d.default,f.i18n,i.concat,l.default,i.fn,g.default,i.hash,h.default,a.default,_.default,b.default],isStrictMode:!0}),this)}}e.default=A}),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invite-user-or-group",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","discourse/components/d-button","discourse/components/d-modal","discourse/lib/ajax","discourse/lib/ajax-error","discourse/select-kit/components/email-group-user-chooser","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/event-field","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class v extends t.default{static{dt7948.g(this.prototype,"invitedNames",[s.tracked],function(){return[]})}#N=void dt7948.i(this,"invitedNames")
static{dt7948.g(this.prototype,"flash",[s.tracked],function(){return null})}#D=void dt7948.i(this,"flash")
async invite(){try{await(0,a.ajax)(`/discourse-post-event/events/${this.args.model.event.id}/invite.json`,{data:{invites:this.invitedNames},type:"POST"}),this.args.closeModal()}catch(e){this.flash=(0,d.extractError)(e)}}static{dt7948.n(this.prototype,"invite",[n.action])}static{(0,p.setComponentTemplate)((0,m.createTemplateFactory)({id:"SG1YL8Uq",block:'[[[8,[32,0],null,[["@title","@closeModal","@flash"],[[28,[32,1],["discourse_post_event.invite_user_or_group.title"],null],[30,1],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n    "],[10,"form"],[12],[1,"\\n      "],[8,[32,2],null,null,[["default"],[[[[1,"\\n        "],[8,[32,3],null,[["@value","@options"],[[30,0,["invitedNames"]],[28,[32,4],null,[["fullWidthWrap","includeMessageableGroups","filterPlaceholder","excludeCurrentUser"],[true,true,"composer.users_placeholder",true]]]]],null],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[32,5],[[24,0,"btn-primary"]],[["@type","@label","@action"],["button","discourse_post_event.invite_user_or_group.invite",[30,0,["invite"]]]],null],[1,"\\n  "]],[]]]]]],["@closeModal"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invite-user-or-group.js",scope:()=>[r.default,c.i18n,u.default,l.default,i.hash,o.default],isStrictMode:!0}),this)}}e.default=v}),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/index",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/service","discourse/components/conditional-loading-spinner","discourse/components/d-button","discourse/components/d-modal","discourse/helpers/concat-class","discourse/lib/decorators","discourse/truth-helpers","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/toggle-invitees","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/user","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m,v,h,g,f){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class _ extends t.default{static{dt7948.g(this.prototype,"discoursePostEventApi",[r.service])}#o=void dt7948.i(this,"discoursePostEventApi")
static{dt7948.g(this.prototype,"filter",[s.tracked])}#w=void dt7948.i(this,"filter")
static{dt7948.g(this.prototype,"isLoading",[s.tracked],function(){return!1})}#L=void dt7948.i(this,"isLoading")
static{dt7948.g(this.prototype,"type",[s.tracked],function(){return"going"})}#U=void dt7948.i(this,"type")
static{dt7948.g(this.prototype,"inviteesList",[s.tracked])}#F=void dt7948.i(this,"inviteesList")
constructor(){super(...arguments),this.fetchInvitees()}get hasSuggestedUsers(){return this.inviteesList?.suggestedUsers?.length>0}get hasResults(){return this.inviteesList?.invitees?.length>0||this.hasSuggestedUsers}get title(){return(0,m.i18n)(`discourse_post_event.invitees_modal.${this.args.model.title||"title_invited"}`)}toggleType(e){this.type=e,this.fetchInvitees(this.filter)}static{dt7948.n(this.prototype,"toggleType",[o.action])}onFilterChanged(e){this.filter=e.target.value,this.fetchInvitees(this.filter)}static{dt7948.n(this.prototype,"onFilterChanged",[(0,u.debounce)(250)])}async removeInvitee(e){await this.discoursePostEventApi.leaveEvent(this.args.model.event,e),this.inviteesList.remove(e)}static{dt7948.n(this.prototype,"removeInvitee",[o.action])}async addInvitee(e){const t=await this.discoursePostEventApi.joinEvent(this.args.model.event,{status:this.type,user_id:e.id})
this.inviteesList.add(t)}static{dt7948.n(this.prototype,"addInvitee",[o.action])}async fetchInvitees(e){try{this.isLoading=!0,this.inviteesList=await this.discoursePostEventApi.listEventInvitees(this.args.model.event,{type:this.type,filter:e})}finally{this.isLoading=!1}}static{(0,g.setComponentTemplate)((0,f.createTemplateFactory)({id:"XQyAqjT+",block:'[[[8,[32,0],[[16,0,[28,[32,1],[[28,[32,2],[[30,1,["extraClass"]],"invited"],null],"post-event-invitees-modal"],null]]],[["@title","@closeModal"],[[30,0,["title"]],[30,2]]],[["body"],[[[[1,"\\n    "],[11,"input"],[16,"placeholder",[28,[32,3],["discourse_post_event.invitees_modal.filter_placeholder"],null]],[24,0,"filter"],[24,4,"text"],[4,[32,4],["input",[30,0,["onFilterChanged"]]],null],[12],[13],[1,"\\n\\n    "],[8,[32,5],null,[["@viewType","@toggle"],[[30,0,["type"]],[30,0,["toggleType"]]]],null],[1,"\\n    "],[8,[32,6],null,[["@condition"],[[30,0,["isLoading"]]]],[["default"],[[[[1,"\\n"],[41,[30,0,["hasResults"]],[[[1,"        "],[10,"ul"],[14,0,"invitees"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["inviteesList","invitees"]]],null]],null],null,[[[1,"            "],[10,"li"],[14,0,"invitee"],[12],[1,"\\n              "],[8,[32,7],null,[["@user"],[[30,3,["user"]]]],null],[1,"\\n\\n"],[41,[30,1,["event","canActOnDiscoursePostEvent"]],[[[1,"                "],[8,[32,8],[[24,0,"remove-invitee"],[16,"title",[28,[32,3],["discourse_post_event.invitees_modal.remove_invitee"],null]]],[["@icon","@action"],["trash-can",[28,[32,9],[[30,0,["removeInvitee"]],[30,3]],null]]],null],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n"]],[3]],null],[1,"        "],[13],[1,"\\n"],[41,[30,0,["hasSuggestedUsers"]],[[[1,"          "],[10,"ul"],[14,0,"possible-invitees"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["inviteesList","suggestedUsers"]]],null]],null],null,[[[1,"              "],[10,"li"],[14,0,"invitee"],[12],[1,"\\n                "],[8,[32,7],null,[["@user"],[[30,4]]],null],[1,"\\n\\n"],[41,[30,1,["event","canActOnDiscoursePostEvent"]],[[[1,"                  "],[8,[32,8],[[24,0,"add-invitee"],[16,"title",[28,[32,3],["discourse_post_event.invitees_modal.add_invitee"],null]]],[["@icon","@action"],["plus",[28,[32,9],[[30,0,["addInvitee"]],[30,4]],null]]],null],[1,"\\n"]],[]],null],[1,"              "],[13],[1,"\\n"]],[4]],null],[1,"          "],[13],[1,"\\n"]],[]],null]],[]],[[[1,"        "],[10,2],[14,0,"no-users"],[12],[1,"\\n          "],[1,[28,[32,3],["discourse_post_event.models.invitee.no_users"],null]],[1,"\\n        "],[13],[1,"\\n"]],[]]],[1,"    "]],[]]]]],[1,"\\n  "]],[]]]]]],["@model","@closeModal","invitee","user"],["if","each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/index.js",scope:()=>[l.default,c.default,p.or,m.i18n,n.on,v.default,a.default,h.default,d.default,i.fn],isStrictMode:!0}),this)}}e.default=_}),define("discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/user",["exports","discourse/helpers/avatar","discourse/helpers/user-prioritized-name","discourse/lib/url","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=(0,n.setComponentTemplate)((0,o.createTemplateFactory)({id:"VKckLqMb",block:'[[[10,3],[15,6,[28,[32,0],[[30,1,["username"]]],null]],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n  "],[10,1],[14,0,"user"],[12],[1,"\\n    "],[1,[28,[32,1],[[30,1]],[["imageSize"],["medium"]]]],[1,"\\n    "],[10,1],[14,0,"username"],[12],[1,"\\n      "],[1,[28,[32,2],[[30,1]],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],["@user"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/modal/post-event-invitees/user.js",scope:()=>[i.userPath,t.default,s.default],isStrictMode:!0}),(0,r.default)(void 0,"user:User"))
e.default=a}),define("discourse/plugins/discourse-calendar/discourse/components/post-calendar",["exports","@glimmer/component","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/will-destroy","@ember/service","@ember/template","discourse/lib/get-url","discourse/lib/utilities","discourse/plugins/discourse-calendar/discourse/lib/colors","discourse/plugins/discourse-calendar/discourse/components/full-calendar","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{static{dt7948.g(this.prototype,"siteSettings",[o.service])}#n=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"capabilities",[o.service])}#g=void dt7948.i(this,"capabilities")
static{dt7948.g(this.prototype,"postCalendar",[o.service])}#R=void dt7948.i(this,"postCalendar")
registerPostCalendar(){this.postCalendar.registerComponent(this)}static{dt7948.n(this.prototype,"registerPostCalendar",[s.action])}teardownPostCalendar(){this.postCalendar.teardownComponent()}static{dt7948.n(this.prototype,"teardownPostCalendar",[s.action])}get isStatic(){return"static"===this.args.options.calendarType}get isFullDay(){return"true"===this.args.options.calendarFullDay}loadEvents(){const e=[]
return this.isStatic?e.push(...this.args.staticEvents??[]):e.push(...this.dynamicEvents??[]),e}static{dt7948.n(this.prototype,"loadEvents",[s.action])}get dynamicEvents(){const e=[],t=[];(this.args.post.calendar_details||[]).forEach(s=>{switch(s.type){case"grouped":this.isFullDay&&s.timezone&&(s.from=moment.tz(s.from,s.timezone).format("YYYY-MM-DD")),t.push(s)
break
case"standalone":if(this.isFullDay&&s.timezone){const t={...s},i=moment.tz(s.from,s.timezone),n=moment.tz(s.to,s.timezone)
t.from=i.format("YYYY-MM-DD"),t.to=n.format("YYYY-MM-DD"),e.push(this.buildStandaloneEvent(t))}else e.push(this.buildStandaloneEvent(s))}})
const s={}
return t.forEach(e=>{const t=this.isFullDay?moment(e.from).format("YYYY-MM-DD"):moment(e.from).utc().startOf("day").toISOString(),i=this.isFullDay?moment(e.to||e.from).format("YYYY-MM-DD"):moment(e.to||e.from).utc().endOf("day").toISOString(),n=`${t}-${i}`
s[n]=s[n]||{from:t,to:i||t,localEvents:{}},s[n].localEvents[e.name]=s[n].localEvents[e.name]||{users:[]},s[n].localEvents[e.name].users.push.apply(s[n].localEvents[e.name].users,e.users)}),Object.keys(s).forEach(t=>{const i=s[t]
this.buildGroupedEvents(i).forEach(t=>{e.push(t)})}),e}buildEvent(e){const t=this.buildEventObject(e.from?{dateTime:moment(e.from),weeklyRecurring:"1.weeks"===e.recurring}:null,e.to?{dateTime:moment(e.to),weeklyRecurring:"1.weeks"===e.recurring}:null)
return t.extendedProps={},e.post_url?t.extendedProps.postUrl=(0,a.default)(e.post_url):e.post_number?t.extendedProps.postNumber=e.post_number:t.classNames=["holiday"],e.timezoneOffset&&(t.extendedProps.timezoneOffset=e.timezoneOffset),t}buildEventObject(e,t){const s=e=>!!e&&(e.hours()||e.minutes()||e.seconds()),i=s(t?.dateTime)||s(e?.dateTime),n=i?"YYYY-MM-DD HH:mm:ssZ":"YYYY-MM-DD"
let o={start:e.dateTime.format(n),allDay:!1}
return t?i?o.end=t.dateTime.format(n):(o.end=t.dateTime.add(1,"days").format(n),o.allDay=!0):o.allDay=!0,e.weeklyRecurring&&(o.startTime={hours:e.dateTime.hours(),minutes:e.dateTime.minutes(),seconds:e.dateTime.seconds()},o.daysOfWeek=[e.dateTime.day()]),o}buildGroupedEvents(e){const t=[]
return[e].forEach(e=>{let s="",i=[],n=[]
Object.keys(e.localEvents).sort().forEach(t=>{const o=e.localEvents[t]
s+=`<b>${t}</b>: ${o.users.map(e=>e.username).sort().join(", ")}<br>`,i=i.concat(o.users),n.push(t)})
const o=this.buildEvent(e)
o.classNames=["grouped-event"],i.length>2?o.title=`(${i.length}) ${n[0]}`:1===i.length?o.title=i[0].username:o.title=this.capabilities.viewport.sm?`(${i.length}) `+i.map(e=>e.username).join(", "):`(${i.length}) ${n[0]}`,n.length>1||i.length>1?o.extendedProps.htmlContent=s:o.extendedProps.htmlContent=n[0],o.participantCount=i.length,t.push(o)}),t}buildStandaloneEvent(e){const t=this.buildEvent(e),s=parseInt(this.siteSettings.holiday_calendar_topic_id,10),i=e.message.split("\n").filter(Boolean)
if(i.length&&this.args.post.topic_id&&s!==this.args.post.topic_id)t.title=i[0],t.extendedProps.description=i.slice(1).join(" ")
else{const s=(0,l.stringToColor)(e.username)
t.title=e.username,t.backgroundColor=(0,l.colorToHex)(s),t.textColor=(0,l.contrastColor)(s)}let n=e.message.slice(0,100)
return e.message.length>100&&(n+="…"),t.extendedProps.htmlContent=(0,r.htmlSafe)((0,d.escapeExpression)(n)),t.title=t.title.replace(/<img[^>]*>/g,""),t.participantCount=1,e.post_url&&(t.extendedProps.postUrl=(0,a.default)(e.post_url)),t}get leftHeaderToolbar(){return this.capabilities.viewport.sm?"prev,next today":"prev,next title"}get centerHeaderToolbar(){return this.capabilities.viewport.sm?"title":""}static{(0,u.setComponentTemplate)((0,p.createTemplateFactory)({id:"Z3ci6mSP",block:'[[[11,0],[24,0,"post-calendar"],[4,[32,0],[[30,0,["registerPostCalendar"]]],null],[4,[32,1],[[30,0,["teardownPostCalendar"]]],null],[12],[1,"\\n  "],[8,[32,2],null,[["@leftHeaderToolbar","@centerHeaderToolbar","@rightHeaderToolbar","@onLoadEvents","@height","@refreshKey"],[[30,0,["leftHeaderToolbar"]],[30,0,["centerHeaderToolbar"]],"timeGridDay,timeGridWeek,dayGridMonth,listYear",[30,0,["loadEvents"]],[30,1],[30,2,["id"]]]],null],[1,"\\n"],[13]],["@height","@post"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/post-calendar.js",scope:()=>[i.default,n.default,c.default],isStrictMode:!0}),this)}}e.default=m}),define("discourse/plugins/discourse-calendar/discourse/components/region-input",["exports","@ember/object","@ember-decorators/component","discourse/select-kit/components/combo-box","discourse/select-kit/components/select-kit","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/regions"],function(e,t,s,i,n,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=dt7948.c(class extends i.default{allowNoneRegion=!1
get content(){const e={}
let t=[]
return this.siteSettings.available_locales.forEach(t=>{e[t.value]=t.name}),!0===this.allowNoneRegion&&t.push({name:(0,o.i18n)("discourse_calendar.region.none"),id:null}),t=t.concat(r.HOLIDAY_REGIONS.map(e=>({name:(0,o.i18n)(`discourse_calendar.region.names.${e}`),id:e})).sort((e,t)=>e.name.localeCompare(t.name))),t}static{dt7948.n(this.prototype,"content",[t.computed])}},[(0,s.classNames)("timezone-input","region-input"),(0,n.pluginApiIdentifiers)("timezone-input"),(0,n.selectKitOptions)({filterable:!0,allowAny:!1,none:"discourse_calendar.region.select_region"})])
e.default=a}),define("discourse/plugins/discourse-calendar/discourse/components/toggle-invitees",["exports","@ember/helper","discourse/components/d-button","discourse/helpers/concat-class","discourse/truth-helpers","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,o.setComponentTemplate)((0,r.createTemplateFactory)({id:"3I+1t4Kn",block:'[[[10,0],[14,0,"invitees-type-filter"],[12],[1,"\\n  "],[8,[32,0],[[16,0,[28,[32,1],["btn toggle-going",[52,[28,[32,2],[[30,1],"going"],null],"btn-danger","btn-default"]],null]]],[["@label","@action"],["discourse_post_event.models.invitee.status.going",[28,[32,3],[[30,2],"going"],null]]],null],[1,"\\n\\n  "],[8,[32,0],[[16,0,[28,[32,1],["btn toggle-interested",[52,[28,[32,2],[[30,1],"interested"],null],"btn-danger","btn-default"]],null]]],[["@label","@action"],["discourse_post_event.models.invitee.status.interested",[28,[32,3],[[30,2],"interested"],null]]],null],[1,"\\n\\n  "],[8,[32,0],[[16,0,[28,[32,1],["btn toggle-not-going",[52,[28,[32,2],[[30,1],"not_going"],null],"btn-danger","btn-default"]],null]]],[["@label","@action"],["discourse_post_event.models.invitee.status.not_going",[28,[32,3],[[30,2],"not_going"],null]]],null],[1,"\\n"],[13]],["@viewType","@toggle"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/toggle-invitees.js",scope:()=>[s.default,i.default,n.eq,t.fn],isStrictMode:!0}),(0,a.default)(void 0,"toggle-invitees:ToggleInvitees"))
e.default=d}),define("discourse/plugins/discourse-calendar/discourse/components/upcoming-events-calendar",["exports","@glimmer/component","@ember/object","@ember/runloop","@ember/service","moment","discourse/lib/get-url","discourse/models/category","discourse-i18n","discourse/plugins/discourse-calendar/discourse/helpers/format-event-name","discourse/plugins/discourse-calendar/discourse/lib/calendar-view-helper","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","discourse/plugins/discourse-calendar/discourse/components/full-calendar","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m,v){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static{dt7948.g(this.prototype,"currentUser",[n.service])}#s=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"router",[n.service])}#i=void dt7948.i(this,"router")
static{dt7948.g(this.prototype,"capabilities",[n.service])}#g=void dt7948.i(this,"capabilities")
static{dt7948.g(this.prototype,"siteSettings",[n.service])}#n=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"discoursePostEventService",[n.service])}#B=void dt7948.i(this,"discoursePostEventService")
get customButtons(){return{mineEvents:{text:(0,d.i18n)("discourse_post_event.upcoming_events.my_events"),click:()=>{const e=this.router.currentRoute.params
this.router.replaceWith("discourse-post-event-upcoming-events.mine",e.view,e.year,e.month,e.day)}},allEvents:{text:(0,d.i18n)("discourse_post_event.upcoming_events.all_events"),click:()=>{const e=this.router.currentRoute.params
this.router.replaceWith("discourse-post-event-upcoming-events.index",e.view,e.year,e.month,e.day)}}}}async loadEvents(e){const t=await this.discoursePostEventService.fetchEvents({after:e.startStr,before:e.endStr,attending_user:this.args.mine?this.currentUser?.username:null}),s=JSON.parse(this.siteSettings.map_events_to_color)
return t.map(e=>{const{startsAt:t,endsAt:i,post:n,categoryId:d}=e
let c
if(n?.topic?.tags){const e=s.find(e=>"tag"===e.type&&n.topic.tags.some(t=>("string"==typeof t?t:t.name)===e.slug))
c=e?.color}if(!c){const e=s.find(e=>"category"===e.type&&e.slug===n?.category_slug)
c=e?.color}const p=a.default.findById(d)?.color
return!c&&p&&(c=`#${p}`),{extendedProps:{postEvent:e},title:(0,l.formatEventName)(e,this.currentUser?.user_option?.timezone),start:t,end:i||t,allDay:!(0,u.isNotFullDayEvent)((0,o.default)(t),(0,o.default)(i)),url:(0,r.default)(`/t/-/${n?.topic?.id}/${n?.post_number}`),backgroundColor:c}})}static{dt7948.n(this.prototype,"loadEvents",[s.action])}get leftHeaderToolbar(){let e=""
return this.capabilities.viewport.sm?e+="allEvents,mineEvents":e="title allEvents,mineEvents",this.capabilities.viewport.sm?`${e} prev,next,today`:e}get rightHeaderToolbar(){return this.capabilities.viewport.sm?"timeGridDay,timeGridWeek,dayGridMonth,listYear":"prev,next timeGridDay,timeGridWeek,dayGridMonth,listYear"}get centerHeaderToolbar(){return this.capabilities.viewport.sm?"title":""}async onDatesChange(e){this.applyCustomButtonsState()
const t=(0,o.default)(e.view.currentStart).clone().tz(this.currentUser?.user_option?.timezone??o.default.tz.guess())
this.router.replaceWith(this.router.currentRouteName,(0,c.normalizeViewForRoute)(e.view.type),t.year(),t.month()+1,t.date())}static{dt7948.n(this.prototype,"onDatesChange",[s.action])}applyCustomButtonsState(){(0,i.schedule)("afterRender",()=>{this.args.mine?(document.querySelector(".fc-mineEvents-button").classList.add("fc-button-active"),document.querySelector(".fc-allEvents-button").classList.remove("fc-button-active")):(document.querySelector(".fc-allEvents-button").classList.add("fc-button-active"),document.querySelector(".fc-mineEvents-button").classList.remove("fc-button-active"))})}static{dt7948.n(this.prototype,"applyCustomButtonsState",[s.action])}static{(0,m.setComponentTemplate)((0,v.createTemplateFactory)({id:"ugrhDiin",block:'[[[10,0],[14,1,"upcoming-events-calendar"],[12],[1,"\\n  "],[8,[32,0],null,[["@initialDate","@onDatesChange","@onLoadEvents","@initialView","@customButtons","@leftHeaderToolbar","@centerHeaderToolbar","@rightHeaderToolbar","@refreshKey"],[[30,1],[30,0,["onDatesChange"]],[30,0,["loadEvents"]],[30,2],[30,0,["customButtons"]],[30,0,["leftHeaderToolbar"]],[30,0,["centerHeaderToolbar"]],[30,0,["rightHeaderToolbar"]],[30,0,["currentUser?","id"]]]],null],[1,"\\n"],[13]],["@initialDate","@initialView"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/upcoming-events-calendar.js",scope:()=>[p.default],isStrictMode:!0}),this)}}e.default=h}),define("discourse/plugins/discourse-calendar/discourse/components/upcoming-events-list",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/routing","@ember/service","discourse/components/conditional-loading-spinner","discourse/components/d-button","discourse/components/plugin-outlet","discourse/lib/ajax","discourse/truth-helpers","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d,l,c,u,p,m,v){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.DEFAULT_TIME_FORMAT=void 0
const h=e.DEFAULT_TIME_FORMAT="LT"
function g(e,t,s){const i=e.format("DD"),n=e.format("YYYY-MM")
s[n]=s[n]??{},s[n][i]=s[n][i]??[],s[n][i].push(t)}class f extends t.default{static{dt7948.g(this.prototype,"appEvents",[o.service])}#v=void dt7948.i(this,"appEvents")
static{dt7948.g(this.prototype,"siteSettings",[o.service])}#n=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"router",[o.service])}#i=void dt7948.i(this,"router")
static{dt7948.g(this.prototype,"isLoading",[s.tracked],function(){return!0})}#L=void dt7948.i(this,"isLoading")
static{dt7948.g(this.prototype,"hasError",[s.tracked],function(){return!1})}#Y=void dt7948.i(this,"hasError")
static{dt7948.g(this.prototype,"eventsByMonth",[s.tracked],function(){return new Map})}#H=void dt7948.i(this,"eventsByMonth")
timeFormat=this.args.params?.timeFormat??h
count=this.args.params?.count??8
upcomingDays=this.args.params?.upcomingDays??180
includeSubcategories=this.args.params?.includeSubcategories??!1
emptyMessage=(0,u.i18n)("discourse_post_event.upcoming_events_list.empty")
allDayLabel=(0,u.i18n)("discourse_post_event.upcoming_events_list.all_day")
errorMessage=(0,u.i18n)("discourse_post_event.upcoming_events_list.error")
viewAllLabel=(0,u.i18n)("discourse_post_event.upcoming_events_list.view_all")
constructor(){super(...arguments),this.appEvents.on("page:changed",this,this.updateEventsList)}willDestroy(){super.willDestroy(...arguments),this.appEvents.off("page:changed",this,this.updateEventsList)}get categoryId(){return this.router.currentRoute.attributes?.category?.id}get hasEmptyResponse(){return!this.isLoading&&!this.hasError&&0===Array.from(this.eventsByMonth.values()).length}get title(){const e=this.router.currentRoute.attributes?.category?.slug,t=this.siteSettings.map_events_title
if(""===t)return(0,u.i18n)("discourse_post_event.upcoming_events_list.title")
if(JSON.parse(t).map(({category_slug:e})=>e).includes(e)){const s=JSON.parse(t).find(t=>t.category_slug===e)
return s?.custom_title}return(0,u.i18n)("discourse_post_event.upcoming_events_list.title")}async updateEventsList(){this.isLoading=!0,this.hasError=!1
const e={limit:this.count,before:moment().add(this.upcomingDays,"days").toISOString(),after:moment().subtract(2,"hours").toISOString()}
this.includeSubcategories&&(e.include_subcategories=!0),this.categoryId&&(e.category_id=this.categoryId)
try{const{events:t}=await(0,l.ajax)("/discourse-post-event/events",{data:e})
this.eventsByMonth=this.groupByMonthAndDay(t)}catch{this.hasError=!0}finally{this.isLoading=!1}}static{dt7948.n(this.prototype,"updateEventsList",[i.action])}formatTime({starts_at:e,ends_at:t}){return(0,p.isNotFullDayEvent)(moment(e),moment(t))?moment(e).format(this.timeFormat):this.allDayLabel}static{dt7948.n(this.prototype,"formatTime",[i.action])}startsAtMonth(e,t){return moment(`${e}-${t}`).format("MMM")}static{dt7948.n(this.prototype,"startsAtMonth",[i.action])}startsAtDay(e,t){return moment(`${e}-${t}`).format("D")}static{dt7948.n(this.prototype,"startsAtDay",[i.action])}groupByMonthAndDay(e){let t=e.reduce((e,t)=>{const s=moment(t.starts_at),i=t.ends_at?moment(t.ends_at):null,n=moment()
if(!i)return g(s,t,e),e
for(;s.isSameOrBefore(i,"day");)s.isAfter(n)&&g(s,t,e),s.add(1,"day")
return e},{})
const s=new Map(Object.entries(t).sort(([e],[t])=>e.localeCompare(t))),i=new Map
for(const[n,o]of s){const e=new Map(Object.entries(o).sort(([e],[t])=>parseInt(e,10)-parseInt(t,10)))
i.set(n,e)}return i}static{(0,m.setComponentTemplate)((0,v.createTemplateFactory)({id:"Jt13RVFZ",block:'[[[10,0],[14,0,"upcoming-events-list"],[12],[1,"\\n  "],[10,"h3"],[14,0,"upcoming-events-list__heading"],[12],[1,"\\n    "],[1,[30,0,["title"]]],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"upcoming-events-list__container"],[12],[1,"\\n    "],[8,[32,0],null,[["@condition"],[[30,0,["isLoading"]]]],null],[1,"\\n\\n"],[41,[30,0,["hasEmptyResponse"]],[[[1,"      "],[10,0],[14,0,"upcoming-events-list__empty-message"],[12],[1,"\\n        "],[1,[30,0,["emptyMessage"]]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["hasError"]],[[[1,"      "],[10,0],[14,0,"upcoming-events-list__error-message"],[12],[1,"\\n        "],[1,[30,0,["errorMessage"]]],[1,"\\n      "],[13],[1,"\\n      "],[8,[32,1],[[24,0,"btn-link upcoming-events-list__try-again"]],[["@action","@label"],[[30,0,["updateEventsList"]],"discourse_post_event.upcoming_events_list.try_again"]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[51,[30,0,["isLoading"]]],[[[1,"      "],[8,[32,2],null,[["@name"],["upcoming-events-list-container"]],[["default"],[[[[1,"\\n"],[42,[28,[31,3],[[30,0,["eventsByMonth"]]],null],null,[[[42,[28,[31,3],[[30,1]],null],null,[[[42,[28,[31,4],[[28,[31,4],[[30,3]],null]],null],null,[[[1,"              "],[10,3],[14,0,"upcoming-events-list__event"],[15,6,[30,5,["post","url"]]],[12],[1,"\\n                "],[10,0],[14,0,"upcoming-events-list__event-date"],[12],[1,"\\n                  "],[10,0],[14,0,"month"],[12],[1,[28,[30,0,["startsAtMonth"]],[[30,2],[30,4]],null]],[13],[1,"\\n                  "],[10,0],[14,0,"day"],[12],[1,[28,[30,0,["startsAtDay"]],[[30,2],[30,4]],null]],[13],[1,"\\n                "],[13],[1,"\\n                "],[10,0],[14,0,"upcoming-events-list__event-content"],[12],[1,"\\n                  "],[10,1],[14,0,"upcoming-events-list__event-name"],[15,"title",[28,[32,3],[[30,5,["name"]],[30,5,["post","topic","title"]]],null]],[12],[1,"\\n                    "],[1,[28,[32,3],[[30,5,["name"]],[30,5,["post","topic","title"]]],null]],[1,"\\n                  "],[13],[1,"\\n"],[41,[30,0,["timeFormat"]],[[[1,"                    "],[10,1],[14,0,"upcoming-events-list__event-time"],[12],[1,"\\n                      "],[1,[28,[30,0,["formatTime"]],[[30,5]],null]],[1,"\\n                    "],[13],[1,"\\n"]],[]],null],[1,"                "],[13],[1,"\\n              "],[13],[1,"\\n"]],[5]],null]],[3,4]],null]],[1,2]],null],[1,"      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"upcoming-events-list__footer"],[12],[1,"\\n    "],[8,[32,4],[[24,0,"upcoming-events-list__view-all"]],[["@route"],["discourse-post-event-upcoming-events"]],[["default"],[[[[1,"\\n      "],[1,[30,0,["viewAllLabel"]]],[1,"\\n    "]],[]]]]],[1,"\\n  "],[13],[1,"\\n"],[13]],["monthData","month","events","day","event"],["if","unless","each","-each-in","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/components/upcoming-events-list.js",scope:()=>[r.default,a.default,d.default,c.or,n.LinkTo],isStrictMode:!0}),this)}}e.default=f}),define("discourse/plugins/discourse-calendar/discourse/connectors/before-topic-list-body/category-calendar",["exports","@glimmer/component","discourse/plugins/discourse-calendar/discourse/components/category-calendar","@ember/component","@ember/template-factory"],function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static shouldRender(e,t){return"before-topic-list-body"===t.siteSettings.calendar_categories_outlet}static{(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"dMG7it3E",block:'[[[10,0],[14,1,"category-events-calendar"],[14,0,"--before-topic-list-body"],[12],[8,[32,0],null,null,null],[13]],[],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/connectors/before-topic-list-body/category-calendar.js",scope:()=>[s.default],isStrictMode:!0}),this)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/connectors/category-custom-settings/show-event-category-sorting-settings",["exports","@ember/component","@ember-decorators/component","discourse/truth-helpers","discourse-i18n","@ember/template-factory"],function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=dt7948.c(class extends t.default{static{(0,t.setComponentTemplate)((0,o.createTemplateFactory)({id:"I40hUvQ+",block:'[[[41,[28,[32,0],[[30,0,["siteSettings","sort_categories_by_event_start_date_enabled"]],[30,0,["siteSettings","disable_resorting_on_categories_enabled"]]],null],[[[1,"  "],[10,"section"],[12],[1,"\\n    "],[10,"h3"],[12],[1,[28,[32,1],["discourse_post_event.category.settings_sections.event_sorting"],null]],[13],[1,"\\n\\n"],[41,[30,0,["siteSettings","sort_categories_by_event_start_date_enabled"]],[[[1,"      "],[10,"section"],[14,0,"field show-subcategory-list-field"],[12],[1,"\\n        "],[10,"label"],[12],[1,"\\n          "],[8,[32,2],null,[["@type","@checked"],["checkbox",[30,0,["category","custom_fields","sort_topics_by_event_start_date"]]]],null],[1,"\\n          "],[1,[28,[32,1],["discourse_post_event.category.sort_topics_by_event_start_date"],null]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["siteSettings","disable_resorting_on_categories_enabled"]],[[[1,"      "],[10,"section"],[14,0,"field show-subcategory-list-field"],[12],[1,"\\n        "],[10,"label"],[12],[1,"\\n          "],[8,[32,2],null,[["@type","@checked"],["checkbox",[30,0,["category","custom_fields","disable_topic_resorting"]]]],null],[1,"\\n          "],[1,[28,[32,1],["discourse_post_event.category.disable_topic_resorting"],null]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],[]],null]],[],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/connectors/category-custom-settings/show-event-category-sorting-settings.js",scope:()=>[i.or,n.i18n,t.Input],isStrictMode:!0}),this)}},[(0,s.tagName)("")])
e.default=r}),define("discourse/plugins/discourse-calendar/discourse/connectors/discovery-list-container-top/category-events-calendar",["exports","@glimmer/component","discourse/plugins/discourse-calendar/discourse/components/category-calendar","@ember/component","@ember/template-factory"],function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static shouldRender(e,t){return"discovery-list-container-top"===t.siteSettings.calendar_categories_outlet}static{(0,i.setComponentTemplate)((0,n.createTemplateFactory)({id:"kJGt7LW4",block:'[[[10,0],[14,1,"category-events-calendar"],[14,0,"--discovery-list-container-top"],[12],[8,[32,0],null,null,null],[13]],[],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/connectors/discovery-list-container-top/category-events-calendar.js",scope:()=>[s.default],isStrictMode:!0}),this)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/connectors/header-topic-title-suffix/event-date-container",["exports","discourse/plugins/discourse-calendar/discourse/components/event-date","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,s.setComponentTemplate)((0,i.createTemplateFactory)({id:"FDJ+bd84",block:'[[[8,[32,0],null,[["@topic"],[[30,1,["topic"]]]],null]],["@outletArgs"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/connectors/header-topic-title-suffix/event-date-container.js",scope:()=>[t.default],isStrictMode:!0}),(0,n.default)(void 0,"event-date-container:EventDateContainer"))
e.default=o}),define("discourse/plugins/discourse-calendar/discourse/connectors/topic-list-after-title/event-badge",["exports","@glimmer/component","@ember/service","discourse/plugins/discourse-calendar/discourse/components/event-date","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{static{dt7948.g(this.prototype,"siteSettings",[s.service])}#n=void dt7948.i(this,"siteSettings")
static{(0,n.setComponentTemplate)((0,o.createTemplateFactory)({id:"5jlP4PSD",block:'[[[41,[30,0,["siteSettings","discourse_post_event_enabled"]],[[[41,[30,1,["topic","event_starts_at"]],[[[8,[32,0],null,[["@topic"],[[30,1,["topic"]]]],null]],[]],null]],[]],null]],["@outletArgs"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/connectors/topic-list-after-title/event-badge.js",scope:()=>[i.default],isStrictMode:!0}),this)}}e.default=r}),define("discourse/plugins/discourse-calendar/discourse/connectors/user-custom-preferences/region",["exports","@glimmer/component","@ember/object","discourse/components/d-button","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/region-input","discourse/plugins/discourse-calendar/discourse/lib/regions","@ember/component","@ember/template-factory"],function(e,t,s,i,n,o,r,a,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static shouldRender(e,{siteSettings:t}){return t.calendar_enabled}onChange(e){this.args.outletArgs.model.set("custom_fields.holidays-region",e)}static{dt7948.n(this.prototype,"onChange",[s.action])}useCurrentRegion(){this.args.outletArgs.model.set("custom_fields.holidays-region",r.TIME_ZONE_TO_REGION[moment.tz.guess()]||"us")}static{dt7948.n(this.prototype,"useCurrentRegion",[s.action])}static{(0,a.setComponentTemplate)((0,d.createTemplateFactory)({id:"VwCIW/bN",block:'[[[10,0],[14,0,"control-group region"],[12],[1,"\\n  "],[10,"label"],[14,0,"control-label"],[12],[1,"\\n    "],[1,[28,[32,0],["discourse_calendar.region.title"],null]],[1,"\\n  "],[13],[1,"\\n\\n  "],[10,0],[14,0,"controls"],[12],[1,"\\n    "],[8,[32,1],null,[["@value","@allowNoneRegion","@onChange"],[[30,1,["model","custom_fields","holidays-region"]],true,[30,0,["onChange"]]]],null],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[32,2],null,[["@icon","@label","@action"],["globe","discourse_calendar.region.use_current_region",[30,0,["useCurrentRegion"]]]],null],[1,"\\n"],[13]],["@outletArgs"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/connectors/user-custom-preferences/region.js",scope:()=>[n.i18n,o.default,i.default],isStrictMode:!0}),this)}}e.default=l}),define("discourse/plugins/discourse-calendar/discourse/controllers/admin-plugins/show/discourse-calendar-holidays",["exports","@glimmer/tracking","@ember/controller","@ember/object","discourse/lib/ajax","discourse/lib/ajax-error"],function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends s.default{static{dt7948.g(this.prototype,"selectedRegion",[t.tracked],function(){return null})}#$=void dt7948.i(this,"selectedRegion")
static{dt7948.g(this.prototype,"loading",[t.tracked],function(){return!1})}#e=void dt7948.i(this,"loading")
static{dt7948.g(this.prototype,"holidays",[t.tracked],function(){return null})}#G=void dt7948.i(this,"holidays")
async getHolidays(e){if(!this.loading){this.selectedRegion=e,this.loading=!0
try{const t=await(0,n.ajax)(`/admin/discourse-calendar/holiday-regions/${e}/holidays`)
this.holidays=t.holidays}catch(t){(0,o.popupAjaxError)(t)}finally{this.loading=!1}}}static{dt7948.n(this.prototype,"getHolidays",[i.action])}}e.default=r}),define("discourse/plugins/discourse-calendar/discourse/controllers/discourse-post-event-upcoming-events",["exports","@ember/controller"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/controllers/discourse-post-event-upcoming-events/index",["exports","@ember/controller"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{get initialView(){return this.model.view}get initialDate(){return Date.parse(`${this.model.year}/${this.model.month}/${this.model.day}`)}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/controllers/discourse-post-event-upcoming-events/mine",["exports","@ember/controller"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{get initialView(){return this.model.view}get initialDate(){return Date.parse(`${this.model.year}/${this.model.month}/${this.model.day}`)}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/discourse-event-upcoming-events-route-map",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){this.route("discourse-post-event-upcoming-events",{path:"/upcoming-events"},function(){this.route("index",{path:"/:view/:year/:month/:day"}),this.route("default_index",{path:"/"}),this.route("mine",{path:"/mine/:view/:year/:month/:day"}),this.route("default_mine",{path:"/mine"})})}}),define("discourse/plugins/discourse-calendar/discourse/helpers/format-event-name",["exports","discourse-i18n"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.formatEventName=function(e,s){let i=e.name||e.post.topic.title
e.showLocalTime&&e.timezone&&!function(e,t){if(!e||!t)return!1
const s=moment.tz(e).utcOffset(),i=moment.tz(t).utcOffset()
return s===i}(e.timezone,s)&&(i+=` (${(0,t.i18n)("discourse_calendar.local_time")})`)
return i}}),define("discourse/plugins/discourse-calendar/discourse/helpers/format-future-date",["exports","@ember/template","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format"],function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){e=moment.utc(e).tz(moment.tz.guess())
const i=(0,s.default)(e)
return(0,t.htmlSafe)(e.format(i))}}),define("discourse/plugins/discourse-calendar/discourse/initializers/add-event-ui-builder",["exports","discourse/lib/plugin-api","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event","discourse/plugins/discourse-calendar/discourse/components/modal/post-event-builder"],function(e,t,s,i){"use strict"
function n(e){const t=e.getCurrentUser(),n=e.container.lookup("service:modal")
e.addComposerToolbarPopupMenuOption({action:e=>{const o=t?.user_option?.timezone,r=o||moment.tz.guess(),a=moment.tz(moment(),r),d=s.default.create({status:"public",starts_at:a,timezone:r})
n.show(i.default,{model:{event:d,toolbarEvent:e}})},group:"insertions",icon:"calendar-day",label:"discourse_post_event.builder_modal.attach",condition:e=>{if(!t||!t.can_create_discourse_post_event)return!1
const s=e.model
return s&&!s.replyingToTopic&&(s.topicFirstPost||s.creatingPrivateMessage||s.editingPost&&s.post&&1===s.post.post_number)}})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"add-post-event-builder",initialize(e){e.lookup("service:site-settings").discourse_post_event_enabled&&(0,t.withPluginApi)(n)}}}),define("discourse/plugins/discourse-calendar/discourse/initializers/add-upcoming-events-to-sidebar",["exports","discourse/lib/plugin-api","discourse-i18n"],function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"add-upcoming-events-to-sidebar",initialize(e){const i=e.lookup("service:site-settings")
i.discourse_post_event_enabled&&i.sidebar_show_upcoming_events&&(0,t.withPluginApi)(e=>{e.addCommunitySectionLink(e=>class extends e{name="upcoming-events"
route="discourse-post-event-upcoming-events"
text=(0,s.i18n)("discourse_post_event.upcoming_events.title")
title=(0,s.i18n)("discourse_post_event.upcoming_events.title")
defaultPrefixValue="calendar-day"})})}}}),define("discourse/plugins/discourse-calendar/discourse/initializers/calendar-admin-plugin-configuration-nav",["exports","discourse/lib/plugin-api"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const s="discourse-calendar"
e.default={name:"calendar-admin-plugin-configuration-nav",initialize(e){const i=e.lookup("service:current-user")
i?.admin&&(0,t.withPluginApi)(e=>{e.setAdminPluginIcon(s,"calendar-days"),e.addAdminPluginConfigurationNav(s,[{label:"discourse_calendar.holidays.header_title",route:"adminPlugins.show.discourse-calendar-holidays",description:"discourse_calendar.holidays.disabled_holidays_description"}])})}}}),define("discourse/plugins/discourse-calendar/discourse/initializers/disable-sort",["exports","discourse/lib/plugin-api"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"disable-sort",initialize(e){(0,t.withPluginApi)(t=>{t.registerValueTransformer("topic-list-header-sortable-column",({value:t,context:s})=>{if(!t)return t
return!(e.lookup("service:site-settings").disable_resorting_on_categories_enabled&&s.category?.custom_fields?.disable_topic_resorting)})})}}}),define("discourse/plugins/discourse-calendar/discourse/initializers/discourse-calendar",["exports","discourse/lib/plugin-api","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/post-calendar","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o,r){"use strict"
function a(e){const t=e.container.lookup("service:post-calendar")
function a(e){const t=e.dataset.date
if(!t)return null
const s=e.dataset.time,i=e.dataset.timezone
let n=t
return s&&(n=`${n} ${s}`),{weeklyRecurring:"1.weeks"===e.dataset.recurring,dateTime:moment.tz(n,i||"Etc/UTC")}}e.decorateCookedElement((e,t)=>{const s=e.querySelector(".calendar")
if(!s)return
e.querySelector(".discourse-calendar-header")?.remove?.()
const d=t.getModel(),l=s.dataset,c=function(e){const t=[],s=e.querySelector(":scope > p")
return s?.innerHTML?.split("<br>")?.forEach(e=>{const s=document.createElement("div")
s.innerHTML=e
const i=Array.from(s.childNodes),n=i.filter(e=>1===e.nodeType&&e.classList.contains("discourse-local-date")),o=i[0]?i[0].textContent.trim():"",r=a(n[0])
let d
n[1]&&(d=a(n[1]))
let l=function(e,t){const s=e=>!!e&&(0!==e.hours()||0!==e.minutes()||0!==e.seconds()),i=s(t?.dateTime)||s(e?.dateTime),n=i?"YYYY-MM-DD HH:mm:ssZ":"YYYY-MM-DD"
let o={start:e.dateTime.format(n),allDay:!1}
t?i?o.end=t.dateTime.format(n):(o.end=t.dateTime.add(1,"days").format(n),o.allDay=!0):o.allDay=!0
e.weeklyRecurring&&(o.startTime={hours:e.dateTime.hours(),minutes:e.dateTime.minutes(),seconds:e.dateTime.seconds()},o.daysOfWeek=[e.dateTime.day()])
return o}(r,d)
l.title=o,t.push(l)}),t}(s)
s.innerHTML="",t.renderGlimmer(s,(0,n.setComponentTemplate)((0,o.createTemplateFactory)({id:"B46jiIgq",block:'[[[8,[32,0],null,[["@post","@options","@staticEvents","@height"],[[30,1,["post"]],[30,1,["options"]],[30,1,["staticEvents"]],"650px"]],null]],["@data"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/initializers/discourse-calendar.js",scope:()=>[i.default],isStrictMode:!0}),(0,r.default)(void 0,void 0)),{options:l,post:d,staticEvents:c})},{onlyStream:!0,id:"discourse-calendar"}),e.registerCustomPostMessageCallback("calendar_change",()=>{t.refresh()}),e.registerNotificationTypeRenderer&&(e.registerNotificationTypeRenderer("event_reminder",e=>class extends e{get linkTitle(){return this.notification.data.title?(0,s.i18n)(this.notification.data.title):super.linkTitle}get icon(){return"calendar-day"}get label(){return(0,s.i18n)(this.notification.data.message)}get description(){return this.notification.data.topic_title}}),e.registerNotificationTypeRenderer("event_invitation",e=>class extends e{get icon(){return"calendar-day"}get label(){return"discourse_post_event.notifications.invite_user_predefined_attendance_notification"===this.notification.data.message?(0,s.i18n)(this.notification.data.message,{username:this.username,eventName:this.notification.data.event_name||(0,s.i18n)("discourse_post_event.notifications.an_event")}):super.label}get description(){return this.notification.data.topic_title}}))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"discourse-calendar",initialize(e){e.lookup("service:site-settings").calendar_enabled&&(0,t.withPluginApi)(a)}}})
define("discourse/plugins/discourse-calendar/discourse/initializers/discourse-post-event-decorator",["exports","discourse/lib/environment","discourse/lib/plugin-api","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/discourse-post-event","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o,r,a,d,l){"use strict"
function c(e){e.innerHTML="",e.classList.add("discourse-post-event-preview")
const s=`discourse_post_event.models.event.status.${e.dataset.status||"public"}.title`
if(i.default.lookup(s,{locale:"en"})){const t=document.createElement("div")
t.classList.add("event-preview-status"),t.innerText=(0,i.i18n)(s),e.appendChild(t)}const n=document.createElement("div")
n.classList.add("event-preview-dates")
const o=moment.tz(e.dataset.start,e.dataset.timezone||"UTC"),a=e.dataset.end&&moment.tz(e.dataset.end,e.dataset.timezone||"UTC"),d=(0,r.default)(o,a),l=(0,t.isTesting)()?"UTC":moment.tz.guess()
let c=`<span class='start'>${o.tz(l).format(d)}</span>`
a&&(c+=` → <span class='end'>${a.tz(l).format(d)}</span>`),n.innerHTML=c,e.appendChild(n)}function u(e,t){t.querySelectorAll(".discourse-post-event").forEach((e,t)=>{t>0?function(e){e.classList.add("discourse-post-event-preview","alert","alert-error"),e.classList.remove("discourse-post-event"),e.innerText=(0,i.i18n)("discourse_post_event.preview.more_than_one_event")}(e):c(e)})}function p(e){e.decorateCookedElement((e,t)=>{if(e.classList.contains("d-editor-preview"))u(0,e)
else if(t){const s=t.getModel()
if(!s?.event)return
const i=e.querySelector(".discourse-post-event")
if(!i)return
const r=document.createElement("div")
i.before(r)
const c=o.default.create(s.event)
t.renderGlimmer(r,(0,a.setComponentTemplate)((0,d.createTemplateFactory)({id:"Dv869zwV",block:'[[[8,[32,0],null,[["@event"],[[32,1]]],null]],[],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/initializers/discourse-post-event-decorator.js",scope:()=>[n.default,c],isStrictMode:!0}),(0,l.default)(void 0,void 0)))}},{id:"discourse-post-event-decorator"}),e.replaceIcon("notification.discourse_post_event.notifications.invite_user_notification","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.invite_user_auto_notification","calendar-day"),e.replaceIcon("notification.discourse_calendar.invite_user_notification","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.invite_user_predefined_attendance_notification","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.before_event_reminder","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.after_event_reminder","calendar-day"),e.replaceIcon("notification.discourse_post_event.notifications.ongoing_event_reminder","calendar-day")}Object.defineProperty(e,"__esModule",{value:!0}),e.buildEventPreview=c,e.default=void 0
e.default={name:"discourse-post-event-decorator",initialize(e){e.lookup("service:site-settings").discourse_post_event_enabled&&(0,s.withPluginApi)(p)}}}),define("discourse/plugins/discourse-calendar/discourse/initializers/event-relative-date",["exports","@ember/runloop","discourse/lib/environment","discourse/lib/later","discourse/plugins/discourse-calendar/discourse/lib/event-relative-date"],function(e,t,s,i,n){"use strict"
function o(){document.querySelectorAll(".event-relative-date.topic-list").forEach(e=>(0,n.default)(e))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"event-future-date",initialize(){o(),(0,s.isTesting)()||this._tick()},teardown(){this._interval&&((0,t.cancel)(this._interval),this._interval=null)},_tick(){this._interval&&(0,t.cancel)(this._interval),this._interval=(0,i.default)(()=>{o(),this._tick()},6e4)}}}),define("discourse/plugins/discourse-calendar/discourse/lib/calendar-locale",["exports","discourse-i18n"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.getCalendarButtonsText=function(){return{today:(0,t.i18n)("discourse_calendar.toolbar_button.today"),month:(0,t.i18n)("discourse_calendar.toolbar_button.month"),week:(0,t.i18n)("discourse_calendar.toolbar_button.week"),day:(0,t.i18n)("discourse_calendar.toolbar_button.day"),list:(0,t.i18n)("discourse_calendar.toolbar_button.year")}},e.getCurrentBcp47Locale=function(){return t.default.currentLocale().replace("_","-").toLowerCase()}}),define("discourse/plugins/discourse-calendar/discourse/lib/calendar-view-helper",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.normalizeViewForCalendar=function(e){return{agendaDay:"timeGridDay",agendaWeek:"timeGridWeek",month:"dayGridMonth",listNextYear:"listYear",year:"listYear",week:"timeGridWeek",day:"timeGridDay"}[e]||e},e.normalizeViewForRoute=function(e){return{timeGridDay:"day",timeGridWeek:"week",dayGridMonth:"month",listYear:"year"}[e]||e}}),define("discourse/plugins/discourse-calendar/discourse/lib/colors",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.colorToHex=function(e){let t="#"
for(let s=0;s<3;s++)t+=("00"+Math.round(e[s]).toString(16)).slice(-2)
return t},e.contrastColor=function(e){return(.2126*e[0]+.7152*e[1]+.0722*e[2])/255>=.5?"#000d":"#fffd"},e.stringToColor=function(e){let t=0
for(let i=0;i<e.length;i++)t=e.charCodeAt(i)+((t<<5)-t)
let s=[]
for(let i=0;i<3;i++){let e=t>>8*i&255
s.push(e)}return s}}),define("discourse/plugins/discourse-calendar/discourse/lib/discourse-markdown/discourse-calendar",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.allowList(["div.calendar","div.discourse-calendar-wrap","select.discourse-calendar-timezone-picker","span.discourse-calendar-timezone-wrap","h2.discourse-calendar-title","div[data-calendar-type]","div[data-calendar-default-view]","div[data-calendar-default-timezone]","div[data-weekends]","div[data-hidden-days]","div.group-timezones","div[data-group]","div[data-size]"]),e.registerOptions((e,t)=>{e.features["discourse-calendar-enabled"]=!!t.calendar_enabled}),e.registerPlugin(e=>{e.options.discourse.features["discourse-calendar-enabled"]&&(e.block.bbcode.ruler.push("discourse-calendar",t),e.block.bbcode.ruler.push("discourse-group-timezones",s))})}
const t={tag:"calendar",before:function(e,t){e.push("div_calendar_wrap","div",1).attrs=[["class","discourse-calendar-wrap"]]
let s=e.push("div_calendar","div",1)
s.attrs=[["class","calendar"],["data-calendar-type",t.attrs.type||"dynamic"],["data-calendar-default-timezone",t.attrs.defaultTimezone]],t.attrs.defaultView&&s.attrs.push(["data-calendar-default-view",t.attrs.defaultView]),t.attrs.weekends&&s.attrs.push(["data-weekends",t.attrs.weekends]),t.attrs.showAddToCalendar&&s.attrs.push(["data-calendar-show-add-to-calendar","true"===t.attrs.showAddToCalendar]),t.attrs.fullDay&&s.attrs.push(["data-calendar-full-day","true"===t.attrs.fullDay]),t.attrs.hiddenDays&&s.attrs.push(["data-hidden-days",t.attrs.hiddenDays])},after:function(e){e.push("div_calendar","div",-1),e.push("div_calendar_wrap","div",-1)}},s={tag:"timezones",before:function(e,t){e.push("div_group_timezones","div",1).attrs=[["class","group-timezones"],["data-group",t.attrs.group],["data-size",t.attrs.size||"medium"]]},after:function(e){e.push("div_group_timezones","div",-1)}}}),define("discourse/plugins/discourse-calendar/discourse/lib/discourse-markdown/discourse-post-event-block",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.allowList(["div.discourse-post-event"]),e.registerOptions((e,t)=>{e.features.discourse_post_event=t.calendar_enabled&&t.discourse_post_event_enabled}),e.registerPlugin(e=>e.block.bbcode.ruler.push("discourse-post-event",t))}
const t={tag:"event",wrap:(e,t)=>!!t.attrs.start&&(e.attrs=[["class","discourse-post-event"]],Object.keys(t.attrs).forEach(s=>{const i=t.attrs[s]
var n
void 0!==i&&e.attrs.push([`data-${n=s,n.replace(/[A-Z]/g,function(e,t){return(0!==t?"-":"")+e.toLowerCase()})}`,i])}),!0)}}),define("discourse/plugins/discourse-calendar/discourse/lib/event-relative-date",["exports","discourse-i18n","discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format"],function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){e.classList.remove("past","current","future"),e.innerHTML=""
const i=moment.utc(e.dataset.starts_at).tz(moment.tz.guess()),n=moment.utc(e.dataset.ends_at).tz(moment.tz.guess()),o=(0,s.default)(i)
let r=i.format(o)
n&&(r+=` → ${n.format(o)}`)
if(e.setAttribute("title",r),i.isAfter(moment())&&n.isAfter(moment()))return e.classList.add("future"),void function(e,t){e.innerText=t.from(moment())}(e,i)
if(i.isBefore(moment())&&n.isAfter(moment()))return e.classList.add("current"),void function(e,s){const i=document.createElement("div")
i.classList.add("indicator"),e.appendChild(i)
const n=document.createElement("span")
n.classList.add("text"),n.innerText=(0,t.i18n)("discourse_post_event.topic_title.ends_in_duration",{duration:s.from(moment())}),e.appendChild(n)}(e,n)
if(i.isBefore(moment())&&n.isBefore(moment()))return e.classList.add("past"),void function(e,t){e.innerText=t.from(moment())}(e,n)}}),define("discourse/plugins/discourse-calendar/discourse/lib/full-calendar-default-options",["exports","discourse/plugins/discourse-calendar/discourse/lib/calendar-locale"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return{locale:(0,t.getCurrentBcp47Locale)(),buttonText:(0,t.getCalendarButtonsText)()}}}),define("discourse/plugins/discourse-calendar/discourse/lib/guess-best-date-format",["exports"],function(e){"use strict"
function t(e,t){return e.hours()>0||e.minutes()>0||t&&(moment(t).hours()>0||moment(t).minutes()>0)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,s){let i
i=t(e,s)?"LLL":"LL"
return i},e.isNotFullDayEvent=t}),define("discourse/plugins/discourse-calendar/discourse/lib/raw-event-helper",["exports"],function(e){"use strict"
function t(e){return e.toLowerCase().replace(/-/g,"_").replace(/_(.)/g,function(e,t){return t.toUpperCase()})}Object.defineProperty(e,"__esModule",{value:!0}),e.buildParams=function(e,s,i,n){const o={},r=i.timezone||"UTC"
o.start=moment(e).tz(r).format("YYYY-MM-DD HH:mm"),i.isClosed&&(o.closed="true")
i.status&&(o.status=i.status)
i.name&&i.name.trim()&&(o.name=i.name)
i.location&&i.location.trim()&&(o.location=i.location)
i.description&&i.description.trim()&&(o.description=i.description)
i.url&&i.url.trim()&&(o.url=i.url)
i.timezone&&(o.timezone=i.timezone)
i.recurrence&&(o.recurrence=i.recurrence)
i.recurrenceUntil&&(o.recurrenceUntil=moment(i.recurrenceUntil).tz(r).format("YYYY-MM-DD HH:mm"))
i.showLocalTime&&(o.showLocalTime="true")
i.minimal&&(o.minimal="true")
i.chatEnabled&&(o.chatEnabled="true")
i.maxAttendees&&(o.maxAttendees=`${i.maxAttendees}`)
s&&(o.end=moment(s).tz(r).format("YYYY-MM-DD HH:mm"))
"private"===i.status&&(o.allowedGroups=(i.rawInvitees||[]).join(","))
i.reminders&&i.reminders.length&&(o.reminders=i.reminders.map(e=>{const t=Object.assign({},e)
return"after"===t.period&&(t.value=`-${Math.abs(parseInt(t.value,10))}`),"before"===t.period&&(t.value=Math.abs(parseInt(`${t.value}`,10))),`${t.type}.${t.value}.${t.unit}`}).join(","))
return n.discourse_post_event_allowed_custom_fields.split("|").filter(Boolean).forEach(e=>{const s=t(e)
void 0!==i.customFields[e]&&(o[s]=i.customFields[e])}),o},e.camelCase=t,e.removeEvent=function(e){return e.replace(/\[event (.*?)\](.*?)\[\/event\]/s,"")},e.replaceRaw=function(e,t){const s=/\[event (.*?)\](.*?)\[\/event\]/s,i=t.match(s)
if(i&&i[1]){const i=[]
let n=e.description
return n=n?`${n}\n`:"",delete e.description,Object.keys(e).forEach(t=>{const s=e[t]
null!=s&&""!==s&&""!==String(s).trim()&&i.push(`${t}="${s.replace(/"/g,"")}"`)}),t.replace(s,`[event ${i.join(" ")}]\n${n}[/event]`)}return!1}}),define("discourse/plugins/discourse-calendar/discourse/lib/regions",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.TIME_ZONE_TO_REGION=e.HOLIDAY_REGIONS=void 0
e.HOLIDAY_REGIONS=["ae","ar","at","au","au_nsw","au_vic","au_qld","au_nt","au_act","au_sa","au_wa","au_tas","au_tas_south","au_qld_cairns","au_qld_brisbane","au_tas_north","au_vic_melbourne","be_fr","be_nl","br","br_spcapital","br_sp","bg_en","bg_bg","ca","ca_qc","ca_ab","ca_sk","ca_on","ca_bc","ca_nb","ca_mb","ca_ns","ca_pe","ca_nl","ca_nt","ca_nu","ca_yt","us","ch_zh","ch_be","ch_lu","ch_ur","ch_sz","ch_ow","ch_nw","ch_gl","ch_zg","ch_fr","ch_so","ch_bs","ch_bl","ch_sh","ch_ar","ch_ai","ch_sg","ch_gr","ch_ag","ch_tg","ch_ti","ch_vd","ch_ne","ch_ge","ch_ju","ch_vs","ch","cl","co","cr","cz","dk","de","de_bw","de_by","de_he","de_nw","de_rp","de_sl","de_sn_sorbian","de_th_cath","de_sn","de_st","de_be","de_by_cath","de_by_augsburg","de_th","de_bb","de_mv","de_hb","de_hh","de_ni","de_sh","ee","gr","es_pv","es_na","es_an","es_ib","es_cm","es_mu","es_m","es_ar","es_cl","es_cn","es_lo","es_ga","es_ce","es_o","es_ex","es","es_ct","es_v","es_vc","fi","fr_a","fr_m","fr","gb","gb_eng","gb_wls","gb_eaw","gb_nir","je","gb_jsy","gg","gb_gsy","gb_sct","gb_con","im","gb_iom","ge","gh","hr","hk","hu","id","ie","in","in_mh","in_gj","in_ka","in_tn","is","it","it_ve","it_tv","it_vr","it_pd","it_fi","it_ge","it_to","it_rm","it_vi","it_bl","it_ro","kr","kz","li","lt","lv","ma","mt_mt","mt_en","mx","mx_pue","nl","lu","no","nz","nz_sl","nz_we","nz_ak","nz_nl","nz_ne","nz_ot","nz_ta","nz_sc","nz_hb","nz_mb","nz_ca","nz_ch","nz_wl","pe","ph","pl","pt","pt_li","pt_po","ro","rs_cyrl","rs_la","ru","se","sa","tn","tr","ua","us_la","us_ct","us_de","us_ga","us_hi","us_in","us_ky","us_nj","us_nc","us_nd","us_pr","us_tn","us_il","us_vt","us_ak","us_ca","us_dc","us_me","us_ma","us_al","us_ms","us_ne","us_mo","us_sc","us_wv","us_ut","us_ri","us_nv","us_nm","us_md","us_fl","us_ia","us_ks","us_mi","us_mn","us_nh","us_ok","us_or","us_pa","us_tx","us_va","us_wa","us_ar","us_wi","za","ve","sk","si","jp","vi","sg","my","th","ng","ke","zw"],e.TIME_ZONE_TO_REGION={"Africa/Accra":"gh","Africa/Casablanca":"ma","Africa/Ceuta":"es","Africa/Harare":"zw","Africa/Johannesburg":"za","Africa/Lagos":"ng","Africa/Nairobi":"ke","Africa/Tunis":"tn","America/Adak":"us","America/Anchorage":"us","America/Araguaina":"br","America/Argentina/Buenos_Aires":"ar","America/Argentina/Catamarca":"ar","America/Argentina/Cordoba":"ar","America/Argentina/Jujuy":"ar","America/Argentina/La_Rioja":"ar","America/Argentina/Mendoza":"ar","America/Argentina/Rio_Gallegos":"ar","America/Argentina/Salta":"ar","America/Argentina/San_Juan":"ar","America/Argentina/San_Luis":"ar","America/Argentina/Tucuman":"ar","America/Argentina/Ushuaia":"ar","America/Atikokan":"ca","America/Bahia":"br","America/Bahia_Banderas":"mx","America/Belem":"br","America/Blanc-Sablon":"ca","America/Boa_Vista":"br","America/Bogota":"co","America/Boise":"us","America/Cambridge_Bay":"ca","America/Campo_Grande":"br","America/Cancun":"mx","America/Caracas":"ve","America/Chicago":"us","America/Chihuahua":"mx","America/Ciudad_Juarez":"mx","America/Costa_Rica":"cr","America/Coyhaique":"cl","America/Creston":"ca","America/Cuiaba":"br","America/Dawson":"ca","America/Dawson_Creek":"ca","America/Denver":"us","America/Detroit":"us","America/Edmonton":"ca","America/Eirunepe":"br","America/Fort_Nelson":"ca","America/Fortaleza":"br","America/Glace_Bay":"ca","America/Goose_Bay":"ca","America/Halifax":"ca","America/Hermosillo":"mx","America/Indiana/Indianapolis":"us","America/Indiana/Knox":"us","America/Indiana/Marengo":"us","America/Indiana/Petersburg":"us","America/Indiana/Tell_City":"us","America/Indiana/Vevay":"us","America/Indiana/Vincennes":"us","America/Indiana/Winamac":"us","America/Inuvik":"ca","America/Iqaluit":"ca","America/Juneau":"us","America/Kentucky/Louisville":"us","America/Kentucky/Monticello":"us","America/Lima":"pe","America/Los_Angeles":"us","America/Maceio":"br","America/Manaus":"br","America/Matamoros":"mx","America/Mazatlan":"mx","America/Menominee":"us","America/Merida":"mx","America/Metlakatla":"us","America/Mexico_City":"mx","America/Moncton":"ca","America/Monterrey":"mx","America/New_York":"us","America/Nome":"us","America/Noronha":"br","America/North_Dakota/Beulah":"us","America/North_Dakota/Center":"us","America/North_Dakota/New_Salem":"us","America/Ojinaga":"mx","America/Phoenix":"us","America/Porto_Velho":"br","America/Punta_Arenas":"cl","America/Rankin_Inlet":"ca","America/Recife":"br","America/Regina":"ca","America/Resolute":"ca","America/Rio_Branco":"br","America/Santarem":"br","America/Santiago":"cl","America/Sao_Paulo":"br","America/Sitka":"us","America/St_Johns":"ca","America/St_Thomas":"vi","America/Swift_Current":"ca","America/Tijuana":"mx","America/Toronto":"ca","America/Vancouver":"ca","America/Whitehorse":"ca","America/Winnipeg":"ca","America/Yakutat":"us","Antarctica/Macquarie":"au","Asia/Almaty":"kz","Asia/Anadyr":"ru","Asia/Aqtau":"kz","Asia/Aqtobe":"kz","Asia/Atyrau":"kz","Asia/Bangkok":"th","Asia/Barnaul":"ru","Asia/Chita":"ru","Asia/Dubai":"ae","Asia/Hong_Kong":"hk","Asia/Irkutsk":"ru","Asia/Jakarta":"id","Asia/Jayapura":"id","Asia/Kamchatka":"ru","Asia/Khandyga":"ru","Asia/Kolkata":"in","Asia/Krasnoyarsk":"ru","Asia/Kuala_Lumpur":"my","Asia/Kuching":"my","Asia/Magadan":"ru","Asia/Makassar":"id","Asia/Manila":"ph","Asia/Novokuznetsk":"ru","Asia/Novosibirsk":"ru","Asia/Omsk":"ru","Asia/Oral":"kz","Asia/Pontianak":"id","Asia/Qostanay":"kz","Asia/Qyzylorda":"kz","Asia/Riyadh":"sa","Asia/Sakhalin":"ru","Asia/Seoul":"kr","Asia/Singapore":"sg","Asia/Srednekolymsk":"ru","Asia/Tbilisi":"ge","Asia/Tokyo":"jp","Asia/Tomsk":"ru","Asia/Ust-Nera":"ru","Asia/Vladivostok":"ru","Asia/Yakutsk":"ru","Asia/Yekaterinburg":"ru","Atlantic/Azores":"pt","Atlantic/Canary":"es","Atlantic/Madeira":"pt","Atlantic/Reykjavik":"is","Australia/Adelaide":"au","Australia/Brisbane":"au","Australia/Broken_Hill":"au","Australia/Darwin":"au","Australia/Eucla":"au","Australia/Hobart":"au","Australia/Lindeman":"au","Australia/Lord_Howe":"au","Australia/Melbourne":"au","Australia/Perth":"au","Australia/Sydney":"au","Europe/Amsterdam":"nl","Europe/Astrakhan":"ru","Europe/Berlin":"de","Europe/Bratislava":"sk","Europe/Bucharest":"ro","Europe/Budapest":"hu","Europe/Busingen":"de","Europe/Copenhagen":"dk","Europe/Dublin":"ie","Europe/Guernsey":"gg","Europe/Helsinki":"fi","Europe/Isle_of_Man":"im","Europe/Istanbul":"tr","Europe/Jersey":"je","Europe/Kaliningrad":"ru","Europe/Kirov":"ru","Europe/Kyiv":"ua","Europe/Lisbon":"pt","Europe/Ljubljana":"si","Europe/London":"gb","Europe/Luxembourg":"lu","Europe/Madrid":"es","Europe/Moscow":"ru","Europe/Oslo":"no","Europe/Paris":"fr","Europe/Prague":"cz","Europe/Riga":"lv","Europe/Rome":"it","Europe/Samara":"ru","Europe/Saratov":"ru","Europe/Simferopol":"ru","Europe/Stockholm":"se","Europe/Tallinn":"ee","Europe/Ulyanovsk":"ru","Europe/Vaduz":"li","Europe/Vienna":"at","Europe/Vilnius":"lt","Europe/Volgograd":"ru","Europe/Warsaw":"pl","Europe/Zagreb":"hr","Europe/Zurich":"ch","Pacific/Auckland":"nz","Pacific/Chatham":"nz","Pacific/Easter":"cl","Pacific/Honolulu":"us"}}),define("discourse/plugins/discourse-calendar/discourse/lib/round-time",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){return e.round(t,"minutes")},"function"!=typeof moment.fn.round&&(moment.fn.round=function(e,t,s){s=s||"round"
let i,n=this,o={hours:{name:"Hours",maxValue:24},minutes:{name:"Minutes",maxValue:60},seconds:{name:"Seconds",maxValue:60},milliseconds:{name:"Milliseconds",maxValue:1e3}},r={mm:o.milliseconds.name,milliseconds:o.milliseconds.name,Milliseconds:o.milliseconds.name,s:o.seconds.name,seconds:o.seconds.name,Seconds:o.seconds.name,m:o.minutes.name,minutes:o.minutes.name,Minutes:o.minutes.name,H:o.hours.name,h:o.hours.name,hours:o.hours.name,Hours:o.hours.name},a=0,d=!1,l=1
if(t.length>1&&"mm"!==t&&"s"!==t.slice(-1)&&(t+="s"),!o[t=r[t].toLowerCase()])throw new Error('The value to round is not valid. Possibles ["hours", "minutes", "seconds", "milliseconds"]')
let c="get"+o[t].name,u="set"+o[t].name
for(let p in o)p===t?(a=n._d[c](),i=o[p].maxValue,d=!0):d&&(l*=o[p].maxValue,a+=n._d["get"+o[p].name]()/l,n._d["set"+o[p].name](0))
return a=Math[s](a/e)*e,a=Math.min(a,i),n._d[u](a),n}),"function"!=typeof moment.fn.ceil&&(moment.fn.ceil=function(e,t){return this.round(e,t,"ceil")}),"function"!=typeof moment.fn.floor&&(moment.fn.floor=function(e,t){return this.round(e,t,"floor")})
const t=15}),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event-stats",["exports","@glimmer/tracking"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s{static create(e={}){return new s(e)}static{dt7948.g(this.prototype,"going",[t.tracked],function(){return 0})}#W=void dt7948.i(this,"going")
static{dt7948.g(this.prototype,"interested",[t.tracked],function(){return 0})}#V=void dt7948.i(this,"interested")
static{dt7948.g(this.prototype,"invited",[t.tracked],function(){return 0})}#q=void dt7948.i(this,"invited")
static{dt7948.g(this.prototype,"notGoing",[t.tracked],function(){return 0})}#K=void dt7948.i(this,"notGoing")
constructor(e={}){this.going=e.going,this.invited=e.invited,this.interested=e.interested,this.notGoing=e.not_going}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event",["exports","@glimmer/tracking","@ember/object","@ember-compat/tracked-built-ins","discourse/lib/decorators","discourse/lib/utilities","discourse/models/user","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event-stats","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee"],function(e,t,s,i,n,o,r,a,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,o.optionalRequire)("discourse/plugins/chat/discourse/models/chat-channel"),c={type:"notification",value:15,unit:"minutes",period:"before"}
class u{static create(e={}){return new u(e)}static{dt7948.g(this.prototype,"title",[t.tracked])}#J=void dt7948.i(this,"title")
static{dt7948.g(this.prototype,"rrule",[t.tracked])}#Z=void dt7948.i(this,"rrule")
static{dt7948.g(this.prototype,"name",[t.tracked])}#Q=void dt7948.i(this,"name")
static{dt7948.g(this.prototype,"categoryId",[t.tracked])}#X=void dt7948.i(this,"categoryId")
static{dt7948.g(this.prototype,"startsAt",[t.tracked])}#P=void dt7948.i(this,"startsAt")
static{dt7948.g(this.prototype,"endsAt",[t.tracked])}#I=void dt7948.i(this,"endsAt")
static{dt7948.g(this.prototype,"duration",[t.tracked])}#ee=void dt7948.i(this,"duration")
static{dt7948.g(this.prototype,"rawInvitees",[t.tracked])}#te=void dt7948.i(this,"rawInvitees")
static{dt7948.g(this.prototype,"location",[t.tracked])}#se=void dt7948.i(this,"location")
static{dt7948.g(this.prototype,"url",[t.tracked])}#ie=void dt7948.i(this,"url")
static{dt7948.g(this.prototype,"description",[t.tracked])}#ne=void dt7948.i(this,"description")
static{dt7948.g(this.prototype,"timezone",[t.tracked])}#oe=void dt7948.i(this,"timezone")
static{dt7948.g(this.prototype,"showLocalTime",[t.tracked])}#re=void dt7948.i(this,"showLocalTime")
static{dt7948.g(this.prototype,"status",[t.tracked])}#ae=void dt7948.i(this,"status")
static{dt7948.g(this.prototype,"post",[t.tracked])}#de=void dt7948.i(this,"post")
static{dt7948.g(this.prototype,"minimal",[t.tracked])}#le=void dt7948.i(this,"minimal")
static{dt7948.g(this.prototype,"chatEnabled",[t.tracked])}#ce=void dt7948.i(this,"chatEnabled")
static{dt7948.g(this.prototype,"canUpdateAttendance",[t.tracked])}#ue=void dt7948.i(this,"canUpdateAttendance")
static{dt7948.g(this.prototype,"canActOnDiscoursePostEvent",[t.tracked])}#pe=void dt7948.i(this,"canActOnDiscoursePostEvent")
static{dt7948.g(this.prototype,"shouldDisplayInvitees",[t.tracked])}#me=void dt7948.i(this,"shouldDisplayInvitees")
static{dt7948.g(this.prototype,"isClosed",[t.tracked])}#ve=void dt7948.i(this,"isClosed")
static{dt7948.g(this.prototype,"isExpired",[t.tracked])}#he=void dt7948.i(this,"isExpired")
static{dt7948.g(this.prototype,"isStandalone",[t.tracked])}#ge=void dt7948.i(this,"isStandalone")
static{dt7948.g(this.prototype,"maxAttendees",[t.tracked])}#fe=void dt7948.i(this,"maxAttendees")
static{dt7948.g(this.prototype,"atCapacity",[t.tracked])}#_e=void dt7948.i(this,"atCapacity")
static{dt7948.g(this.prototype,"recurrenceUntil",[t.tracked])}#be=void dt7948.i(this,"recurrenceUntil")
static{dt7948.g(this.prototype,"recurrence",[t.tracked])}#ye=void dt7948.i(this,"recurrence")
static{dt7948.g(this.prototype,"customFields",[t.tracked])}#we=void dt7948.i(this,"customFields")
static{dt7948.g(this.prototype,"channel",[t.tracked])}#Ae=void dt7948.i(this,"channel")
static{dt7948.g(this.prototype,"_watchingInvitee",[t.tracked])}#ke=void dt7948.i(this,"_watchingInvitee")
static{dt7948.g(this.prototype,"_sampleInvitees",[t.tracked])}#Ee=void dt7948.i(this,"_sampleInvitees")
static{dt7948.g(this.prototype,"_stats",[t.tracked])}#xe=void dt7948.i(this,"_stats")
static{dt7948.g(this.prototype,"_creator",[t.tracked])}#Te=void dt7948.i(this,"_creator")
static{dt7948.g(this.prototype,"_reminders",[t.tracked])}#Se=void dt7948.i(this,"_reminders")
constructor(e={}){this.id=e.id,this.rrule=e.rrule,this.name=e.name,this.categoryId=e.category_id,this.startsAt=e.starts_at,this.endsAt=e.ends_at,this.duration=e.duration,this.rawInvitees=e.raw_invitees,this.sampleInvitees=e.sample_invitees||[],this.location=e.location,this.url=e.url,this.description=e.description,this.timezone=e.timezone,this.showLocalTime=e.show_local_time,this.status=e.status,this.creator=e.creator,this.post=e.post,this.isClosed=e.is_closed,this.isExpired=e.is_expired,this.isStandalone=e.is_standalone,this.minimal=e.minimal,this.chatEnabled=e.chat_enabled,this.maxAttendees=e.max_attendees,this.atCapacity=e.at_capacity,this.recurrence=e.recurrence,this.recurrenceUntil=e.recurrence_until,this.canUpdateAttendance=e.can_update_attendance,this.canActOnDiscoursePostEvent=e.can_act_on_discourse_post_event,this.shouldDisplayInvitees=e.should_display_invitees,this.watchingInvitee=e.watching_invitee
this.stats=e.stats,this.reminders=e.reminders,this.customFields=s.default.create(e.custom_fields||{}),e.channel&&l&&(this.channel=l.create(e.channel))}get watchingInvitee(){return this._watchingInvitee}set watchingInvitee(e){this._watchingInvitee=e?d.default.create(e):null}get sampleInvitees(){return this._sampleInvitees}set sampleInvitees(e=[]){this._sampleInvitees=new i.TrackedArray(e.map(e=>d.default.create(e)))}get stats(){return this._stats}set stats(e){this._stats=this.#Me(e)}get reminders(){return this._reminders}set reminders(e=[]){this._reminders=new i.TrackedArray(e)}get creator(){return this._creator}set creator(e){this._creator=this.#De(e)}get isPublic(){return"public"===this.status}get isPrivate(){return"private"===this.status}updateFromEvent(e){this.name=e.name,this.startsAt=e.startsAt,this.endsAt=e.endsAt,this.duration=e.duration,this.location=e.location,this.url=e.url,this.timezone=e.timezone,this.showLocalTime=e.showLocalTime,this.description=e.description,this.status=e.status,this.creator=e.creator,this.isClosed=e.isClosed,this.isExpired=e.isExpired,this.isStandalone=e.isStandalone,this.minimal=e.minimal,this.chatEnabled=e.chatEnabled,this.rrule=e.rrule,this.maxAttendees=e.maxAttendees,this.atCapacity=e.atCapacity,this.recurrence=e.recurrence,this.recurrenceUntil=e.recurrenceUntil,this.canUpdateAttendance=e.canUpdateAttendance,this.canActOnDiscoursePostEvent=e.canActOnDiscoursePostEvent,this.shouldDisplayInvitees=e.shouldDisplayInvitees,this.stats=e.stats,this.sampleInvitees=e.sampleInvitees||[],this.reminders=e.reminders}removeReminder(e){const t=this.reminders.findIndex(t=>t.id===e.id)
t>-1&&this.reminders.splice(t,1)}static{dt7948.n(this.prototype,"removeReminder",[n.bind])}addReminder(e){e??={...c},this.reminders.push(e)}static{dt7948.n(this.prototype,"addReminder",[n.bind])}#De(e){return!e||e instanceof r.default?e:r.default.create(e)}#Me(e){return!e||e instanceof a.default?e:a.default.create(e)}}e.default=u}),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee",["exports","@glimmer/tracking","discourse/models/user"],function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i{static create(e={}){return new i(e)}static{dt7948.g(this.prototype,"status",[t.tracked])}#ae=void dt7948.i(this,"status")
constructor(e={}){this.id=e.id,this.post_id=e.post_id,this.status=e.status,this.user=this.#De(e.user)}#De(e){return!e||e instanceof s.default?e:s.default.create(e)}}e.default=i}),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitees",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/models/user","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee"],function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o{static create(e={}){return new o(e)}static{dt7948.g(this.prototype,"_invitees",[t.tracked])}#Ce=void dt7948.i(this,"_invitees")
static{dt7948.g(this.prototype,"_suggestedUsers",[t.tracked])}#ze=void dt7948.i(this,"_suggestedUsers")
constructor(e={}){this.invitees=e.invitees||[],this.suggestedUsers=e.meta?.suggested_users||[]}get invitees(){return this._invitees}set invitees(e=[]){this._invitees=new s.TrackedArray(e.map(e=>n.default.create(e)))}get suggestedUsers(){return this._suggestedUsers}set suggestedUsers(e=[]){this._suggestedUsers=new s.TrackedArray(e.map(e=>i.default.create(e)))}add(e){this.invitees.push(e),this.suggestedUsers=this.suggestedUsers.filter(t=>t.id!==e.user.id)}remove(e){this.invitees=this.invitees.filter(t=>t.user.id!==e.user.id)}}e.default=o}),define("discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-reminder",["exports","discourse/models/rest"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{init(){super.init(...arguments),this.__type="discourse-post-event-reminder"}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/pre-initializers/rich-editor-extension",["exports","@ember/string","discourse/lib/plugin-api","discourse/lib/text","discourse/plugins/discourse-calendar/discourse/components/event-node-view","discourse/plugins/discourse-calendar/discourse/initializers/discourse-post-event-decorator"],function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.EVENT_ATTRIBUTES=void 0
const r=e.EVENT_ATTRIBUTES={name:{default:null},start:{default:null},end:{default:null},location:{default:null},maxAttendees:{default:null},reminders:{default:null},minimal:{default:null},closed:{default:null},status:{default:"public"},timezone:{default:"UTC"},showLocalTime:{default:null},allowedGroups:{default:null},recurrence:{default:null},recurrenceUntil:{default:null},chatEnabled:{default:null}},a={nodeViews:{event:{component:n.default}},nodeSpec:{event:{attrs:r,group:"block",content:"block*",defining:!0,isolating:!0,parseDOM:[{tag:"div.discourse-post-event",getAttrs:e=>({...e.dataset})}],toDOM(e){const t=document.createElement("div")
t.classList.add("discourse-post-event")
for(const[s,i]of Object.entries(e.attrs))null!==i&&(t.dataset[s]=i)
return(0,o.buildEventPreview)(t),t}}},parse:{wrap_bbcode(e,s){if("div"===s.tag){if(-1===s.nesting&&"event"===e.top().type.name)return e.closeNode(),!0
if(1===s.nesting&&"discourse-post-event"===s.attrGet("class")){const i=Object.fromEntries(s.attrs.filter(([e])=>e.startsWith("data-")).map(([e,s])=>[(0,t.camelize)(e.slice(5)),s]))
return e.openNode(e.schema.nodes.event,i),!0}}return!1}},serializeNode:{event(e,t){const s=(0,i.buildBBCodeAttrs)(t.attrs)
e.write(`[event${s?` ${s}`:""}]\n`),t.content.size>0&&e.renderContent(t),e.write("[/event]\n")}},inputRules:({utils:{convertFromMarkdown:e},getContext:t})=>({match:/^\[event([^\]]*)]$/,handler:(s,i,n,o)=>{const r=t().currentUser,a=r?.user_option?.timezone||moment.tz.guess(),d=i[1].trim()
let l
if(d)l=`[event ${d}]\n[/event]`
else{l=`[event ${`start="${moment.tz(moment(),a).format("YYYY-MM-DD HH:mm")}" status="public" timezone="${a}"`}]\n[/event]`}const c=e(l)
return c.content.firstChild?s.tr.replaceWith(n,o,c.content.firstChild):null}})}
e.default={initialize(){(0,s.withPluginApi)(e=>{e.registerRichEditorExtension(a)})}}}),define("discourse/plugins/discourse-calendar/discourse/pre-initializers/transformers",["exports","discourse/lib/plugin-api"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={before:"freeze-valid-transformers",initialize(){(0,t.withPluginApi)(e=>{e.addValueTransformerName("discourse-calendar-event-more-menu-should-show-participants")})}}}),define("discourse/plugins/discourse-calendar/discourse/routes/discourse-post-event-upcoming-events",["exports","@ember/routing/route"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/routes/discourse-post-event-upcoming-events/default-index",["exports","@ember/service","moment","discourse/routes/discourse"],function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends i.default{static{dt7948.g(this.prototype,"router",[t.service])}#i=void dt7948.i(this,"router")
static{dt7948.g(this.prototype,"siteSettings",[t.service])}#n=void dt7948.i(this,"siteSettings")
beforeModel(){const e=(0,s.default)(),t=e.year(),i=e.month()+1,n=e.date()
this.router?.replaceWith?.("discourse-post-event-upcoming-events.index",this.siteSettings.calendar_upcoming_events_default_view,t,i,n)}}e.default=n}),define("discourse/plugins/discourse-calendar/discourse/routes/discourse-post-event-upcoming-events/default-mine",["exports","@ember/service","moment","discourse/routes/discourse"],function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends i.default{static{dt7948.g(this.prototype,"router",[t.service])}#i=void dt7948.i(this,"router")
beforeModel(){const e=(0,s.default)(),t=e.year(),i=e.month()+1,n=e.date()
this.router?.replaceWith?.("discourse-post-event-upcoming-events.mine","month",t,i,n)}}e.default=n}),define("discourse/plugins/discourse-calendar/discourse/routes/discourse-post-event-upcoming-events/index",["exports","@ember/service","discourse/lib/url","discourse/routes/discourse"],function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends i.default{static{dt7948.g(this.prototype,"siteSettings",[t.service])}#n=void dt7948.i(this,"siteSettings")
activate(){this.siteSettings.discourse_post_event_enabled||s.default.redirectTo("/404")}}e.default=n}),define("discourse/plugins/discourse-calendar/discourse/routes/discourse-post-event-upcoming-events/mine",["exports","@ember/service","discourse/lib/url","discourse/routes/discourse"],function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends i.default{static{dt7948.g(this.prototype,"siteSettings",[t.service])}#n=void dt7948.i(this,"siteSettings")
activate(){this.siteSettings.discourse_post_event_enabled||s.default.redirectTo("/404")}}e.default=n}),define("discourse/plugins/discourse-calendar/discourse/services/discourse-post-event-api",["exports","@ember/service","discourse/lib/ajax","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-event","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitee","discourse/plugins/discourse-calendar/discourse/models/discourse-post-event-invitees"],function(e,t,s,i,n,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{eventsPromise=null
async event(e,t={}){const s=await this.#Pe(`/events/${e}`,t)
return i.default.create(s.event)}async events(e={}){this.eventsPromise&&this.eventsPromise.abort(),this.eventsPromise=this.#Pe("/events",e)
const t=await this.eventsPromise
return this.eventsPromise=null,(t.events||[]).flatMap(e=>(e.occurrences||[]).map(t=>i.default.create({...e,starts_at:t.starts_at,ends_at:t.ends_at})))}async listEventInvitees(e,t={}){const s=await this.#Pe(`/events/${e.id}/invitees`,t)
return o.default.create(s)}async updateEvent(e,t={}){const s=await this.#Ie(`/events/${e.id}`,{event:t})
return e.updateFromEvent(s),e}async updateEventAttendance(e,t={}){if(!e.watchingInvitee)return
const s=await this.#Ie(`/events/${e.id}/invitees/${e.watchingInvitee.id}`,{invitee:t})
e.watchingInvitee=n.default.create(s.invitee),e.sampleInvitees.forEach(t=>{t.id===e.watchingInvitee.id&&(t.status=e.watchingInvitee.status)}),e.stats=s.invitee.meta.event_stats,e.shouldDisplayInvitees=s.invitee.meta.event_should_display_invitees
const i=Number(e.maxAttendees)
return!Number.isNaN(i)&&i>0&&(e.atCapacity=Number(e.stats.going)>=i),e}async leaveEvent(e,t){await this.#je(`/events/${e.id}/invitees/${t.id}`),e.sampleInvitees=e.sampleInvitees.filter(e=>e.id!==t.id),e.watchingInvitee?.id===t.id&&(e.watchingInvitee=null),"going"===t?.status&&Number(e.stats?.going)>0&&(e.stats.going=Number(e.stats.going)-1)
const s=Number(e.maxAttendees)
!Number.isNaN(s)&&s>0&&(e.atCapacity=Number(e.stats?.going)>=s)}async joinEvent(e,t={}){const s=await this.#Oe(`/events/${e.id}/invitees`,{invitee:t}),i=n.default.create(s.invitee)
t.user_id||(e.watchingInvitee=i,e.sampleInvitees.push(e.watchingInvitee)),"going"===i?.status&&(e.stats.going=Number(e.stats.going||0)+1),e.stats=s.invitee.meta.event_stats,e.shouldDisplayInvitees=s.invitee.meta.event_should_display_invitees
const o=Number(e.maxAttendees)
return!Number.isNaN(o)&&o>0&&(e.atCapacity=Number(e.stats.going)>=o),i}get#Ne(){return"/discourse-post-event"}#Pe(e,t={}){return(0,s.ajax)(`${this.#Ne}${e}`,{type:"GET",data:t})}#Ie(e,t={}){return(0,s.ajax)(`${this.#Ne}${e}`,{type:"PUT",data:t})}#Oe(e,t={}){return(0,s.ajax)(`${this.#Ne}${e}`,{type:"POST",data:t})}#je(e,t={}){return(0,s.ajax)(`${this.#Ne}${e}`,{type:"DELETE",data:t})}}e.default=r}),define("discourse/plugins/discourse-calendar/discourse/services/discourse-post-event-service",["exports","@ember/service"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{static{dt7948.g(this.prototype,"discoursePostEventApi",[t.service])}#o=void dt7948.i(this,"discoursePostEventApi")
async fetchEvents(e={}){return await this.discoursePostEventApi.events(e)}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/services/post-calendar",["exports","@ember/service"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{registerComponent(e){this.component=e}teardownComponent(){this.component=null}refresh(){this.component?.refresh?.()}}e.default=s}),define("discourse/plugins/discourse-calendar/discourse/templates/admin-plugins/show/discourse-calendar-holidays",["exports","discourse/components/conditional-loading-spinner","discourse/components/d-breadcrumbs-item","discourse/components/d-page-subheader","discourse-i18n","discourse/plugins/discourse-calendar/discourse/components/admin-holidays-list","discourse/plugins/discourse-calendar/discourse/components/region-input","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n,o,r,a,d,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,a.setComponentTemplate)((0,d.createTemplateFactory)({id:"VAzlxovX",block:'[[[8,[32,0],null,[["@path","@label"],["/admin/plugins/discourse-calendar/holidays",[28,[32,1],["discourse_calendar.holidays.header_title"],null]]],null],[1,"\\n\\n"],[10,0],[14,0,"calendar-admin-holidays admin-detail"],[12],[1,"\\n  "],[8,[32,2],null,[["@titleLabel","@descriptionLabel"],[[28,[32,1],["discourse_calendar.holidays.header_title"],null],[28,[32,1],["discourse_calendar.holidays.header_description"],null]]],null],[1,"\\n\\n  "],[8,[32,3],null,[["@value","@onChange"],[[30,1,["selectedRegion"]],[30,1,["getHolidays"]]]],null],[1,"\\n\\n  "],[8,[32,4],null,[["@condition"],[[30,1,["loading"]]]],null],[1,"\\n\\n"],[41,[30,1,["holidays"]],[[[1,"    "],[8,[32,5],null,[["@holidays","@regionCode"],[[30,1,["holidays"]],[30,1,["selectedRegion"]]]],null],[1,"\\n"]],[]],null],[13]],["@controller"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/templates/admin-plugins/show/discourse-calendar-holidays.js",scope:()=>[s.default,n.i18n,i.default,r.default,t.default,o.default],isStrictMode:!0}),(0,l.default)(void 0,"discourse-calendar-holidays"))}),define("discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.setComponentTemplate)((0,s.createTemplateFactory)({id:"Xr4lR/91",block:'[[[46,[28,[31,1],null,null],null,null,null]],[],["component","-outlet"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events.js",isStrictMode:!0}),(0,i.default)(void 0,"discourse-post-event-upcoming-events"))})
define("discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events/index",["exports","discourse/plugins/discourse-calendar/discourse/components/upcoming-events-calendar","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,s.setComponentTemplate)((0,i.createTemplateFactory)({id:"AzLwao9C",block:'[[[10,0],[14,0,"discourse-post-event-upcoming-events"],[12],[1,"\\n  "],[8,[32,0],null,[["@initialView","@initialDate"],[[30,1,["initialView"]],[30,1,["initialDate"]]]],null],[1,"\\n"],[13]],["@controller"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events/index.js",scope:()=>[t.default],isStrictMode:!0}),(0,n.default)(void 0,"discourse-post-event-upcoming-events"))}),define("discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events/mine",["exports","discourse/plugins/discourse-calendar/discourse/components/upcoming-events-calendar","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,s.setComponentTemplate)((0,i.createTemplateFactory)({id:"u9DhrZJz",block:'[[[10,0],[14,0,"discourse-post-event-upcoming-events"],[12],[1,"\\n  "],[8,[32,0],null,[["@mine","@initialView","@initialDate"],[true,[30,1,["initialView"]],[30,1,["initialDate"]]]],null],[1,"\\n"],[13]],["@controller"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-calendar/discourse/templates/discourse-post-event-upcoming-events/mine.js",scope:()=>[t.default],isStrictMode:!0}),(0,n.default)(void 0,"mine"))})

//# sourceMappingURL=discourse-calendar-99e19614.map