define("discourse/plugins/discourse-reactions/discourse/adapters/discourse-reactions-adapter",["exports","discourse/adapters/rest"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{basePath(){return"/discourse-reactions/"}}e.default=s}),define("discourse/plugins/discourse-reactions/discourse/adapters/discourse-reactions-custom-reaction",["exports","discourse/plugins/discourse-reactions/discourse/adapters/discourse-reactions-adapter"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{pathFor(e,t,s){const i=this.basePath(e,t,s)+e.pluralize(this.apiNameFor(t))
return this.appendQueryParams(i,s)}apiNameFor(){return"custom-reaction"}}e.default=s}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-button",["exports","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,s.setComponentTemplate)((0,i.createTemplateFactory)({id:"c8ka841r",block:'[[[10,0],[14,0,"discourse-reactions-actions-button-shim"],[12],[1,"\\n  "],[8,[32,0],null,[["@post","@showLogin"],[[30,1],[30,2,["showLogin"]]]],null],[1,"\\n"],[13]],["@post","@buttonActions"],[]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-button.js",scope:()=>[t.default],isStrictMode:!0}),(0,o.default)(void 0,"discourse-reactions-actions-button:ReactionsActionButton"))
e.default=n}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-summary",["exports","@glimmer/component","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions","@ember/component","@ember/template-factory"],function(e,t,s,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends t.default{static extraControls=!0
static shouldRender(e,t,s){if(s.lookup("service:site").mobileView||e.post.deleted)return!1
const i=s.lookup("service:site-settings").discourse_reactions_reaction_for_like
return!(e.post.reactions&&1===e.post.reactions.length&&e.post.reactions[0].id===i)}static{(0,i.setComponentTemplate)((0,o.createTemplateFactory)({id:"b39JKPxy",block:'[[[41,[30,1],[[[1,"  "],[10,0],[12],[1,"\\n    "],[8,[32,0],null,[["@post","@position"],[[30,2],"left"]],null],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@shouldRender","@post"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-summary.js",scope:()=>[s.default],isStrictMode:!0}),this)}}e.default=n}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/runloop","@ember/service","@floating-ui/dom","ember-curry-component","jquery","rsvp","discourse/helpers/lazy-hash","discourse/lib/environment","discourse/lib/text","discourse/modifiers/close-on-click-outside","discourse/truth-helpers","discourse-i18n","discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-counter","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-double-button","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-picker","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-button","@ember/component","@ember/template-factory"],function(e,t,s,i,o,n,r,a,c,u,l,d,p,h,m,g,f,_,b,y,v,k,x,P,S,j){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.resetCurrentReaction=function(){U=null}
let U
function w(e,t,s,i,o){if((0,m.isTesting)())return
const n=function(e){const t=document.createElement("img")
return t.src=(0,g.emojiUrlFor)(e),t.classList.add("btn-toggle-reaction-emoji","reaction-button","fake-reaction"),t}(t)
e.querySelector(".reaction-button").appendChild(n)
n.style.top=s,n.style.opacity=0,(0,d.default)(n).animate({top:i,opacity:1},{duration:350,complete:()=>{n.remove(),o()}},"swing")}function E(e,t,s,i){return(0,m.isTesting)()?(0,a.run)(this,i):(0,d.default)(e).stop().css("textIndent",t).animate({textIndent:s},{complete:i,step(e){(0,d.default)(this).css("transform",`scale(${e})`).addClass("d-icon-d-unliked").removeClass("d-icon-d-liked")},duration:150},"linear")}class C extends t.default{static{dt7948.g(this.prototype,"dialog",[c.service])}#e=void dt7948.i(this,"dialog")
static{dt7948.g(this.prototype,"capabilities",[c.service])}#t=void dt7948.i(this,"capabilities")
static{dt7948.g(this.prototype,"siteSettings",[c.service])}#s=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"site",[c.service])}#i=void dt7948.i(this,"site")
static{dt7948.g(this.prototype,"currentUser",[c.service])}#o=void dt7948.i(this,"currentUser")
static{dt7948.g(this.prototype,"appEvents",[c.service])}#n=void dt7948.i(this,"appEvents")
static{dt7948.g(this.prototype,"reactionsPickerExpanded",[s.tracked],function(){return!1})}#r=void dt7948.i(this,"reactionsPickerExpanded")
static{dt7948.g(this.prototype,"statePanelExpanded",[s.tracked],function(){return!1})}#a=void dt7948.i(this,"statePanelExpanded")
static{dt7948.g(this.prototype,"clickOutsideDisabled",[s.tracked],function(){return!1})}#c=void dt7948.i(this,"clickOutsideDisabled")
containerElement=null
get data(){return this.args.post}get classes(){if(!this.data?.reactions)return
const e=this.data.reactions.length,t=this.data.current_user_reaction,s=[]
return this.data.reactions.length&&this.data.reactions.filter(e=>e.id!==this.siteSettings.discourse_reactions_reaction_for_like).length&&s.push("custom-reaction-used"),this.data.yours&&s.push("my-post"),e&&s.push("has-reactions"),t&&s.push("has-reacted"),this.data.current_user_used_main_reaction&&s.push("has-used-main-reaction"),this.data.current_user_reaction&&!this.data.current_user_reaction.can_undo||!this.data.likeAction?.canToggle||s.push("can-toggle-reaction"),s.join(" ")}toggleReactions(e){this.reactionsPickerExpanded||(this.statePanelExpanded?this.scheduleExpand("expandReactionsPicker"):this.expandReactionsPicker(e))}static{dt7948.n(this.prototype,"toggleReactions",[n.action])}touchStart(){if(this._validTouch=!0,(0,a.cancel)(this._touchTimeout),this.capabilities.touch)return document.documentElement?.classList?.toggle("discourse-reactions-no-select",!0),this._touchStartAt=Date.now(),this._touchTimeout=(0,a.later)(()=>{this._touchStartAt=null,this.toggleReactions()},400),!1}static{dt7948.n(this.prototype,"touchStart",[n.action])}touchMove(){this._validTouch=!1,(0,a.cancel)(this._touchTimeout)}static{dt7948.n(this.prototype,"touchMove",[n.action])}touchEnd(e){if((0,a.cancel)(this._touchTimeout),this._validTouch&&this.capabilities.touch){if(e.changedTouches.length){const t=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY)
if(t){const e=t.parentNode
if(t.classList.contains("pickable-reaction"))return void t.click()
if(e&&e.classList.contains("pickable-reaction"))return void e.click()}}const t=Date.now()-(this._touchStartAt||0)
if(this._touchStartAt=null,t>400)e&&e.target&&e.target.classList.contains("discourse-reactions-reaction-button")&&this.toggleReactions(e)
else if(e.target&&(e.target.classList.contains("discourse-reactions-reaction-button")||e.target.classList.contains("reaction-button"))){const e=this.data
this.toggleFromButton({reaction:e.current_user_reaction?e.current_user_reaction.id:this.siteSettings.discourse_reactions_reaction_for_like})}}}static{dt7948.n(this.prototype,"touchEnd",[n.action])}toggle(e){if(!this.currentUser&&this.args.showLogin)return this.args.showLogin()
if(!this.data.current_user_reaction||this.data.current_user_reaction.can_undo&&this.data.likeAction?.canToggle){this.capabilities.userHasBeenActive&&this.capabilities.canVibrate&&navigator.vibrate(5)
const t=this.containerElement?.querySelector(`.discourse-reactions-picker .pickable-reaction.${CSS.escape(e.reaction)} .emoji`),s=[1,1.75]
return new p.Promise(i=>{if(t)E(t,s[0],s[1],()=>{E(t,s[1],s[0],()=>{const t=this.containerElement
if(this.data.current_user_reaction&&this.data.current_user_reaction.id===e.reaction){const s=this._captureState(this.data)
this.toggleReaction(e),(0,a.later)(()=>{var o,n
o=t,n=e.reaction,w(o,n,"8px","42px",()=>y.default.toggle(this.data,e.reaction,this.appEvents).then(i).catch(e=>{this.dialog.alert(this._extractErrors(e)),this._rollbackState(this.data,s)}))},100)}else{const n=this._captureState(this.data)
s=t,o=e.reaction,w(s,o,"-50px","8px",()=>{this.toggleReaction(e),y.default.toggle(this.data,e.reaction,this.appEvents).then(i).catch(e=>{this.dialog.alert(this._extractErrors(e)),this._rollbackState(this.data,n)})})}var s,o})})
else{const t=this._captureState(this.data)
this.toggleReaction(e),y.default.toggle(this.data,e.reaction,this.appEvents).then(i).catch(e=>{this.dialog.alert(this._extractErrors(e)),this._rollbackState(this.data,t)})}}).finally(()=>{this.collapseAllPanels()})}}static{dt7948.n(this.prototype,"toggle",[n.action])}toggleReaction(e){if(this.collapseAllPanels(),!this.data.current_user_reaction||this.data.current_user_reaction.can_undo||this.data.likeAction?.canToggle){if(this.data.current_user_reaction&&this.data.reactions.every((e,t)=>e.count<=1&&e.id===this.data.current_user_reaction.id?(this.data.reactions.splice(t,1),!1):e.id!==this.data.current_user_reaction.id||(this.data.reactions[t].count-=1,!1)),!e.reaction||this.data.current_user_reaction&&e.reaction===this.data.current_user_reaction.id)this.data.reaction_users_count-=1,this.data.current_user_reaction=null
else{let t=!1
if(this.data.reactions.every((s,i)=>s.id!==e.reaction||(this.data.reactions[i].count+=1,t=!0,!1)),!t){const t={id:e.reaction,type:"emoji",count:1},s=Object.assign([],this.data.reactions)
s.push(t)
const i=s.sort((e,t)=>e.count>t.count?-1:e.count<t.count||e.id>t.id?1:e.id<t.id?-1:void 0).indexOf(t)
this.data.reactions.splice(i,0,t)}this.data.current_user_reaction||(this.data.reaction_users_count+=1),this.data.current_user_reaction={id:e.reaction,type:"emoji",can_undo:!0}}this.data.current_user_reaction&&this.data.current_user_reaction.id===this.siteSettings.discourse_reactions_reaction_for_like?this.data.current_user_used_main_reaction=!0:this.data.current_user_used_main_reaction=!1,this.data.reactions=this.data.reactions}}toggleFromButton(e){if(!this.currentUser&&this.args.showLogin)return this.args.showLogin()
this.collapseAllPanels()
const t=this.siteSettings.discourse_reactions_reaction_for_like,s=this.data.current_user_reaction
if(this.data.likeAction&&!this.data.likeAction.canToggle&&!this.data.likeAction.can_undo)return
if(this.data.current_user_reaction&&!this.data.current_user_reaction.can_undo)return
if(!this.currentUser||this.data.user_id===this.currentUser.id)return
if(this.capabilities.userHasBeenActive&&this.capabilities.canVibrate&&navigator.vibrate(5),s&&s.id===e.reaction){const t=this._captureState(this.data)
return this.toggleReaction(e),y.default.toggle(this.data,e.reaction,this.appEvents).catch(e=>{this.dialog.alert(this._extractErrors(e)),this._rollbackState(this.data,t)})}let i
i=this.data.reactions&&1===this.data.reactions.length&&this.data.reactions[0].id===t?".discourse-reactions-double-button .discourse-reactions-reaction-button .d-icon":e.reaction&&e.reaction!==t?".discourse-reactions-reaction-button .reaction-button .btn-toggle-reaction-emoji":".discourse-reactions-reaction-button .d-icon"
const o=this.containerElement?.querySelector(i),n=[1,1.5],r=this._captureState(this.data)
return new p.Promise(s=>{E(o,n[0],n[1],()=>{E(o,n[1],n[0],()=>{this.toggleReaction(e)
let i=e.reaction&&e.reaction!==t?e.reaction:this.siteSettings.discourse_reactions_reaction_for_like
y.default.toggle(this.data,i,this.appEvents).then(s).catch(e=>{this.dialog.alert(this._extractErrors(e)),this._rollbackState(this.data,r)})})})})}static{dt7948.n(this.prototype,"toggleFromButton",[n.action])}cancelCollapse(){(0,a.cancel)(this._collapseHandler)}static{dt7948.n(this.prototype,"cancelCollapse",[n.action])}disableClickOutside(){this.clickOutsideDisabled=!0}static{dt7948.n(this.prototype,"disableClickOutside",[n.action])}enableClickOutside(){this.clickOutsideDisabled=!1}static{dt7948.n(this.prototype,"enableClickOutside",[n.action])}cancelExpand(){(0,a.cancel)(this._expandHandler)}static{dt7948.n(this.prototype,"cancelExpand",[n.action])}scheduleExpand(e){this.cancelExpand(),this._expandHandler=(0,a.later)(this,this[e],250)}scheduleCollapse(e){this.cancelCollapse(),this._collapseHandler=(0,a.later)(this,this[e],500)}static{dt7948.n(this.prototype,"scheduleCollapse",[n.action])}get elementId(){return this.data?.id?`discourse-reactions-actions-${this.data.id}-${this.args.position||"right"}`:null}clickOutside(){this.clickOutsideDisabled||(this.reactionsPickerExpanded||this.statePanelExpanded)&&this.collapseAllPanels()}static{dt7948.n(this.prototype,"clickOutside",[n.action])}expandReactionsPicker(){(0,a.cancel)(this._collapseHandler),U?.collapseAllPanels(),this.statePanelExpanded=!1,this.reactionsPickerExpanded=!0,this.updateReactionsPickerPopover()}expandStatePanel(){(0,a.cancel)(this._collapseHandler),U?.collapseAllPanels(),this.statePanelExpanded=!0,this.reactionsPickerExpanded=!1,this.updateReactionsStatePanel()}static{dt7948.n(this.prototype,"expandStatePanel",[n.action])}collapseStatePanel(){(0,a.cancel)(this._collapseHandler),this._collapseHandler=null,this.statePanelExpanded=!1}static{dt7948.n(this.prototype,"collapseStatePanel",[n.action])}collapseReactionsPicker(){(0,a.cancel)(this._collapseHandler),this._collapseHandler=null,this.reactionsPickerExpanded=!1}collapseAllPanels(){(0,a.cancel)(this._collapseHandler),document.documentElement?.classList?.toggle("discourse-reactions-no-select",!1),this._collapseHandler=null,this.statePanelExpanded=!1,this.reactionsPickerExpanded=!1}static{dt7948.n(this.prototype,"collapseAllPanels",[n.action])}updateReactionsPickerPopover(){this.showPopover(".discourse-reactions-reaction-button",".discourse-reactions-picker")}static{dt7948.n(this.prototype,"updateReactionsPickerPopover",[n.action])}updateReactionsStatePanel(){this.showPopover(".discourse-reactions-counter",".discourse-reactions-state-panel")}static{dt7948.n(this.prototype,"updateReactionsStatePanel",[n.action])}showPopover(e,t){(0,a.schedule)("afterRender",()=>{const s=this.containerElement?.querySelector(e),i=this.containerElement?.querySelector(t)
i&&((0,u.computePosition)(s,i,{placement:"top",middleware:[(0,u.offset)(-5),(0,u.shift)({limiter:(0,u.limitShift)()}),(0,u.flip)({padding:5})]}).then(({x:e,y:t})=>{Object.assign(i.style,{left:`${e}px`,top:`${t}px`})}),U=this)})}_captureState(e){return{current_user_reaction:e.current_user_reaction?{...e.current_user_reaction}:null,current_user_used_main_reaction:e.current_user_used_main_reaction,reactions:e.reactions.map(e=>({...e})),reaction_users_count:e.reaction_users_count}}_rollbackState(e,t){e.current_user_reaction=t.current_user_reaction,e.current_user_used_main_reaction=t.current_user_used_main_reaction,e.reactions=t.reactions,e.reaction_users_count=t.reaction_users_count}_extractErrors(e){const t=e.xhr||e.jqXHR
return t&&t.status?429===t.status&&t.responseJSON&&t.responseJSON.errors&&t.responseJSON.errors[0]?t.responseJSON.errors[0]:403===t.status?(0,b.i18n)("discourse_reactions.reaction.forbidden"):(0,b.i18n)("errors.desc.unknown"):(0,b.i18n)("errors.desc.network")}get onlyOneMainReaction(){return 1===this.data.reactions?.length&&this.data.reactions[0].id===this.siteSettings.discourse_reactions_reaction_for_like}get showReactionsPicker(){return this.currentUser&&this.data.user_id!==this.currentUser.id&&this.reactionsPickerExpanded}registerContainerElement(e){this.containerElement=e}static{dt7948.n(this.prototype,"registerContainerElement",[n.action])}static{(0,S.setComponentTemplate)((0,j.createTemplateFactory)({id:"GEkCcm7x",block:'[[[11,0],[16,1,[30,0,["elementId"]]],[16,0,[29,["discourse-reactions-actions ",[30,0,["classes"]]]]],[4,[32,0],["touchstart",[30,0,["touchStart"]]],null],[4,[32,0],["touchmove",[30,0,["touchMove"]]],null],[4,[32,0],["touchend",[30,0,["touchEnd"]]],null],[4,[32,1],[[30,0,["clickOutside"]]],null],[4,[32,2],[[30,0,["registerContainerElement"]]],null],[12],[1,"\\n"],[44,[[28,[32,3],null,[["counter","button"],[[28,[32,4],[[32,5],[28,[32,6],null,[["post","position","reactionsPickerExpanded","statePanelExpanded","expandStatePanel","collapseStatePanel","cancelCollapse","scheduleCollapse","updatePopover","collapseAllPanels"],[[30,0,["data"]],[30,1],[30,0,["reactionsPickerExpanded"]],[30,0,["statePanelExpanded"]],[30,0,["expandStatePanel"]],[30,0,["collapseStatePanel"]],[30,0,["cancelCollapse"]],[30,0,["scheduleCollapse"]],[30,0,["updateReactionsStatePanel"]],[30,0,["collapseAllPanels"]]]]]],null],[28,[32,4],[[32,7],[28,[32,6],null,[["post","position","cancelCollapse","toggleFromButton","toggleReactions","cancelExpand","scheduleCollapse"],[[30,0,["data"]],[30,1],[30,0,["cancelCollapse"]],[30,0,["toggleFromButton"]],[30,0,["toggleReactions"]],[30,0,["cancelExpand"]],[30,0,["scheduleCollapse"]]]]]],null]]]]],[[[41,[30,0,["showReactionsPicker"]],[[[1,"      "],[8,[32,8],null,[["@post","@scheduleCollapse","@cancelCollapse","@disableClickOutside","@enableClickOutside","@reactionsPickerExpanded","@toggle"],[[30,0,["data"]],[30,0,["scheduleCollapse"]],[30,0,["cancelCollapse"]],[30,0,["disableClickOutside"]],[30,0,["enableClickOutside"]],[30,0,["reactionsPickerExpanded"]],[30,0,["toggle"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[32,9],[[30,1],"left"],null],[[[1,"      "],[8,[30,2,["counter"]],null,null,null],[1,"\\n"]],[]],[[[41,[30,0,["onlyOneMainReaction"]],[[[1,"      "],[8,[32,10],null,[["@post","@counterComponent","@buttonComponent"],[[30,0,["data"]],[30,2,["counter"]],[30,2,["button"]]]],null],[1,"\\n"]],[]],[[[41,[30,0,["site","mobileView"]],[[[41,[28,[32,11],[[30,0,["data","yours"]]],null],[[[1,"        "],[8,[30,2,["counter"]],null,null,null],[1,"\\n        "],[8,[30,2,["button"]],null,null,null],[1,"\\n"]],[]],[[[41,[28,[32,12],[[30,0,["data","yours"]],[30,0,["data","reactions"]],[30,0,["data","reactions","length"]]],null],[[[1,"        "],[8,[30,2,["counter"]],null,null,null],[1,"\\n      "]],[]],null]],[]]]],[]],[[[41,[28,[32,11],[[30,0,["data","yours"]]],null],[[[1,"      "],[8,[30,2,["button"]],null,null,null],[1,"\\n    "]],[]],null]],[]]]],[]]]],[]]]],[2]]],[13]],["@position","components"],["let","if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions.js",scope:()=>[o.on,f.default,r.default,i.hash,l.default,v.default,h.default,P.default,x.default,_.eq,k.default,_.not,_.and],isStrictMode:!0}),this)}}e.default=C}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-counter",["exports","@glimmer/component","@ember/modifier","@ember/object","@ember/service","@ember-compat/tracked-built-ins","discourse/components/d-button","discourse/lib/array-tools","discourse/lib/decorators","discourse/modifiers/close-on-click-outside","discourse/truth-helpers","discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel","@ember/component","@ember/template-factory"],function(e,t,s,i,o,n,r,a,c,u,l,d,p,h,m,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class f extends t.default{static{dt7948.g(this.prototype,"capabilities",[o.service])}#t=void dt7948.i(this,"capabilities")
static{dt7948.g(this.prototype,"site",[o.service])}#i=void dt7948.i(this,"site")
static{dt7948.g(this.prototype,"siteSettings",[o.service])}#s=void dt7948.i(this,"siteSettings")
reactionsUsers=new n.TrackedObject
get elementId(){return`discourse-reactions-counter-${this.args.post.id}-${this.args.position||"right"}`}reactionsChanged(e){(0,a.uniqueItemsFromArray)(e.reactions).forEach(e=>{this.getUsers(e)})}async getUsers(e){(await d.default.findReactionUsers(this.args.post.id,{reactionValue:e})).reaction_users.forEach(e=>{this.reactionsUsers[e.id]=e.users}),this.args.updatePopover()}static{dt7948.n(this.prototype,"getUsers",[c.bind])}mouseDown(e){e.stopImmediatePropagation()}static{dt7948.n(this.prototype,"mouseDown",[i.action])}mouseUp(e){e.stopImmediatePropagation()}static{dt7948.n(this.prototype,"mouseUp",[i.action])}click(e){e.target.closest("[data-user-card]")||(this.args.cancelCollapse(),this.capabilities.touch&&!this.site.desktopView||(e.stopPropagation(),e.preventDefault(),this.args.statePanelExpanded||this.getUsers(),this.toggleStatePanel(e)))}static{dt7948.n(this.prototype,"click",[i.action])}clickOutside(){this.args.statePanelExpanded&&this.args.collapseAllPanels()}static{dt7948.n(this.prototype,"clickOutside",[i.action])}touchStart(e){return this.args.cancelCollapse(),!(!e.target.classList.contains("show-users")&&!e.target.classList.contains("avatar"))||(this.args.statePanelExpanded?(e.stopPropagation(),void e.preventDefault()):void(this.capabilities.touch&&(e.stopPropagation(),e.preventDefault(),this.getUsers(),this.toggleStatePanel(e))))}static{dt7948.n(this.prototype,"touchStart",[i.action])}get classes(){const e=[],t=this.siteSettings.discourse_reactions_reaction_for_like,{post:s}=this.args
return s.reactions&&1===s.reactions.length&&s.reactions[0].id===t&&e.push("only-like"),s.reaction_users_count>0&&e.push("discourse-reactions-counter"),e.join(" ")}toggleStatePanel(){this.args.statePanelExpanded?this.args.collapseStatePanel():this.args.expandStatePanel()}pointerOver(e){"mouse"===e.pointerType&&this.args.cancelCollapse()}static{dt7948.n(this.prototype,"pointerOver",[i.action])}pointerOut(e){"mouse"===e.pointerType&&(e.relatedTarget?.closest(`#${this.elementId}`)||this.args.scheduleCollapse("collapseStatePanel"))}static{dt7948.n(this.prototype,"pointerOut",[i.action])}get onlyOneMainReaction(){return 1===this.args.post.reactions?.length&&this.args.post.reactions[0].id===this.siteSettings.discourse_reactions_reaction_for_like}static{(0,m.setComponentTemplate)((0,g.createTemplateFactory)({id:"yzgXtRQ6",block:'[[[11,0],[16,1,[30,0,["elementId"]]],[16,0,[30,0,["classes"]]],[4,[32,0],["mousedown",[30,0,["mouseDown"]]],null],[4,[32,0],["mouseup",[30,0,["mouseUp"]]],null],[4,[32,1],[[30,0,["clickOutside"]]],null],[4,[32,0],["touchstart",[30,0,["touchStart"]]],null],[4,[32,0],["pointerover",[30,0,["pointerOver"]]],null],[4,[32,0],["pointerout",[30,0,["pointerOut"]]],null],[4,[32,0],["click",[30,0,["click"]]],null],[12],[1,"\\n"],[41,[30,1,["reaction_users_count"]],[[[1,"    "],[8,[32,2],null,[["@post","@reactionsUsers","@statePanelExpanded","@scheduleCollapse","@cancelCollapse"],[[30,1],[30,0,["reactionsUsers"]],[30,2],[30,3],[30,4]]],null],[1,"\\n\\n"],[41,[51,[30,0,["onlyOneMainReaction"]]],[[[1,"      "],[8,[32,3],[[4,[32,0],["click",[30,0,["click"]]],null]],[["@post","@reactionsUsers","@getUsers"],[[30,1],[30,0,["reactionsUsers"]],[30,0,["getUsers"]]]],null],[1,"\\n"]],[]],null],[1,"\\n    "],[10,1],[14,0,"reactions-counter"],[12],[1,"\\n      "],[1,[30,1,["reaction_users_count"]]],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[28,[32,4],[[30,1,["yours"]],[30,0,["onlyOneMainReaction"]]],null],[[[1,"      "],[10,0],[14,0,"discourse-reactions-reaction-button my-likes"],[12],[1,"\\n        "],[8,[32,5],[[24,0,"btn-toggle-reaction-like btn-flat btn-icon no-text reaction-button"]],[["@icon"],[[30,0,["siteSettings","discourse_reactions_like_icon"]]]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null]],[]],null],[13]],["@post","@statePanelExpanded","@scheduleCollapse","@cancelCollapse"],["if","unless"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-counter.js",scope:()=>[s.on,u.default,h.default,p.default,l.and,r.default],isStrictMode:!0}),this)}}e.default=f}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-double-button",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,t.setComponentTemplate)((0,s.createTemplateFactory)({id:"yp8zvuuz",block:'[[[10,0],[14,0,"discourse-reactions-double-button"],[12],[1,"\\n"],[41,[30,1,["reaction_users_count"]],[[[1,"    "],[8,[30,2],null,null,null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[51,[30,1,["yours"]]],[[[1,"    "],[8,[30,3],null,null,null],[1,"\\n"]],[]],null],[13]],["@post","@counterComponent","@buttonComponent"],["if","unless"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-double-button.js",isStrictMode:!0}),(0,i.default)(void 0,"discourse-reactions-double-button:DiscourseReactionsDoubleButton"))
e.default=o}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list-emoji",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","@ember/runloop","@ember/service","@floating-ui/dom","discourse/helpers/emoji","discourse/lib/decorators","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,i,o,n,r,a,c,u,l,d,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static{dt7948.g(this.prototype,"siteSettings",[r.service])}#s=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"loadingReactions",[s.tracked],function(){return!1})}#u=void dt7948.i(this,"loadingReactions")
get elementId(){return`discourse-reactions-list-emoji-${this.args.post.id}-${this.args.reaction.id}`}pointerOver(e){"mouse"===e.pointerType&&this.args.reaction.count&&(this.showTooltip(),this.args.users?.length||this.loadingReactions||(0,n.debounce)(this,this._loadReactionUsers,3e3,!0))}static{dt7948.n(this.prototype,"pointerOver",[o.action])}showTooltip(){const e=document.getElementById(this.elementId),t=e.querySelector(".user-list");(0,a.computePosition)(e,t,{placement:"bottom",middleware:[(0,a.offset)(-5),(0,a.shift)({limiter:(0,a.limitShift)()}),(0,a.flip)({padding:5})]}).then(({x:e,y:s})=>{Object.assign(t.style,{left:`${e}px`,top:`${s}px`})})}_loadReactionUsers(){this.loadingReactions=!0,this.args.getUsers(this.args.reaction.id).finally(()=>{this.loadingReactions=!1})}get truncatedUsers(){return this.args.users?.slice(0,19)}displayNameForUser(e){return!this.siteSettings.prioritize_username_in_ux&&this.siteSettings.prioritize_full_name_in_ux?e.name||e.username:this.siteSettings.prioritize_username_in_ux?e.username:e.name?e.name:e.username}static{dt7948.n(this.prototype,"displayNameForUser",[u.bind])}get hiddenUserCount(){return this.args.users?.length-this.truncatedUsers?.length}static{(0,d.setComponentTemplate)((0,p.createTemplateFactory)({id:"K9hqVdOE",block:'[[[11,0],[24,0,"discourse-reactions-list-emoji"],[16,1,[30,0,["elementId"]]],[4,[32,0],["pointerover",[30,0,["pointerOver"]]],null],[12],[1,"\\n"],[41,[30,1,["count"]],[[[1,"    "],[1,[28,[32,1],[[30,1,["id"]]],[["skipTitle","class"],[true,[52,[30,0,["siteSettings","discourse_reactions_desaturated_reaction_panel"]],"desaturated",""]]]]],[1,"\\n\\n    "],[10,0],[14,0,"user-list"],[12],[1,"\\n      "],[10,0],[14,0,"container"],[12],[1,"\\n        "],[10,1],[14,0,"heading"],[12],[1,[30,1,["id"]]],[13],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["truncatedUsers"]]],null]],null],null,[[[1,"          "],[10,1],[14,0,"username"],[12],[1,[28,[30,0,["displayNameForUser"]],[[30,2]],null]],[13],[1,"\\n"]],[2]],[[[1,"          "],[10,0],[14,0,"center"],[12],[10,0],[14,0,"spinner small"],[12],[13],[13],[1,"\\n"]],[]]],[41,[30,0,["hiddenUserCount"]],[[[1,"          "],[10,1],[14,0,"other-users"],[12],[1,"\\n            "],[1,[28,[32,2],["discourse_reactions.state_panel.more_users"],[["count"],[[30,0,["hiddenUserCount"]]]]]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[13]],["@reaction","user"],["if","each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list-emoji.js",scope:()=>[i.on,c.default,l.i18n],isStrictMode:!0}),this)}}e.default=h}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list",["exports","@ember/helper","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list-emoji","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,o,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,i.setComponentTemplate)((0,o.createTemplateFactory)({id:"E520DtPH",block:'[[[11,0],[24,0,"discourse-reactions-list"],[17,1],[12],[1,"\\n"],[41,[30,2,["reaction_users_count"]],[[[1,"    "],[10,0],[14,0,"reactions"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,2,["reactions"]]],null]],null],null,[[[1,"        "],[8,[32,0],null,[["@reaction","@users","@post","@getUsers"],[[30,3],[28,[32,1],[[30,4],[30,3,["id"]]],null],[30,2],[30,5]]],null],[1,"\\n"]],[3]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[13]],["&attrs","@post","reaction","@reactionsUsers","@getUsers"],["if","each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list.js",scope:()=>[s.default,t.get],isStrictMode:!0}),(0,n.default)(void 0,"discourse-reactions-list:DiscourseReactionsList"))
e.default=r}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-picker",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/service","discourse/components/d-button","discourse/components/emoji-picker","discourse/helpers/concat-class","discourse/helpers/emoji","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,i,o,n,r,a,c,u,l,d,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static{dt7948.g(this.prototype,"siteSettings",[n.service])}#s=void dt7948.i(this,"siteSettings")
emojiPickerIsOpen=!1
pointerOut(e){"mouse"!==e.pointerType||this.emojiPickerIsOpen||this.args.scheduleCollapse("collapseReactionsPicker")}static{dt7948.n(this.prototype,"pointerOut",[o.action])}pointerOver(e){"mouse"===e.pointerType&&this.args.cancelCollapse()}static{dt7948.n(this.prototype,"pointerOver",[o.action])}get reactionInfo(){const e=this.siteSettings.discourse_reactions_enabled_reactions.split("|").filter(Boolean)
e.includes(this.siteSettings.discourse_reactions_reaction_for_like)||e.unshift(this.siteSettings.discourse_reactions_reaction_for_like)
const{post:t}=this.args,s=t.current_user_reaction
return e.map(e=>{let i,o,n,r
return i=e===this.siteSettings.discourse_reactions_reaction_for_like?t.current_user_used_main_reaction:s&&s.id===e,o=s?s.can_undo&&t.likeAction.canToggle:t.likeAction.canToggle,o?(n="discourse_reactions.picker.react_with",r={reaction:e}):n="discourse_reactions.picker.cant_remove_reaction",{id:e,title:(0,l.i18n)(n,r),canUndo:o,isUsed:i}})}get optimalColsCount(){let e,t=this.reactionInfo.length
this.siteSettings.discourse_reactions_allow_any_emoji&&(t+=1)
const s=[5,6,7,8]
if(t<s[0])return t
for(let i=0;i<s.length;++i){const o=s[i]
let n=t%o
if(0===n){e=o
break}(0===i||n>t%(o-1))&&(e=o)}return e}onSelectEmoji(e){this.args.toggle({reaction:e,postId:this.args.post.id,canUndo:!0})}static{dt7948.n(this.prototype,"onSelectEmoji",[o.action])}preventCollapse(){this.emojiPickerIsOpen=!0,this.args.cancelCollapse?.(),this.args.disableClickOutside?.()}static{dt7948.n(this.prototype,"preventCollapse",[o.action])}reenableCollapse(){this.emojiPickerIsOpen=!1,this.args.enableClickOutside?.()}static{dt7948.n(this.prototype,"reenableCollapse",[o.action])}static{(0,d.setComponentTemplate)((0,p.createTemplateFactory)({id:"ALCppbw5",block:'[[[11,0],[16,0,[28,[32,0],["discourse-reactions-picker",[52,[30,1],"is-expanded"]],null]],[4,[32,1],["pointerover",[30,0,["pointerOver"]]],null],[4,[32,1],["pointerout",[30,0,["pointerOut"]]],null],[12],[1,"\\n"],[41,[30,1],[[[1,"    "],[10,0],[15,0,[29,["discourse-reactions-picker-container col-",[30,0,["optimalColsCount"]]]]],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["reactionInfo"]]],null]],null],null,[[[1,"        "],[8,[32,2],[[16,0,[28,[32,0],["btn-flat","pickable-reaction",[30,2,["id"]],[52,[30,2,["canUndo"]],"can-undo"],[52,[30,2,["isUsed"]],"is-used"]],null]],[16,"data-reaction",[30,2,["id"]]]],[["@action","@translatedTitle"],[[28,[32,3],[[30,3],[28,[32,4],null,[["reaction","postId","canUndo"],[[30,2,["id"]],[30,4,["id"]],[30,2,["canUndo"]]]]]],null],[30,2,["title"]]]],[["default"],[[[[1,"\\n          "],[1,[28,[32,5],[[30,2,["id"]]],null]],[1,"\\n        "]],[]]]]],[1,"\\n"]],[2]],null],[41,[30,0,["siteSettings","discourse_reactions_allow_any_emoji"]],[[[1,"        "],[8,[32,6],[[17,5]],[["@icon","@context","@didSelectEmoji","@onShow","@onClose","@btnClass"],["far-face-smile","discourse-reactions",[30,0,["onSelectEmoji"]],[30,0,["preventCollapse"]],[30,0,["reenableCollapse"]],"btn-icon btn-flat"]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[13]],["@reactionsPickerExpanded","reaction","@toggle","@post","&attrs"],["if","each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-picker.js",scope:()=>[c.default,i.on,r.default,s.fn,s.hash,u.default,a.default],isStrictMode:!0}),this)}}e.default=h}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-button",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/service","@ember/utils","discourse/components/d-button","discourse/lib/text","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,i,o,n,r,a,c,u,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static{dt7948.g(this.prototype,"capabilities",[n.service])}#t=void dt7948.i(this,"capabilities")
static{dt7948.g(this.prototype,"siteSettings",[n.service])}#s=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"site",[n.service])}#i=void dt7948.i(this,"site")
static{dt7948.g(this.prototype,"currentUser",[n.service])}#o=void dt7948.i(this,"currentUser")
click(){this.args.cancelCollapse()
const e=this.args.post.current_user_reaction
this.capabilities.touch&&!this.site.desktopView||this.args.toggleFromButton({reaction:e?e.id:this.siteSettings.discourse_reactions_reaction_for_like})}static{dt7948.n(this.prototype,"click",[o.action])}pointerOver(e){if("mouse"!==e.pointerType)return
this.args.cancelCollapse()
const t=this.args.post.likeAction,s=this.args.post.current_user_reaction;(!s||s.can_undo||t&&!(0,r.isBlank)(t.can_undo))&&this.args.toggleReactions(e)}static{dt7948.n(this.prototype,"pointerOver",[o.action])}pointerOut(e){"mouse"===e.pointerType&&(this.args.cancelExpand(),this.args.scheduleCollapse("collapseReactionsPicker"))}static{dt7948.n(this.prototype,"pointerOut",[o.action])}get likedIcon(){const e=this.siteSettings.discourse_reactions_like_icon
return"heart"===e?"d-liked":e}get unlikedIcon(){const e=this.siteSettings.discourse_reactions_like_icon
return"heart"===e?"d-unliked":`far-${e}`}get title(){if(!this.currentUser)return(0,u.i18n)("discourse_reactions.main_reaction.unauthenticated")
const e=this.args.post.likeAction
if(!e)return null
let t,s
const i=this.args.post.current_user_reaction
return e.canToggle&&(0,r.isBlank)(e.can_undo)&&(t="discourse_reactions.main_reaction.add"),e.canToggle&&e.can_undo&&(t="discourse_reactions.main_reaction.remove"),e.canToggle||(t="discourse_reactions.main_reaction.cant_remove"),i&&i.can_undo&&(0,r.isBlank)(e.can_undo)&&(t="discourse_reactions.picker.remove_reaction",s={reaction:i.id}),i&&!i.can_undo&&(0,r.isBlank)(e.can_undo)&&(t="discourse_reactions.picker.cant_remove_reaction"),s?(0,u.i18n)(t,s):(0,u.i18n)(t)}static{(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"4A+yZzbR",block:'[[[11,0],[24,0,"discourse-reactions-reaction-button"],[16,"title",[30,0,["title"]]],[4,[32,0],["click",[30,0,["click"]]],null],[4,[32,0],["pointerover",[30,0,["pointerOver"]]],null],[4,[32,0],["pointerout",[30,0,["pointerOut"]]],null],[12],[1,"\\n"],[41,[30,1,["current_user_used_main_reaction"]],[[[1,"    "],[8,[32,1],[[24,0,"btn-toggle-reaction-like btn-flat btn-icon no-text reaction-button"]],[["@translatedTitle","@icon"],[[30,0,["title"]],[30,0,["likedIcon"]]]],null],[1,"\\n"]],[]],[[[41,[30,1,["current_user_reaction"]],[[[1,"    "],[8,[32,1],[[24,0,"btn-icon no-text btn-flat reaction-button"]],[["@translatedTitle"],[[30,0,["title"]]]],[["default"],[[[[1,"\\n      "],[10,"img"],[14,0,"btn-toggle-reaction-emoji reaction-button"],[15,"src",[28,[32,2],[[30,1,["current_user_reaction","id"]]],null]],[15,"alt",[28,[32,3],[":",[30,1,["current_user_reaction","id"]]],null]],[12],[13],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[1,"    "],[8,[32,1],[[24,0,"btn-toggle-reaction-like btn-flat btn-icon no-text reaction-button"]],[["@translatedTitle","@icon"],[[30,0,["title"]],[30,0,["unlikedIcon"]]]],null],[1,"\\n  "]],[]]]],[]]],[13]],["@post"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-button.js",scope:()=>[i.on,a.default,c.emojiUrlFor,s.concat],isStrictMode:!0}),this)}}e.default=p}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-emoji",["exports","@glimmer/component","discourse/helpers/avatar","discourse/lib/text","@ember/component","@ember/template-factory"],function(e,t,s,i,o,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{get emojiUrl(){const e=this.args.reaction.reaction?.reaction_value
return e?(0,i.emojiUrlFor)(e):null}static{(0,o.setComponentTemplate)((0,n.createTemplateFactory)({id:"lmNsCc8h",block:'[[[41,[30,1,["reaction","reaction_users_count"]],[[[1,"  "],[10,0],[14,0,"discourse-reactions-my-reaction"],[12],[1,"\\n    "],[10,"img"],[15,"src",[30,0,["emojiUrl"]]],[14,0,"reaction-emoji"],[12],[13],[1,"\\n    "],[10,3],[15,6,[30,1,["user","userUrl"]]],[15,"data-user-card",[30,1,["user","username"]]],[14,0,"avatar-link"],[12],[1,"\\n      "],[1,[28,[32,0],[[30,1,["user"]]],[["imageSize","extraClasses","ignoreTitle"],["tiny","actor","true"]]]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],["@reaction"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-emoji.js",scope:()=>[s.default],isStrictMode:!0}),this)}}e.default=r}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel-reaction",["exports","@glimmer/component","@ember/modifier","@ember/object","discourse/components/user-avatar","discourse/helpers/concat-class","discourse/helpers/d-icon","discourse/helpers/emoji","discourse/truth-helpers","discourse-i18n","@ember/component","@ember/template-factory"],function(e,t,s,i,o,n,r,a,c,u,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{click(e){e?.target?.classList?.contains("show-users")&&(e.preventDefault(),e.stopPropagation(),this.args.showUsers(this.args.reaction.id))}static{dt7948.n(this.prototype,"click",[i.action])}get firstLineUsers(){return this.args.users.slice(0,8)}get otherUsers(){return this.args.users.slice(8,26)}get columnsCount(){return this.args.users.length>8?this.firstLineUsers.length+1:this.firstLineUsers.length}get moreLabel(){if(this.args.isDisplayed&&this.args.reaction.count>26)return(0,u.i18n)("discourse_reactions.state_panel.more_users",{count:this.args.reaction.count-26})}static{(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"A5oAMUpC",block:'[[[11,0],[16,0,[28,[32,0],["discourse-reactions-state-panel-reaction",[52,[30,1],"is-displayed"]],null]],[4,[32,1],["click",[30,0,["click"]]],null],[12],[1,"\\n"],[41,[30,2],[[[1,"    "],[10,0],[14,0,"reaction-wrapper"],[12],[1,"\\n      "],[10,0],[14,0,"emoji-wrapper"],[12],[1,"\\n        "],[1,[28,[32,2],[[30,3,["id"]]],null]],[1,"\\n      "],[13],[1,"\\n      "],[10,0],[14,0,"count"],[12],[1,"\\n        "],[1,[30,3,["count"]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"users"],[12],[1,"\\n      "],[10,0],[15,0,[29,["list list-columns-",[30,0,["columnsCount"]]]]],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["firstLineUsers"]]],null]],null],"username",[[[1,"          "],[10,1],[12],[1,"\\n            "],[8,[32,3],[[24,0,"trigger-user-card"]],[["@size","@user"],["tiny",[30,4]]],null],[1,"\\n          "],[13],[1,"\\n"]],[4]],null],[1,"\\n"],[41,[28,[32,4],[[30,2,["length"]],[32,5]],null],[[[1,"          "],[10,"button"],[14,0,"show-users"],[14,4,"button"],[12],[1,"\\n            "],[1,[28,[32,6],[[52,[30,1],"chevron-up","chevron-down"]],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,1],[[[42,[28,[31,2],[[28,[31,2],[[30,0,["otherUsers"]]],null]],null],"username",[[[1,"            "],[10,1],[12],[1,"\\n              "],[8,[32,3],[[24,0,"trigger-user-card"]],[["@size","@user"],["tiny",[30,5]]],null],[1,"\\n            "],[13],[1,"\\n"]],[5]],null]],[]],null],[1,"      "],[13],[1,"\\n      "],[10,1],[14,0,"more"],[12],[1,"\\n        "],[1,[30,0,["moreLabel"]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[13]],["@isDisplayed","@users","@reaction","user","user"],["if","each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel-reaction.js",scope:()=>[n.default,s.on,a.default,o.default,c.gt,8,r.default],isStrictMode:!0}),this)}}e.default=p}),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","discourse/helpers/concat-class","discourse/truth-helpers","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel-reaction","@ember/component","@ember/template-factory"],function(e,t,s,i,o,n,r,a,c,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static{dt7948.g(this.prototype,"displayedReactionId",[s.tracked])}#l=void dt7948.i(this,"displayedReactionId")
get classes(){const e=[],{post:t}=this.args
if(t?.reactions){const s=Math.max(...t.reactions.map(e=>e.count)).toString().length
e.push(`max-length-${s}`)}return this.args.statePanelExpanded&&e.push("is-expanded"),e}pointerOut(e){"mouse"===e.pointerType&&this.args.scheduleCollapse("collapseStatePanel")}static{dt7948.n(this.prototype,"pointerOut",[o.action])}pointerOver(e){"mouse"===e.pointerType&&this.args.cancelCollapse()}static{dt7948.n(this.prototype,"pointerOver",[o.action])}showUsers(e){this.displayedReactionId?this.displayedReactionId===e?this.hideUsers():this.displayedReactionId!==e&&(this.displayedReactionId=e):this.displayedReactionId=e}static{dt7948.n(this.prototype,"showUsers",[o.action])}hideUsers(){this.displayedReactionId=null}static{dt7948.n(this.prototype,"hideUsers",[o.action])}get hasReactionData(){return!!Object.keys(this.args.reactionsUsers).length}static{(0,c.setComponentTemplate)((0,u.createTemplateFactory)({id:"IotQic5R",block:'[[[11,0],[16,0,[28,[32,0],["discourse-reactions-state-panel",[30,0,["classes"]]],null]],[4,[32,1],["pointerout",[30,0,["pointerOut"]]],null],[4,[32,1],["pointerover",[30,0,["pointerOver"]]],null],[12],[1,"\\n"],[41,[28,[32,2],[[30,1],[30,2,["reactions","length"]]],null],[[[1,"    "],[10,0],[14,0,"container"],[12],[1,"\\n"],[41,[30,0,["hasReactionData"]],[[[1,"        "],[10,0],[14,0,"counters"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,2,["reactions"]]],null]],null],"id",[[[1,"            "],[8,[32,3],null,[["@reaction","@users","@post","@isDisplayed","@showUsers"],[[30,3],[28,[32,4],[[30,4],[30,3,["id"]]],null],[30,2],[28,[32,5],[[30,3,["id"]],[30,0,["displayedReactionId"]]],null],[30,0,["showUsers"]]]],null],[1,"\\n"]],[3]],null],[1,"        "],[13],[1,"\\n"]],[]],[[[1,"        "],[10,0],[14,0,"spinner-container"],[12],[1,"\\n          "],[10,0],[14,0,"spinner small"],[12],[13],[1,"\\n        "],[13],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n"]],[]],null],[13]],["@statePanelExpanded","@post","reaction","@reactionsUsers"],["if","each","-track-array"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel.js",scope:()=>[n.default,i.on,r.and,a.default,o.get,r.eq],isStrictMode:!0}),this)}}e.default=l}),define("discourse/plugins/discourse-reactions/discourse/connectors/user-activity-bottom/discourse-reactions-user-activity-reactions",["exports","@ember/component","@ember/routing","@ember-decorators/component","discourse/helpers/d-icon","discourse-i18n","@ember/template-factory"],function(e,t,s,i,o,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=dt7948.c(class extends t.default{static{(0,t.setComponentTemplate)((0,r.createTemplateFactory)({id:"crdipYUF",block:'[[[11,"li"],[24,0,"user-activity-bottom-outlet discourse-reactions-user-activity-reactions"],[17,1],[12],[1,"\\n"],[41,[30,0,["siteSettings","discourse_reactions_enabled"]],[[[1,"    "],[8,[32,0],null,[["@route"],["userActivity.reactions"]],[["default"],[[[[1,"\\n      "],[1,[28,[32,1],["far-face-smile"],null]],[1,"\\n      "],[10,1],[12],[1,[28,[32,2],["discourse_reactions.reactions_title"],null]],[13],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],null],[13]],["&attrs"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/connectors/user-activity-bottom/discourse-reactions-user-activity-reactions.js",scope:()=>[s.LinkTo,o.default,n.i18n],isStrictMode:!0}),this)}},[(0,i.tagName)("")])
e.default=a}),define("discourse/plugins/discourse-reactions/discourse/connectors/user-notifications-bottom/discourse-reactions-user-notification-reactions",["exports","@ember/component","@ember/routing","@ember-decorators/component","discourse/helpers/d-icon","discourse-i18n","@ember/template-factory"],function(e,t,s,i,o,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=dt7948.c(class extends t.default{static{(0,t.setComponentTemplate)((0,r.createTemplateFactory)({id:"HMW2bdIj",block:'[[[11,"li"],[24,0,"user-notifications-bottom-outlet discourse-reactions-user-notification-reactions"],[17,1],[12],[1,"\\n"],[41,[30,0,["siteSettings","discourse_reactions_enabled"]],[[[1,"    "],[8,[32,0],null,[["@route"],["userNotifications.reactionsReceived"]],[["default"],[[[[1,"\\n      "],[1,[28,[32,1],["far-face-smile"],null]],[1,"\\n      "],[10,1],[12],[1,[28,[32,2],["discourse_reactions.reactions_title"],null]],[13],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],null],[13]],["&attrs"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/connectors/user-notifications-bottom/discourse-reactions-user-notification-reactions.js",scope:()=>[s.LinkTo,o.default,n.i18n],isStrictMode:!0}),this)}},[(0,i.tagName)("")])
e.default=a}),define("discourse/plugins/discourse-reactions/discourse/controllers/user-activity/reactions",["exports","@glimmer/tracking","@ember/controller","@ember/object","@ember/service","discourse/lib/array-tools","discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction"],function(e,t,s,i,o,n,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static{dt7948.g(this.prototype,"siteSettings",[o.service])}#s=void dt7948.i(this,"siteSettings")
static{dt7948.g(this.prototype,"canLoadMore",[t.tracked],function(){return!0})}#d=void dt7948.i(this,"canLoadMore")
static{dt7948.g(this.prototype,"loading",[t.tracked],function(){return!1})}#p=void dt7948.i(this,"loading")
static{dt7948.g(this.prototype,"beforeLikeId",[t.tracked],function(){return null})}#h=void dt7948.i(this,"beforeLikeId")
static{dt7948.g(this.prototype,"beforeReactionUserId",[t.tracked],function(){return null})}#m=void dt7948.i(this,"beforeReactionUserId")
#g(e){return e.length?e[e.length-1].reaction_user_id:null}#f(e){if(this.includeLikes){const t=this.siteSettings.discourse_reactions_reaction_for_like,[s,i]=e.reduce((e,s)=>(s.reaction.reaction_value===t?e[0].push(s):e[1].push(s),e),[[],[]])
this.beforeLikeId=this.#g(s),this.beforeReactionUserId=this.#g(i)}else this.beforeReactionUserId=this.#g(e)}async loadMore(){if(!this.canLoadMore||this.loading)return[]
this.loading=!0
const e=this.model
try{this.beforeReactionUserId||this.#f(e)
const t={actingUsername:this.actingUsername,includeLikes:this.includeLikes,beforeLikeId:this.beforeLikeId,beforeReactionUserId:this.beforeReactionUserId},s=(await r.default.findReactions(this.reactionsUrl,this.username,t)).map(e=>r.default.flattenForPostList(e))
return(0,n.addUniqueValuesToArray)(e,s),this.#f(s),0===s.length&&(this.canLoadMore=!1),s}finally{this.loading=!1}}static{dt7948.n(this.prototype,"loadMore",[i.action])}}e.default=a}),define("discourse/plugins/discourse-reactions/discourse/discourse-reactions-user-activity-route-map",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"user.userActivity",map(){this.route("reactions")}}}),define("discourse/plugins/discourse-reactions/discourse/discourse-reactions-user-notifications-route-map",["exports"],function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"user.userNotifications",map(){this.route("reactionsReceived",{path:"reactions-received"})}}}),define("discourse/plugins/discourse-reactions/discourse/initializers/discourse-reactions",["exports","@glimmer/tracking","@ember/service","discourse/lib/icon-library","discourse/lib/plugin-api","discourse/lib/text","discourse/lib/url","discourse/lib/utilities","discourse-i18n","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-button","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-summary"],function(e,t,s,i,o,n,r,a,c,u,l,d){"use strict"
function p(e){(function(e){e.registerValueTransformer("post-menu-buttons",({value:e,context:{buttonKeys:t}})=>{e.replace(t.LIKE,l.default),e.add("discourse-reactions-actions",d.default,{after:t.REPLIES})})})(e),e.addKeyboardShortcut("l",null,{click:".topic-post.selected .discourse-reactions-reaction-button"}),e.addTrackedPostProperties("current_user_used_main_reaction","reaction_users_count","current_user_reaction","reactions"),e.modifyClass("component:emoji-value-list",e=>class extends e{static{dt7948.g(this.prototype,"siteSettings",[s.service])}#s=void dt7948.i(this,"siteSettings")
get collection(){const e=super.collection
if("discourse_reactions_enabled_reactions"===this.args.setting.setting){if(this.args.values.includes(this.siteSettings.discourse_reactions_reaction_for_like)){const t=e.find(e=>e.value===this.siteSettings.discourse_reactions_reaction_for_like)
t&&(t.isEditable=!1)}else e.unshift({emojiUrl:(0,n.emojiUrlFor)(this.siteSettings.discourse_reactions_reaction_for_like),isEditable:!1,isEditing:!1,value:this.siteSettings.discourse_reactions_reaction_for_like})}return e}static{dt7948.n(this.prototype,"collection",[t.cached])}},{ignoreMissing:!0}),e.replaceIcon("notification.reaction","discourse-emojis"),e.registerNotificationTypeRenderer&&e.registerNotificationTypeRenderer("reaction",e=>class extends e{get linkTitle(){return(0,c.i18n)("notifications.titles.reaction")}get linkHref(){const e=super.linkHref
if(e)return e
let t="reactions-received"
return this.notification.data.reaction_icon&&(t="likes-received"),(0,r.userPath)(`${this.currentUser.username}/notifications/${t}?acting_username=${this.notification.data.display_username}&include_likes=true`)}get icon(){return this.notification.data.reaction_icon||`notification.${this.notificationName}`}get label(){const e=this.notification.data.count,t=this.siteSettings.prioritize_full_name_in_ux&&this.notification.data.display_name||this.username
if(!e||1===e||!this.notification.data.username2)return t
if(e>2)return(0,c.i18n)("notifications.reaction_multiple_users",{username:t,count:e-1})
{const e=this.siteSettings.prioritize_full_name_in_ux&&this.notification.data.name2||(0,a.formatUsername)(this.notification.data.username2)
return(0,c.i18n)("notifications.reaction_2_users",{username:t,username2:e})}}get labelClasses(){if(this.notification.data.username2)return this.notification.data.count>2?["multi-user"]:["double-user"]}get description(){return this.notification.data.count>1&&!this.notification.data.username2?(0,c.i18n)("notifications.reaction_1_user_multiple_posts",{count:this.notification.data.count}):super.description}})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,(0,i.replaceIcon)("notification.reaction","bell")
e.default={name:"discourse-reactions",initialize(e){e.lookup("service:site-settings").discourse_reactions_enabled&&(0,o.withPluginApi)(p)},teardown(){(0,u.resetCurrentReaction)()}}}),define("discourse/plugins/discourse-reactions/discourse/initializers/reactions-admin-plugin-configuration-nav",["exports","discourse/lib/plugin-api"],function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"reactions-admin-plugin-configuration-nav",initialize(e){const s=e.lookup("service:current-user")
s?.admin&&(0,t.withPluginApi)(e=>{e.setAdminPluginIcon("discourse-reactions","discourse-emojis")})}}}),define("discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction",["exports","@ember/object","discourse/lib/ajax","discourse/lib/text","discourse/lib/utilities","discourse/models/category","discourse/models/post","discourse/models/rest","discourse/models/topic","discourse/models/user"],function(e,t,s,i,o,n,r,a,c,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.PAGE_SIZE=void 0
e.PAGE_SIZE=20
class l extends a.default{static toggle(e,t,i){return(0,s.ajax)(`/discourse-reactions/posts/${e.id}/custom-reactions/${t}/toggle.json`,{type:"PUT"}).then(e=>{i.trigger("discourse-reactions:reaction-toggled",{post:e,reaction:e.current_user_reaction})})}static flattenForPostList(e){const t=e.topic.title
return{...e,reaction_user_id:e.id,id:e.post.id,user_id:e.post.user_id,username:e.post.username,name:e.post.name,avatar_template:e.post.avatar_template,user_title:e.post.user_title,primary_group_name:e.post.primary_group_name,excerpt:e.post.excerpt,expandedExcerpt:e.post.expandedExcerpt,topic_id:e.post.topic_id,post_type:e.post.post_type,url:e.post.url,title:t,titleHtml:t&&(0,i.emojiUnescape)((0,o.escapeExpression)(t)),category:e.category,created_at:e.created_at}}static findReactions(e,i,o){const a={username:i}
return(o=o||{}).beforeReactionUserId&&(a.before_reaction_user_id=o.beforeReactionUserId),o.beforeLikeId&&(a.before_like_id=o.beforeLikeId),o.includeLikes&&(a.include_likes=o.includeLikes),o.actingUsername&&(a.acting_username=o.actingUsername),(0,s.ajax)(`/discourse-reactions/posts/${e}.json`,{data:a}).then(e=>e.map(e=>{e.user=u.default.create(e.user),e.topic=c.default.create(e.post.topic),e.category=n.default.findById(e.post.category_id)
const s={...e.post}
return delete s.url,delete s.user,e.post=r.default.create(s),e.post_user=e.post.user,t.default.create(e)}))}static findReactionUsers(e,t){const i={}
return(t=t||{}).reactionValue&&(i.reaction_value=t.reactionValue),(0,s.ajax)(`/discourse-reactions/posts/${e}/reactions-users.json`,{data:i})}init(){super.init(...arguments),this.__type="discourse-reactions-custom-reaction"}}e.default=l}),define("discourse/plugins/discourse-reactions/discourse/routes/user-activity/reactions",["exports","@ember-compat/tracked-built-ins","discourse/routes/discourse","discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction"],function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends s.default{async model(){const e=await i.default.findReactions("reactions",this.modelFor("user").username)
return new t.TrackedArray(e.map(e=>i.default.flattenForPostList(e)))}setupController(e,t){let s=t.length<i.PAGE_SIZE
this.controllerFor("user-activity.reactions").setProperties({model:t,canLoadMore:!s,reactionsUrl:"reactions",username:this.modelFor("user").username})}}e.default=o}),define("discourse/plugins/discourse-reactions/discourse/routes/user-notifications/reactions-received",["exports","@ember-compat/tracked-built-ins","discourse/routes/discourse","discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction"],function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends s.default{templateName="user-activity.reactions"
controllerName="user-activity.reactions"
queryParams={acting_username:{refreshModel:!0},include_likes:{refreshModel:!0}}
async model(e){const s=await i.default.findReactions("reactions-received",this.modelFor("user").get("username"),{actingUsername:e.acting_username,includeLikes:e.include_likes})
return new t.TrackedArray(s.map(e=>i.default.flattenForPostList(e)))}setupController(e,t){const s=t.length<i.PAGE_SIZE
this.controllerFor("user-activity.reactions").setProperties({model:t,canLoadMore:!s,reactionsUrl:"reactions-received",username:this.modelFor("user").get("username"),actingUsername:e.acting_username,includeLikes:e.include_likes})}}e.default=o}),define("discourse/plugins/discourse-reactions/discourse/templates/user-activity/reactions",["exports","discourse/components/post-list","discourse/helpers/hide-application-footer","discourse-i18n","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-emoji","@ember/component","@ember/template-factory","@ember/component/template-only"],function(e,t,s,i,o,n,r,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,n.setComponentTemplate)((0,r.createTemplateFactory)({id:"mDeP5BOE",block:'[[[41,[30,1,["canLoadMore"]],[[[1,"  "],[1,[32,0]],[1,"\\n"]],[]],null],[8,[32,1],[[24,0,"user-stream"]],[["@posts","@fetchMorePosts","@emptyText","@additionalItemClasses","@titlePath","@showUserInfo"],[[30,2],[30,1,["loadMore"]],[28,[32,2],["notifications.empty"],null],"user-stream-item","titleHtml",false]],[["abovePostItemExcerpt"],[[[[1,"\\n    "],[8,[32,3],null,[["@reaction"],[[30,3]]],null],[1,"\\n  "]],[3]]]]]],["@controller","@model","reaction"],["if"]]',moduleName:"/var/www/discourse/frontend/discourse/discourse/plugins/discourse-reactions/discourse/templates/user-activity/reactions.js",scope:()=>[s.default,t.default,i.i18n,o.default],isStrictMode:!0}),(0,a.default)(void 0,"reactions"))})

//# sourceMappingURL=discourse-reactions-2c7b2692.map